!function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o(o.s=98)}([function(e,t,n){"use strict";n.d(t,"i",function(){return u}),n.d(t,"p",function(){return c}),n.d(t,"h",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return p}),n.d(t,"q",function(){return f}),n.d(t,"n",function(){return h}),n.d(t,"o",function(){return m}),n.d(t,"b",function(){return _}),n.d(t,"k",function(){return g}),n.d(t,"j",function(){return v}),n.d(t,"g",function(){return b}),n.d(t,"a",function(){return w}),n.d(t,"c",function(){return S}),n.d(t,"l",function(){return k}),n.d(t,"e",function(){return C}),n.d(t,"m",function(){return E});var i=n(30);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=n(99),o=n(123);function s(){return"undefined"!=typeof Storage}function c(e,t){var n;s()?localStorage.setItem(e,t):(n=e,e=t,(t=new Date).setTime(t.getTime()+287712e5),t="expires="+t.toUTCString(),document.cookie=n+"="+(encodeURIComponent(e).split("'").join("%27")+"; ")+t)}function u(i){if(s()){var e=localStorage.getItem(i);return"null"!=e&&null!=e||(e=""),e}return function(){for(var e,t=i+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1);if(-1!=o.indexOf(t))return e=o.substring(t.length,o.length),decodeURIComponent(e)}return""}()}function l(e){try{if(e.includes("youtube")){var t=e.split("v=")[1];if(!t)return null;var n=t.indexOf("&");return-1!=n?t.substring(0,n):t}if(!e.includes("youtu.be/"))return null;n=e.split("youtu.be/"),t=n[0],n=n[1];if(t&&11==t.length)return t;if(n&&11==n.length)return n}catch(e){return null}}function d(e,t){if(!t)return e;try{return r.AES.encrypt(JSON.stringify(e),o.aes_secret).toString()}catch(e){return null}}function p(e,t){if(!t){try{e=JSON.stringify(e).replaceAll("آِ","ا")}catch(t){e=JSON.stringify(e).replace("آِ","ا").replace("آِ","ا").replace("آِ","ا").replace("آِ","ا").replace("آِ","ا")}return JSON.parse(e)}try{var n=r.AES.decrypt(e,o.aes_secret).toString(r.enc.Utf8);return JSON.parse(n)}catch(e){return""}}function f(e){e=Math.round(Math.abs(Date.now()-e)/1e3);return e<59?"الآن":e/60<60?parseInt(e/60)+"د":e/3600<24?parseInt(e/3600)+"س":e/86400<30?parseInt(e/86400)+"ي":e/2592e3<12?parseInt(e/2592e3)+"ش":parseInt(e/31104e3)+"ع"}function h(e,t){return t?e&&e.show_chat_background_on_windows?e.chat_background?e.window_color+" url(/uploads/"+e.chat_background+")":e.window_color+" url(/images/main_background.png)":e.window_color:e&&e.show_chat_background?e.chat_background?e.background_color+" url(/uploads/"+e.chat_background+")":e.background_color+" url(/images/main_background.png)":e.background_color}function m(e){return e&&e.show_interface_background?e.interface_background?" url(/uploads/"+e.interface_background+")":" url(/images/interface_background.jpg)":"none"}function _(e,t){if(settings){for(var n=document.getElementsByTagName("style"),r=0;r<n.length;r++);var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),a=".btn-primary { background-color: "+settings.btn_color+"; }.btn-primary:hover, .btn-primary:disabled, .btn-primary:active { background-color: "+settings.btn_color+"AA !important; }.border-color { border-color: "+settings.border_color+" !important; }.react-tabs__tab { color: "+settings.btn_color+" !important; }.color-primary { color: "+settings.btn_color+" !important; }.users-count-label__right__arrow-left { border-right-color: "+settings.btn_color+" !important; }.users-count-label__left__arrow-right { border-left-color: "+settings.btn_color+" !important; }.users-count-label { background-color: "+(a=settings.btn_color,s=parseInt(a.substring(1,3),16),c=parseInt(a.substring(3,5),16),a=parseInt(a.substring(5,7),16),s=parseInt(115*s/100),c=(c=parseInt(115*c/100))<255?c:255,a=(a=parseInt(115*a/100))<255?a:255,"#"+(1==(s=s<255?s:255).toString(16).length?"0"+s.toString(16):s.toString(16))+(1==c.toString(16).length?"0"+c.toString(16):c.toString(16))+(1==a.toString(16).length?"0"+a.toString(16):a.toString(16)))+" !important; }.label-primary { background-color: "+settings.btn_color+"; }";i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),o.appendChild(i)}var a,s,c}function g(){document.body.style.zoom="0.975";var e=y()/document.body.style.zoom,t=document.getElementById("mic-speakers"),n=t?t.clientHeight:0,r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style"),t=document.querySelector("#login .login_wrapper"),n="#chat__body { height: calc("+e+"px - 38px); }#chat, #app { height: "+e+"px; }#online_users { height: "+(e-((t?t.clientHeight:0)-3))+"px; }#user_profile { max-height: "+e+"px; }#chat__body__messages_container { height: calc("+e+"px - 32px - 40px - "+n+"px); }.user_profile__scroll_area { max-height: "+91*e/100+"px; }.reveal_names_body { height: "+65*e/100+"px; }";o.type="text/css",o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n)),r.appendChild(o),i.a.scrollToBottom();e=document.getElementById("chat_box__body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight);n=$(".winner-home").prop("clientHeight"),r=Math.round(E(50,n)),o=Math.round(E(40,n)),e=Math.round(E(28,n));$(".winner-home .stack").css("border-width",r),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",o).css("height",o),$(".player-room").css("gap",e),document.body.clientWidth<750?($(".ludo-board").css("width","100vw").css("height","100vw"),e=Math.round(E(17,n)),$(".player").css("width",e).css("height",e)):($(".ludo-board").css("width","80vh").css("height","80vh"),n=Math.round(E(20,n)),$(".player").css("width",n).css("height",n)),900<document.body.clientWidth?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),window.removeEventListener("resize",g),window.addEventListener("resize",g)}function v(){document.body.style.zoom="1";var e=y()/document.body.style.zoom,t=document.querySelector("#login .login_wrapper"),t=t?t.clientHeight:0;$("#online_users").height(e-t-3+"px"),$("#login").height(y()-2+"px")}function y(){return document.documentElement.clientHeight}function b(){return location.host.replace("www.","")}function w(e,t){$.ajax({url:e,dataType:"text",type:"GET",complete:function(e){"function"==typeof t&&t.apply(this,[e.status])}})}function S(){return""}function k(e){var o=0;return e=function e(t){if(null!=t)switch(a(t)){case"number":o+=8;break;case"string":o+=2*t.length;break;case"boolean":o+=4;break;case"object":var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n||"Array"===n)for(var r in t)t.hasOwnProperty(r)&&e(t[r]);else o+=2*t.toString().length}return o}(e),window.consumedData+=e,e<1024?e+" bytes":e<1048576?(e/1024).toFixed(3)+" KiB":e<1073741824?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB"}function C(e){if(!e)return 0;var t=new Date,e=new Date(e),t=Math.abs(e-t),t=Math.ceil(t/864e5);return 0<t&&--t,t}function E(e,t){return(e/100*t).toFixed(2)}},function(e,t,n){"use strict";var r=n(10),o=n(21),i=n(32),a=n(15),s=n(25),c=n(19),u=n(58),l=n(27),d=n(28),p=n(42),f=n(17),h=n(4);function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _,g,g=(_=v,g=[{key:"registerEvents",value:function(t){v.updateUsersCout(t),window.chatFooter.find("#chat__footer__menu__users_item").on("click",function(e){"users"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("users")),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__conversations_item").on("click",function(e){"conversations"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("conversations")),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__rooms_item").on("click",function(e){"rooms"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("rooms")),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__wall_item").on("click",function(e){"wall"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("wall")),t.dispatch(Object(o.f)()),v.updateWallCout(t),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__settings_item").on("click",function(e){"settings"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("settings")),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__live_item").on("click",function(e){f.a.close(t),"live"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("live")),v.togglePane(t))}),window.chatFooter.find("#chat__footer__menu__wall_creator_item").on("click",function(e){"wall-creator"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("wall-creator")),v.togglePane(t))})}},{key:"togglePane",value:function(e,t){if($(".chat_pane").hide(),h.a.closeModals(),!t)return"users"==e.getState().currentPane?(window.usersPane.show(),Promise.resolve().then(function(){return s.a.setUsers(e)})):"conversations"==e.getState().currentPane?(window.conversationsPane.show(),l.a.renderConversations(e)):"rooms"==e.getState().currentPane?(window.roomsPane.show(),a.a.setRooms(e)):"wall"==e.getState().currentPane?(window.wallPane.show(),c.a.setPosts(e)):"settings"==e.getState().currentPane?window.settingsPane.show():"ignored_users"==e.getState().currentPane?(window.ignoredUsersPane.show(),d.a.setUsers(e)):"notifications"==e.getState().currentPane?(window.notificationsPane.show(),p.a.setNotifications(e)):"live"==e.getState().currentPane?$("#chat__body__live-pane").show():"wall-creator"==e.getState().currentPane?(window.wallCreatorPane.show(),u.a.setPosts(e)):void 0}},{key:"updateUsersCout",value:function(e){window.chatFooter.find("#chat__footer__menu__users_item .count").text(e.getState().users.length-e.getState().ignoredUsers.length)}},{key:"updateConversationsCount",value:function(e){e=e.getState().conversations.filter(function(e){return 0==e.seen}).length;0<e?(window.chatFooter.find("#chat__footer__menu__conversations_item").addClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(e)):(window.chatFooter.find("#chat__footer__menu__conversations_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(0))}},{key:"updateRoomsCount",value:function(e){$("#chat__footer__menu__rooms_item .count").text(e.getState().rooms.length)}},{key:"updateWallCout",value:function(e){e=e.getState().newPostsCount;e?window.chatFooter.find("#chat__footer__menu__wall_item").addClass("unread"):window.chatFooter.find("#chat__footer__menu__wall_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__wall_item .count").text(e)}},{key:"toggleTV",value:function(e){e.getState().settings.tv_box_enabled?window.chatFooter.find("#chat__footer__menu__tv_item").show():(window.chatFooter.find("#chat__footer__menu__tv_item").hide(),i.a.close(e))}},{key:"render",value:function(){return"<div id='chat__footer'><ul id='chat__footer__menu'><li id='chat__footer__menu__users_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-user'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__conversations_item' class='border border-color btn-primary chat__footer__menu__item' ><span class='fa fa-comment'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__rooms_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-users'></span><span><span class='badge count'>0</span>الغرف</span></li><li id='chat__footer__menu__wall_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-commenting-o'></span><span class='badge count'>0</span><span>الحائط</span></li><li id='chat__footer__menu__settings_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-gear'></span><span></span></li><li id='chat__footer__menu__live_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-music'></span></li><li id='chat__footer__menu__wall_creator_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-area-chart'></span></li></ul></div>"}}],(n=null)&&m(_.prototype,n),m(_,g),v);function v(){!function(e){if(!(e instanceof v))throw new TypeError("Cannot call a class as a function")}(this)}t.a=g},function(e,t,n){"use strict";var r=n(6),o=n(18),i=n(3),a=n(9),s=n(0);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u,l,l=(u=d,l=[{key:"registerEvents",value:function(e){d.close(e),d.acceptLudo(e),d.refuseLudo(e),d.trustUser(e)}},{key:"close",value:function(r){$(".popup").unbind("click").on("click",function(e){var t=$(this).data("id"),n=r.getState().popups.filter(function(e){return e.id=t});r.dispatch(Object(i.b)(n)),$(this).remove()})}},{key:"trustUser",value:function(n){$(".popup__message__body__trust_user").unbind("click").on("click",function(e){var t=this;e.stopPropagation(),n.getState().socket.emit("req",Object(s.f)({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),function(e){return e=Object(s.d)(e),$(t).closest(".popup").click(),"string"==typeof e?alert(e):(e&&e.message&&alert(e.message),void(e.error||(e=$(t).data("user-id"),n.dispatch(Object(i.c)(e)))))})})}},{key:"acceptLudo",value:function(n){$(".popup__request_ludo_accept").unbind("click").on("click",function(e){var t=this;e.stopPropagation(),n.getState().socket.emit("req",Object(s.f)({type:"YOUCAM_LUDO_REQUEST_ACCEPT",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),function(e){return e=Object(s.d)(e),$(t).closest(".popup").click(),"string"==typeof e?alert(e):void(e&&e.message&&alert(e.message))})})}},{key:"refuseLudo",value:function(n){$(".popup__request_ludo_refuse").unbind("click").on("click",function(e){var t=this;e.stopPropagation(),n.getState().socket.emit("req",Object(s.f)({type:"YOUCAM_LUDO_REQUEST_REFUSE",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),function(e){return e=Object(s.d)(e),$(t).closest(".popup").click(),"string"==typeof e?alert(e):void(e&&e.message&&alert(e.message))})})}},{key:"getMarginLeft",value:function(e){return 2*e.getState().popups.length+30+"px"}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+o.a.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='popup__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='popup__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"ludo_request":return"<span>هذا المستخدم طلب منك المشاركة في لعبة اللودو</span>"+("<p style='text-align: center'><button data-color='"+e.color+"' data-user-id='"+e.user.id+"' class='popup__request_ludo_accept btn btn-success'>موافقة</button><button data-color='"+e.color+"' data-user-id='"+e.user.id)+"' class='popup__request_ludo_refuse btn btn-danger'>رفض</button></p>";case"ludo_request_accepted":return"<span>قام بقبول طلب اللعب</span>";case"ludo_request_refused":return"<span>قام برفض طلب اللعب</span>";case"ludo_ended":return"<span>قام بإنهاء اللعبة</span>";case"photo_like":return;default:return"<span>"+a.a.render(e.message,t)+"</span>"}}},{key:"render",value:function(e,t){var n="<div style='marginLeft: "+d.getMarginLeft(t)+"' data-id='"+e.id+"' class='popup'>";n+="<p class='popup__title label label-primary'>"+e.title+"</p>",e.user&&(n+="<div class='popup__sender fl'>",n+="<img src='"+e.user.avatar+"' width='24' height='24' class='popup__sender__avatar fl' />",n+="<p class='popup__sender__name'>"+r.a.render(e.user)+"</p>",n+="</div>"),n+="<div class='popup__message fl'>",n+=d.renderMessage(e,t),n+="</div>",n+="</div>",$("#popup_container").append(n),d.registerEvents(t)}}],(n=null)&&c(u.prototype,n),c(u,l),d);function d(){!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this)}t.a=l},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i});var r=function(){return{type:"REMOVE_POPUP",popup:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},o=function(){return{type:"ADD_POPUP",popup:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},i=function(e){return{type:"TRUST_USER_POPUP",user_id:e}}},function(e,t,n){"use strict";var s=n(0),r=n(20),o=n(7),l=n.n(o);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,n=(a=d,n=[{key:"registerEvents",value:function(e){d.onMicButtonClicked(e),d.onMuteClicked(e)}},{key:"getIceServers",value:function(e){return e?[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://audio.chat-host.net:8989"}},{key:"init",value:function(e){window.isMicSoundMuted=!1,window.isMicMuted=!1,window.incomingMicStreams={},window.currentMicCallObjct={},window.outgoingMicStream=null,window.janusSession=null,window.janusUserID=d.generateJanusUserID(e.getState().socket.id),window.opaqueId="videoroomtest-"+l.a.randomString(12),window.reconnectionInterval=null,window.feeds=[],l.a.init({debug:!1,dependencies:l.a.useDefaultDependencies(),callback:function(){d.onJanusInitialized(e)},iceServers:d.getIceServers(!0)})}},{key:"onJanusInitialized",value:function(t){window.janusSession=new l.a({server:d.getJanusServer(),success:function(){d.onJanusSessionSuccess(t,janusSession)},error:function(e){"Lost connection to the server (is it down?)"==e&&d.handleServerConnectionLost(t)},destroyed:function(){d.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(t){var e;t.getState().mUser.room&&((e=t.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t.getState().mUser.id})[0])&&d.leaveMic(t,e.micId,t.getState().mUser),d.destroySession()),window.reconnectionInterval=setInterval(function(){l.a.init({debug:!1,dependencies:l.a.useDefaultDependencies(),callback:function(){d.onJanusInitialized(t)},iceServers:d.getIceServers(!0)})},5e3)}},{key:"getJanusUserID",value:function(e){return e.replace(new URL(socketIOHost).hostname+".","")}},{key:"generateJanusUserID",value:function(e){return new URL(socketIOHost).hostname+"."+e}},{key:"onJanusSessionSuccess",value:function(n,e){window.reconnectionInterval&&(clearInterval(window.reconnectionInterval),window.reconnectionInterval=null),e.attach({plugin:"janus.plugin.videoroom",success:function(e){d.onJanusAttachSuccess(n,e)},error:function(e){},consentDialog:function(e){},onmessage:function(e,t){d.onJanusAttachMessage(e,t,n)},onlocalstream:function(e){d.onJanusAttachLocalStream(e)},onremotestream:function(e){},webrtcState:function(e){l.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusSessionDestroyed",value:function(e){e.getState().mUser.room&&e.getState().mUser.room.is_voice_room&&d.onJanusInitialized(e)}},{key:"onJanusAttachSuccess",value:function(e,t){console.log("onMicAttachSuccess"),window.pluginHandle=t,d.joinRoom(e)}},{key:"onJanusAttachMessage",value:function(e,t,n){var r=e.videoroom;if(r){if("joined"===r&&e.id){if(window.pluginHandle.send({message:{request:"publish",video:!1,data:!1}}),e.publishers){var o=e.publishers;for(u in l.a.debug("Got a list of available publishers/feeds:",o),o){var i=o[u].id,a=o[u].display,s=o[u].audio_codec,c=o[u].video_codec;l.a.debug("  >> ["+i+"] "+a+" (audio: "+s+", video: "+c+")"),d.newRemoteFeed(n,i,a,s,c)}}d.enableMicButtons()}if("created"!==r)if("destroyed"===r)l.a.warn("The room has been destroyed!");else if("roomchanged"===r)window.myJanusID=e.id;else if("event"===r)if(e.publishers)for(var u in o=e.publishers)i=o[u].id,a=o[u].display,s=o[u].audio_codec,c=o[u].video_codec,d.newRemoteFeed(n,i,a,s,c);else e.leaving||e.unpublished||e.error&&426===e.error_code&&d.createRoom(n)}t&&window.pluginHandle.handleRemoteJsep({jsep:t})}},{key:"onJanusAttachLocalStream",value:function(e){window.outgoingMicStream=e}},{key:"onJanusAttachRemoteStream",value:function(e,t){}},{key:"detachFeed",value:function(e,t){window.feeds.filter(function(e){return e.rfdisplay==d.generateJanusUserID(t)})[0].detach()}},{key:"newRemoteFeed",value:function(o,t,e,n,r){var i=null;window.janusSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.opaqueId,success:function(e){(i=e).simulcastStarted=!1,i.audioCodec=n;e={request:"join",room:d.generateJanusRoomID(o),ptype:"subscriber",feed:t,offer_video:!1,offer_data:!1};i.send({message:e})},error:function(e){l.a.error("  -- Error attaching plugin...",e)},onmessage:function(e,t){var n=e.videoroom;if(!e.error&&n&&"attached"===n){for(var r=1;r<6;r++)if(!window.feeds[r]){(window.feeds[r]=i).rfindex=r;break}i.rfid=e.id,i.rfdisplay=e.display}t&&i.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){l.a.debug("Got SDP!",e);var t={request:"start",room:d.generateJanusRoomID(o)};i.send({message:t,jsep:e})},error:function(e){l.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){l.a.log(" WebRTC PeerConnection (feed #"+i.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(e){},onremotestream:function(e){d.playStream(o,e,d.getJanusUserID(i.rfdisplay))},oncleanup:function(){}})}},{key:"toggle",value:function(t,e){var n,r=$("#mic-speakers");e?(r.show(),window.janusSession&&window.janusSession.isConnected()?d.destroySession():d.onJanusInitialized(t)):(r.hide(),t.getState().mUser.room&&(n=t.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t.getState().mUser.id})[0])&&d.leaveMic(t,n.micId,t.getState().mUser),d.destroySession()),Object(s.k)()}},{key:"onMicButtonClicked",value:function(n){$(".mic-speakers--item").on("click",function(e){var t;!$(this).hasClass("disabled")&&n.getState().mUser.room&&(t=$(this).data("id"),n.getState().mUser.room.micUsers.filter(function(e){return e.micId==t})[0]?d.openMicControls(n,t):d.requestMic(n,t))})}},{key:"setModalButtons",value:function(t,n){$(".mic-speakers--item__modal").html("").hide();var e=!1,r=t.getState().mUser.room.micUsers.filter(function(e){return e.micId==n})[0];r&&r.user_id==t.getState().mUser.id&&(e=!0);var o=t.getState().users.filter(function(e){return e.id==r.user_id})[0],i=$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal");i.css("background",Object(s.n)(t.getState().settings,!1));var a=i.closest(".mic-speakers--item").attr("user-id");e?(i.append("<button id='mic-speakers--item__modal--leave-mic' class='btn btn-primary'>ترك المايك</button>"),$("#mic-speakers--item__modal--leave-mic").unbind("click").on("click",function(e){d.leaveMic(t,n,a)})):o&&t.getState().grantedSettings.stop_radio&&t.getState().mUser.power>o.power&&(i.append("<button id='mic-speakers--item__modal--pull-mic' class='btn btn-primary'>سحب المايك</button>"),$("#mic-speakers--item__modal--pull-mic").unbind("click").on("click",function(e){d.pullMic(t,n,o.id)})),e?(window.isMicMuted?i.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'>تشغيل المايك</button>"):i.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'>كتم المايك</button>"),$("#mic-speakers--item__modal--mute-mic").unbind("click").on("click",function(e){d.muteMic(t,n,a)})):(d.isMicMuted(n)?i.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'>تشغيل الصوت</button>"):i.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'>كتم الصوت</button>"),$("#mic-speakers--item__modal--mute").unbind("click").on("click",function(e){d.muteUser(t,n,!0)})),i.append("<button id='mic-speakers--item__modal--show-profile' class='btn btn-primary'>فتح البروفايل</button>"),$("#mic-speakers--item__modal--show-profile").unbind("click").on("click",function(e){d.showProfile(t,n,a)}),i.show()}},{key:"isMicMuted",value:function(e){var t=!1,e=window.incomingMicStreams[e];return e&&(t=!e.getTracks()[0].enabled),t}},{key:"leaveMic",value:function(e,t,n){e.getState().socket.emit("req",Object(s.f)({type:"MIC_LEAVE",data:{micId:t}}),function(e){}),d.closeModals()}},{key:"pullMic",value:function(e,t,n){e.getState().socket.emit("req",Object(s.f)({type:"MIC_PULL",data:{micId:t,userId:n}}),function(e){}),d.closeModals()}},{key:"muteMic",value:function(e,t,n){window.isMicMuted=!window.isMicMuted,e.getState().socket.emit("req",Object(s.f)({type:"MIC_MUTE",data:{micId:t,userId:n,muted:window.isMicMuted}}),function(e){}),window.isMicMuted?window.pluginHandle.muteAudio():window.pluginHandle.unmuteAudio(),d.setModalButtons(e,t)}},{key:"muteUser",value:function(e,t,n){var r;window.incomingMicStreams[t]&&(r=!1,window.incomingMicStreams[t].getTracks().forEach(function(e){e.enabled=!e.enabled,r=!e.enabled}),n&&d.setModalButtons(e,t),d.updateMicMutedStyle(r,t))}},{key:"muteAllUsers",value:function(){for(var e in window.incomingMicStreams)window.incomingMicStreams[e].getTracks().forEach(function(e){return e.enabled=!1});d.updateMicMutedStyle(!0)}},{key:"unmuteAllUsers",value:function(){for(var e in window.incomingMicStreams)window.incomingMicStreams[e].getTracks().forEach(function(e){return e.enabled=!0});d.updateMicMutedStyle(!1)}},{key:"updateMicMutedStyle",value:function(t,e){e?(e=document.querySelector(".mic-speakers--item[data-id='"+e+"']"))&&(t?e.classList.add("muted"):e.classList.remove("muted")):document.querySelectorAll(".mic-speakers--item").forEach(function(e){e&&(t?e.classList.add("muted"):e.classList.remove("muted"))})}},{key:"showProfile",value:function(e,t,n){r.a.show(n,e)}},{key:"closeModals",value:function(){$(".mic-speakers--item__modal").html("").hide()}},{key:"openMicControls",value:function(e,t){$(".mic-speakers--item[data-id='"+t+"'] .mic-speakers--item__modal").show(),d.setModalButtons(e,t)}},{key:"requestMic",value:function(e,t){e.getState().socket.emit("req",Object(s.f)({type:"MIC_REQUEST",data:{micId:t}}),function(e){return"string"==typeof e?alert(e):void d.closeModals()})}},{key:"setUserOnMic",value:function(e,t,n){t&&($(".mic-speakers--item[data-id='"+n+"']").addClass("is_speaking").attr("user-id",t.id),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__mic-wrapper").hide(),$(".mic-speakers--item[data-id='"+n+"'] img").attr("src",t.avatar).show(),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__name").html(t.name).show(),window.currentMicCallObjct[n]={callId:t.id},e.getState().mUser.id==t.id&&window.pluginHandle.createOffer({media:{video:!1},success:function(e){var t={request:"configure",audio:!0,video:!1,id:n};window.pluginHandle.send({message:t,jsep:e})},error:function(e){l.a.error("WebRTC error:",e)}}))}},{key:"removeUserFromMic",value:function(e,t,n,r){$(".mic-speakers--item[data-id='"+n+"']").removeClass("is_speaking"),$(".mic-speakers--item[data-id='"+n+"'] img").attr("src",t.avatar).hide(),$(".mic-speakers--item[data-id='"+n+"'] img, .mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__name, .mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal").hide(),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__mic-wrapper").show(),window.isMicSoundMuted||d.updateMicMutedStyle(!1,n),delete window.currentMicCallObjct[n],delete window.incomingMicStreams[n],t.id==e.getState().mUser.id?r&&d.destroySession():e.getState().mUser.room&&t.room&&(e.getState().mUser.room.id,t.room.id)}},{key:"closeCallAndStream",value:function(e){window.pluginHandle.createOffer({media:{video:!1,audio:!1},success:function(e){window.pluginHandle.send({message:{request:"configure",audio:!1,video:!1},jsep:e})},error:function(e){l.a.error("WebRTC error:",e)}})}},{key:"resetAllMics",value:function(){for(var e in $(".mic-speakers--item").removeClass("is_speaking"),$(".mic-speakers--item img, .mic-speakers--item__name, .mic-speakers--item__modal").hide(),$(".mic-speakers--item .mic-speakers--item__mic-wrapper").show(),d.updateMicMutedStyle(!1,void 0),window.currentMicCallObjct)delete window.currentMicCallObjct[e];for(var e in window.incomingMicStreams)delete window.incomingMicStreams[e];window.incomingMicStreams={},window.currentMicCallObjct={}}},{key:"pushMusicStreamToOutgoingStreams",value:function(){}},{key:"callUser",value:function(e,t,n){}},{key:"gotUserMediaError",value:function(e){}},{key:"callNewUser",value:function(e,t){}},{key:"loopThrowUsersAndCallThem",value:function(e,t){}},{key:"onCallReceived",value:function(e){}},{key:"requestRecall",value:function(e,t){}},{key:"askForPlayingAudio",value:function(e,t){}},{key:"startListening",value:function(e){}},{key:"generateJanusRoomID",value:function(e){if(!e.getState().mUser.room)return-1;var t=new URL(socketIOHost);return parseInt(t.port+""+e.getState().mUser.room.id)+9999}},{key:"destroySession",value:function(){d.disableMicButtons(),window.outgoingMicStream&&window.outgoingMicStream.getTracks().forEach(function(e){return e.stop()}),window.janusSession&&window.janusSession.isConnected()&&(window.janusSession.destroy(),d.destroyAllFeeds())}},{key:"destroyAllFeeds",value:function(){window.feeds.forEach(function(e){})}},{key:"disableMicButtons",value:function(){$(".mic-speakers--item").addClass("disabled")}},{key:"enableMicButtons",value:function(){$(".mic-speakers--item").removeClass("disabled")}},{key:"createRoom",value:function(e){window.pluginHandle&&window.pluginHandle.send({message:{request:"create",room:d.generateJanusRoomID(e),permanent:!0,bitrate:64e3,publishers:5,description:socketIOHost}})}},{key:"leaveRoom",value:function(e,t){var n;!e.getState().mUser.room||(n=e.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t.id})[0])&&(e.getState().mUser.room.micUsers=e.getState().mUser.room.micUsers.filter(function(e){return e.user_id!=t.id}),d.removeUserFromMic(e,t,n.micId,!1)),window.pluginHandle&&(t.id,e.getState().mUser.id)}},{key:"joinRoom",value:function(e){e=d.generateJanusRoomID(e);window.pluginHandle&&0<e&&window.pluginHandle.send({message:{request:"join",ptype:"publisher",room:e,display:window.janusUserID}})}},{key:"getMicIDFromUserID",value:function(e,t){e=e.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t})[0];return e?e.micId:null}},{key:"playStream",value:function(n,t,e){var r=d.getMicIDFromUserID(n,e);if(r){if(window.isMicSoundMuted&&t.getTracks().forEach(function(e){return e.enabled=!1}),d.isMicMuted(r)&&t.getTracks().forEach(function(e){return e.enabled=!1}),window.incomingMicStreams[r]=t,"srcObject"in window["micAudio"+r])try{window["micAudio"+r].srcObject=t}catch(e){if("TypeError"!=e.name)throw e;window["micAudio"+r].src=URL.createObjectURL(t)}else window["micAudio"+r].src=URL.createObjectURL(t);window["micAudio"+r].onloadedmetadata=function(e){var t;!window["micAudio"+r].paused||(t=window["micAudio"+r].play())&&t.then(function(){}).catch(function(e){d.askForPlayingAudio(n,r)}),d.isSafari()&&(window["micAudio"+r].muted=!1),window["micAudio"+r].muted=!1}}}},{key:"playVisualizer",value:function(e,t){var n,r,o,i=window.AudioContext||window.webkitAudioContext||!1;i?(r=document.getElementById("mic-speakers--item-"+t),i=new i,o=i.createAnalyser(),i.createMediaStreamSource(e).connect(o),o.connect(i.destination),n=new Uint8Array(o.frequencyBinCount),requestAnimationFrame(function e(){o.getByteFrequencyData(n),n[2]&&20<=n[2]?r.classList.add("ripple"):r.classList.remove("ripple"),requestAnimationFrame(e)})):console.log("AudioContext not supported")}},{key:"addMidAudios",value:function(){$("#mic-audio-1").length||($("body").append('<audio id="mic-audio-1"></audio>'),window.micAudio1=document.querySelector("#mic-audio-1"),window.micAudio1.muted=!0),$("#mic-audio-2").length||($("body").append('<audio id="mic-audio-2"></audio>'),window.micAudio2=document.querySelector("#mic-audio-2"),window.micAudio2.muted=!0),$("#mic-audio-3").length||($("body").append('<audio id="mic-audio-3"></audio>'),window.micAudio3=document.querySelector("#mic-audio-3"),window.micAudio3.muted=!0),$("#mic-audio-4").length||($("body").append('<audio id="mic-audio-4"></audio>'),window.micAudio4=document.querySelector("#mic-audio-4"),window.micAudio4.muted=!0),$("#mic-audio-5").length||($("body").append('<audio id="mic-audio-5"></audio>'),window.micAudio5=document.querySelector("#mic-audio-5"),window.micAudio5.muted=!0)}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"onMuteClicked",value:function(e){$("#mic-speakers--mute").on("click",function(e){var t=$("#mic-speakers--mute");window.isMicSoundMuted?(d.unmuteAllUsers(),window.isMicSoundMuted=!1,t.removeClass("muted")):(window.isMicSoundMuted=!0,d.muteAllUsers(),t.addClass("muted"))})}},{key:"getRndInteger",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"render",value:function(e){return"<div id='mic-speakers'><span id='mic-speakers--item-1' class='mic-speakers--item disabled' data-id='1'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>1</span></span></span><span id='mic-speakers--item-2' class='mic-speakers--item disabled' data-id='2'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>2</span></span></span><span id='mic-speakers--item-3' class='mic-speakers--item disabled' data-id='3'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>3</span></span></span><span id='mic-speakers--item-4' class='mic-speakers--item disabled' data-id='4'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>4</span></span></span><span id='mic-speakers--item-5' class='mic-speakers--item disabled' data-id='5'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>5</span></span></span><span id='mic-speakers--mute'></span></div>"}}],(o=null)&&i(a.prototype,o),i(a,n),d);function d(){!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this)}t.a=n},function(e,t,n){var u,r,o,i,a,l,s,c,d,p,f;function h(){}e.exports=(u=Math,r=Object.create||function(e){return h.prototype=e,e=new h,h.prototype=null,e},i=(o={}).lib={},a=i.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=i.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=u.ceil(t/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4){var r=function(t){var n=987654321,r=4294967295;return function(){var e=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return e/=4294967296,(e+=.5)*(.5<u.random()?1:-1)}}(4294967296*(o||u.random())),o=987654071*r();t.push(4294967296*r()|0)}return new l.init(t,e)}}),e=o.enc={},s=e.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new l.init(n,t/2)}},c=e.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new l.init(n,t)}},d=e.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,r=t.sigBytes,o=this.blockSize,i=r/(4*o),a=(i=e?u.ceil(i):u.max((0|i)-this._minBufferSize,0))*o,r=u.min(4*a,r);if(a){for(var s=0;s<a;s+=o)this._doProcessBlock(n,s);var c=n.splice(0,a);t.sigBytes-=r}return new l.init(c,r)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),i.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new f.HMAC.init(n,t).finalize(e)}}}),f=o.algo={},o)},function(e,t,n){"use strict";var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a,a=(i=s,a=[{key:"render",value:function(e){var t="<span class='username'>";return"?test"==location.search?t+=e.icon?"<img src='/images/floating_ad1.png' class='username__icon fl' alt='' style='max-height: 16px' />":"":t+=e.icon?"<img src='"+Object(r.c)()+e.icon+"?v=1' class='username__icon fl' alt='' style='max-height: 16px' />":"",(t+="<span class='username__wrapper' style='background-color: "+e.nameBgColor+"; color: "+e.nameColor+"'>"+e.name+"</span>")+"</span>"}}],(n=null)&&o(i.prototype,n),o(i,a),s);function s(){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this)}t.a=a},function(e,t){function X(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e){if(e){if("string"==typeof e)return s(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Q.sessions={},Q.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),26<=e&&e<=t||Q.extension.isInstalled()}return!0};var i={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(t){var e=window.setTimeout(function(){var e=new Error("NavigatorUserMediaError");return e.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',t(e)},1e3);this.cache[e]=t,window.postMessage({type:"janusGetScreen",id:e},"*")},init:function(){var r={};this.cache=r,window.addEventListener("message",function(e){var t,n;e.origin==window.location.origin&&("janusGotScreen"==e.data.type&&r[e.data.id]?(t=r[e.data.id],delete r[e.data.id],""===e.data.sourceId?((n=new Error("NavigatorUserMediaError")).name="You cancelled the request for permission, giving up...",t(n)):t(null,e.data.sourceId)):"janusGetScreenPending"==e.data.type&&(console.log("clearing ",e.data.id),window.clearTimeout(e.data.id)))})}};function Q(u){if((u=u||{}).success="function"==typeof u.success?u.success:Q.noop,u.error="function"==typeof u.error?u.error:Q.noop,u.destroyed="function"==typeof u.destroyed?u.destroyed:Q.noop,!Q.initDone)return u.error("Library not initialized"),{};if(!Q.isWebrtcSupported())return u.error("WebRTC not supported by this browser"),{};if(Q.log("Library initialized: "+Q.initDone),!u.server)return u.error("Invalid server url"),{};var l=!1,d=null,p={},f=null,o=null,i=0,h=u.server;Q.isArray(h)?(Q.log("Multiple servers provided ("+h.length+"), will use the first that works"),h=null,o=u.server,Q.debug(o)):0===h.indexOf("ws")?(l=!0,Q.log("Using WebSockets to contact Janus: "+h)):(l=!1,Q.log("Using REST API to contact Janus: "+h));var y=u.iceServers||[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{urls:"stun:stun.l.google.com:19302"}],b=u.iceTransportPolicy,w=u.bundlePolicy,S=!0===u.ipv6,m=!1;void 0!==u.withCredentials&&null!==u.withCredentials&&(m=!0===u.withCredentials);var t=10;void 0!==u.max_poll_events&&null!==u.max_poll_events&&(t=u.max_poll_events),t<1&&(t=1);var _=null;void 0!==u.token&&null!==u.token&&(_=u.token);var g=null;void 0!==u.apisecret&&null!==u.apisecret&&(g=u.apisecret),this.destroyOnUnload=!0,void 0!==u.destroyOnUnload&&null!==u.destroyOnUnload&&(this.destroyOnUnload=!0===u.destroyOnUnload);var a=25e3;void 0!==u.keepAlivePeriod&&null!==u.keepAlivePeriod&&(a=u.keepAlivePeriod),isNaN(a)&&(a=25e3);var n=6e4;function k(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==u.longPollTimeout&&null!==u.longPollTimeout&&(n=u.longPollTimeout),isNaN(n)&&(n=6e4);var v=!1,C=null,E={},s=this,c=0,T={};function O(){var e;null!=C&&(Q.debug("Long poll..."),v?(e=h+"/"+C+"?rid="+(new Date).getTime(),t&&(e=e+"&maxev="+t),_&&(e=e+"&token="+encodeURIComponent(_)),g&&(e=e+"&apisecret="+encodeURIComponent(g)),Q.httpAPICall(e,{verb:"GET",withCredentials:m,success:P,timeout:n,error:function(e,t){if(Q.error(e+":",t),3<++c)return v=!1,void u.error("Lost connection to the server (is it down?)");O()}})):Q.warn("Is the server down? (connected=false)"))}function P(e,t){if(c=0,l||null==C||!0===t||O(),l||!Q.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus)(i=e.sender)?(a=E[i])?(t=e.candidate,Q.debug("Got a trickled candidate on session "+C),Q.debug(t),(o=a.webrtcStuff).pc&&o.remoteSdp?(Q.debug("Adding remote candidate:",t),t&&!0!==t.completed?o.pc.addIceCandidate(t):o.pc.addIceCandidate(Q.endOfCandidates)):(Q.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),o.candidates||(o.candidates=[]),o.candidates.push(t),Q.debug(o.candidates))):Q.debug("This handle is not attached to this session"):Q.warn("Missing sender...");else{if("webrtcup"===e.janus)return Q.debug("Got a webrtcup event on session "+C),Q.debug(e),(i=e.sender)?(a=E[i])?void a.webrtcState(!0):void Q.debug("This handle is not attached to this session"):void Q.warn("Missing sender...");if("hangup"===e.janus)Q.debug("Got a hangup event on session "+C),Q.debug(e),(i=e.sender)?(a=E[i])?(a.webrtcState(!1,e.reason),a.hangup()):Q.debug("This handle is not attached to this session"):Q.warn("Missing sender...");else if("detached"===e.janus)Q.debug("Got a detached event on session "+C),Q.debug(e),(i=e.sender)?(a=E[i])&&(a.detached=!0,a.ondetached(),a.detach()):Q.warn("Missing sender...");else if("media"===e.janus)Q.debug("Got a media event on session "+C),Q.debug(e),(i=e.sender)?(a=E[i])?a.mediaState(e.type,e.receiving):Q.debug("This handle is not attached to this session"):Q.warn("Missing sender...");else if("slowlink"===e.janus)Q.debug("Got a slowlink event on session "+C),Q.debug(e),(i=e.sender)?(a=E[i])?a.slowLink(e.uplink,e.lost):Q.debug("This handle is not attached to this session"):Q.warn("Missing sender...");else{var n,r,o,i,a;if("error"===e.janus)return Q.error("Ooops: "+e.error.code+" "+e.error.reason),Q.debug(e),void((n=e.transaction)&&((r=T[n])&&r(e),delete T[n]));if("event"===e.janus)(Q.debug("Got a plugin event on session "+C),Q.debug(e),i=e.sender)?(o=e.plugindata)?(Q.debug("  -- Event is coming from "+i+" ("+o.plugin+")"),o=o.data,Q.debug(o),(a=E[i])?((i=e.jsep)&&(Q.debug("Handling SDP as well..."),Q.debug(i)),(a=a.onmessage)?(Q.debug("Notifying application..."),a(o,i)):Q.debug("No provided notification callback")):Q.warn("This handle is not attached to this session")):Q.warn("Missing plugindata..."):Q.warn("Missing sender...");else{if("timeout"===e.janus)return Q.error("Timeout on session "+C),Q.debug(e),void(l&&d.close(3504,"Gateway timeout"));Q.warn("Unknown message/event  '"+e.janus+"' on session "+C),Q.debug(e)}}}else Q.debug("Got a success on session "+C),Q.debug(e),(n=e.transaction)&&((r=T[n])&&r(e),delete T[n]);else Q.debug("Got an ack on session "+C),Q.debug(e),(n=e.transaction)&&((r=T[n])&&r(e),delete T[n]);else Q.debug("Got info on the Janus instance"),Q.debug(e),(n=e.transaction)&&((r=T[n])&&r(e),delete T[n]);else Q.vdebug("Got a keepalive on session "+C);else for(var s=0;s<e.length;s++)P(e[s],!0)}function A(){var e;h&&l&&v&&(f=setTimeout(A,a),e={janus:"keepalive",session_id:C,transaction:Q.randomString(12)},_&&(e.token=_),g&&(e.apisecret=g),d.send(JSON.stringify(e)))}function R(n){var e=Q.randomString(12),t={janus:"create",transaction:e};if(n.reconnect&&(v=!1,t.janus="claim",t.session_id=C,d&&(d.onopen=null,d.onerror=null,d.onclose=null,f&&(clearTimeout(f),f=null))),_&&(t.token=_),g&&(t.apisecret=g),!h&&Q.isArray(o)&&(0===(h=o[i]).indexOf("ws")?(l=!0,Q.log("Server #"+(i+1)+": trying WebSockets to contact Janus ("+h+")")):(l=!1,Q.log("Server #"+(i+1)+": trying REST API to contact Janus ("+h+")"))),l)for(var r in d=Q.newWebSocket(h,"janus-protocol"),p={error:function(){if(Q.error("Error connecting to the Janus WebSockets server... "+h),Q.isArray(o)&&!n.reconnect)return++i===o.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(h=null,void setTimeout(function(){R(n)},200));n.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){T[e]=function(e){if(Q.debug(e),"success"!==e.janus)return Q.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);f=setTimeout(A,a),v=!0,C=e.session_id||e.data.id,n.reconnect?Q.log("Claimed session: "+C):Q.log("Created session: "+C),Q.sessions[C]=s,n.success()},d.send(JSON.stringify(t))},message:function(e){P(JSON.parse(e.data))},close:function(){h&&v&&(v=!1,u.error("Lost connection to the server (is it down?)"))}})d.addEventListener(r,p[r]);else Q.httpAPICall(h,{verb:"POST",withCredentials:m,body:t,success:function(e){if(Q.debug(e),"success"!==e.janus)return Q.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);v=!0,C=e.session_id||e.data.id,n.reconnect?Q.log("Claimed session: "+C):Q.log("Created session: "+C),Q.sessions[C]=s,O(),n.success()},error:function(e,t){if(Q.error(e+":",t),Q.isArray(o)&&!n.reconnect)return++i===o.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(h=null,void setTimeout(function(){R(n)},200));""===t?n.error(e+": Is the server down?"):n.error(e+": "+t)}})}function x(e,n){if((n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,!v)return Q.warn("Is the server down? (connected=false)"),n.error("Is the server down? (connected=false)"),0;var t=E[e];if(!t||!t.webrtcStuff)return Q.warn("Invalid handle"),n.error("Invalid handle"),0;var r=n.message,o=n.jsep,i=Q.randomString(12),r={janus:"message",body:r,transaction:i};if(t.token&&(r.token=t.token),g&&(r.apisecret=g),o&&(r.jsep={type:o.type,sdp:o.sdp},o.e2ee&&(r.jsep.e2ee=!0),"hml"!==o.rid_order&&"lmh"!==o.rid_order||(r.jsep.rid_order=o.rid_order)),Q.debug("Sending message to plugin (handle="+e+"):"),Q.debug(r),l)return r.session_id=C,r.handle_id=e,T[i]=function(e){if(Q.debug("Message sent!"),Q.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return Q.warn("Request succeeded, but missing plugindata..."),void n.success();Q.log("Synchronous transaction successful ("+t.plugin+")");t=t.data;return Q.debug(t),void n.success(t)}"ack"===e.janus?n.success():e.error?(Q.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(Q.error("Unknown error"),n.error("Unknown error"))},d.send(JSON.stringify(r)),0;Q.httpAPICall(h+"/"+C+"/"+e,{verb:"POST",withCredentials:m,body:r,success:function(e){if(Q.debug("Message sent!"),Q.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return Q.warn("Request succeeded, but missing plugindata..."),void n.success();Q.log("Synchronous transaction successful ("+t.plugin+")");t=t.data;return Q.debug(t),void n.success(t)}"ack"===e.janus?n.success():e.error?(Q.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(Q.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){Q.error(e+":",t),n.error(e+": "+t)}})}function M(e,t){if(v){var n=E[e];if(n&&n.webrtcStuff){t={janus:"trickle",candidate:t,transaction:Q.randomString(12)};if(n.token&&(t.token=n.token),g&&(t.apisecret=g),Q.vdebug("Sending trickle candidate (handle="+e+"):"),Q.vdebug(t),l)return t.session_id=C,t.handle_id=e,d.send(JSON.stringify(t)),0;Q.httpAPICall(h+"/"+C+"/"+e,{verb:"POST",withCredentials:m,body:t,success:function(e){Q.vdebug("Candidate sent!"),Q.vdebug(e),"ack"===e.janus||Q.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){Q.error(e+":",t)}})}else Q.warn("Invalid handle")}else Q.warn("Is the server down? (connected=false)")}function j(e,t,n,r,o){var a,s=E[e];s&&s.webrtcStuff?(a=s.webrtcStuff).pc?(e=function(e){Q.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,r=a.dataChannel[t]?a.dataChannel[t].readyState:"null";if(Q.log("State change on <"+t+"> data channel: "+r),"open"===r){if(a.dataChannel[t].pending&&0<a.dataChannel[t].pending.length){Q.log("Sending pending messages on <"+t+">:",a.dataChannel[t].pending.length);var o=X(a.dataChannel[t].pending);try{for(o.s();!(i=o.n()).done;){var i=i.value;Q.log("Sending data on data channel <"+t+">"),Q.debug(i),a.dataChannel[t].send(i)}}catch(e){o.e(e)}finally{o.f()}a.dataChannel[t].pending=[]}s.ondataopen(t,n)}},r?a.dataChannel[t]=r:(r={ordered:!0},n&&(r.protocol=n),a.dataChannel[t]=a.pc.createDataChannel(t,r)),a.dataChannel[t].onmessage=function(e){Q.log("Received message on data channel:",e);var t=e.target.label;s.ondata(e.data,t)},a.dataChannel[t].onopen=e,a.dataChannel[t].onclose=e,a.dataChannel[t].onerror=function(e){Q.error("Got error on data channel:",e)},a.dataChannel[t].pending=[],o&&a.dataChannel[t].pending.push(o)):Q.warn("Invalid PeerConnection"):Q.warn("Invalid handle")}function D(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Q.noop,t.error="function"==typeof t.error?t.error:Q.noop;var n=E[e];if(!n||!n.webrtcStuff)return Q.warn("Invalid handle"),t.error("Invalid handle"),0;var r=n.webrtcStuff,o=t.text||t.data;if(!o)return Q.warn("Invalid data"),t.error("Invalid data"),0;n=t.label||Q.dataChanDefaultLabel;return r.dataChannel[n]?"open"!==r.dataChannel[n].readyState?r.dataChannel[n].pending.push(o):(Q.log("Sending data on data channel <"+n+">"),Q.debug(o),r.dataChannel[n].send(o)):j(e,n,t.protocol,!1,o,t.protocol),void t.success()}function I(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Q.noop,t.error="function"==typeof t.error?t.error:Q.noop;var n=E[e];if(!n||!n.webrtcStuff)return Q.warn("Invalid handle"),t.error("Invalid handle"),0;var r=n.webrtcStuff;if(!r.dtmfSender){if(r.pc){var o=r.pc.getSenders().find(function(e){return e.track&&"audio"===e.track.kind});if(!o)return Q.warn("Invalid DTMF configuration (no audio track)"),t.error("Invalid DTMF configuration (no audio track)"),0;r.dtmfSender=o.dtmf,r.dtmfSender&&(Q.log("Created DTMF Sender"),r.dtmfSender.ontonechange=function(e){Q.debug("Sent DTMF tone: "+e.tone)})}if(!r.dtmfSender)return Q.warn("Invalid DTMF configuration"),t.error("Invalid DTMF configuration"),0}e=t.dtmf;if(!e)return Q.warn("Invalid DTMF parameters"),t.error("Invalid DTMF parameters"),0;n=e.tones;if(!n)return Q.warn("Invalid DTMF string"),t.error("Invalid DTMF string"),0;o="number"==typeof e.duration?e.duration:500,e="number"==typeof e.gap?e.gap:50;Q.debug("Sending DTMF string "+n+" (duration "+o+"ms, gap "+e+"ms)"),r.dtmfSender.insertDTMF(n,o,e),t.success()}function U(n,r){(r=r||{}).success="function"==typeof r.success?r.success:Q.noop,r.error="function"==typeof r.error?r.error:Q.noop;var e=!0===r.noRequest;Q.log("Destroying handle "+n+" (only-locally="+e+")"),V(n);var t=E[n];if(!t||t.detached)return delete E[n],r.success(),0;if(e)return delete E[n],r.success(),0;if(!v)return Q.warn("Is the server down? (connected=false)"),r.error("Is the server down? (connected=false)"),0;e={janus:"detach",transaction:Q.randomString(12)};if(t.token&&(e.token=t.token),g&&(e.apisecret=g),l)return e.session_id=C,e.handle_id=n,d.send(JSON.stringify(e)),delete E[n],r.success(),0;Q.httpAPICall(h+"/"+C+"/"+n,{verb:"POST",withCredentials:m,body:e,success:function(e){Q.log("Destroyed handle:"),Q.debug(e),"success"!==e.janus&&Q.error("Ooops: "+e.error.code+" "+e.error.reason),delete E[n],r.success()},error:function(e,t){Q.error(e+":",t),delete E[n],r.success()}})}function L(r,n,o,i,a){var s=E[r];if(!s||!s.webrtcStuff)return Q.warn("Invalid handle"),i.stream||Q.stopAllTracks(a),void i.error("Invalid handle");var c=s.webrtcStuff;Q.debug("streamsDone:",a),a&&(Q.debug("  -- Audio tracks:",a.getAudioTracks()),Q.debug("  -- Video tracks:",a.getVideoTracks()));var u,e=!1;if(c.myStream&&o.update&&!c.streamExternal){if((!o.update&&H(o)||o.update&&(o.addAudio||o.replaceAudio))&&a.getAudioTracks()&&a.getAudioTracks().length)if(c.myStream.addTrack(a.getAudioTracks()[0]),Q.unifiedPlan){Q.log((o.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]);var t=null;if((_=c.pc.getTransceivers())&&0<_.length){var l,d=X(_);try{for(d.s();!(l=d.n()).done;)if((h=l.value).sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind){t=h;break}}catch(r){d.e(r)}finally{d.f()}}t&&t.sender?t.sender.replaceTrack(a.getAudioTracks()[0]):c.pc.addTrack(a.getAudioTracks()[0],a)}else Q.log((o.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]),c.pc.addTrack(a.getAudioTracks()[0],a);if((!o.update&&J(o)||o.update&&(o.addVideo||o.replaceVideo))&&a.getVideoTracks()&&a.getVideoTracks().length)if(c.myStream.addTrack(a.getVideoTracks()[0]),Q.unifiedPlan){Q.log((o.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]);var p=null;if((_=c.pc.getTransceivers())&&0<_.length){var f,h,m=X(_);try{for(m.s();!(f=m.n()).done;)if((h=f.value).sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind){p=h;break}}catch(r){m.e(r)}finally{m.f()}}p&&p.sender?p.sender.replaceTrack(a.getVideoTracks()[0]):c.pc.addTrack(a.getVideoTracks()[0],a)}else Q.log((o.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]),c.pc.addTrack(a.getVideoTracks()[0],a)}else c.myStream=a,e=!0;if(!c.pc){var _={iceServers:y,iceTransportPolicy:b,bundlePolicy:w};"chrome"===Q.webRTCAdapter.browserDetails.browser&&(_.sdpSemantics=Q.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var g={optional:[{DtlsSrtpKeyAgreement:!0}]};if(S&&g.optional.push({googIPv6:!0}),i.rtcConstraints&&"object"===K(i.rtcConstraints))for(var v in Q.debug("Adding custom PeerConnection constraints:",i.rtcConstraints),i.rtcConstraints)g.optional.push(i.rtcConstraints[v]);"edge"===Q.webRTCAdapter.browserDetails.browser&&(_.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(i.senderTransforms||i.receiverTransforms)&&(c.senderTransforms=i.senderTransforms,c.receiverTransforms=i.receiverTransforms,_.forceEncodedAudioInsertableStreams=!0,_.forceEncodedVideoInsertableStreams=!0,_.encodedInsertableStreams=!0),Q.log("Creating PeerConnection"),Q.debug(g),c.pc=new RTCPeerConnection(_,g),Q.debug(c.pc),c.pc.getStats&&(c.volume={},c.bitrate.value="0 kbits/sec"),Q.log("Preparing local SDP and gathering candidates (trickle="+c.trickle+")"),c.pc.oniceconnectionstatechange=function(e){c.pc&&s.iceState(c.pc.iceConnectionState)},c.pc.onicecandidate=function(e){var t,n;!e.candidate||"edge"===Q.webRTCAdapter.browserDetails.browser&&0<e.candidate.candidate.indexOf("endOfCandidates")?(Q.log("End of candidates."),(c.iceDone=!0)===c.trickle?M(r,{completed:!0}):(t=r,(n=(n=i)||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,(t=E[t])&&t.webrtcStuff?(t=t.webrtcStuff,Q.log("Sending offer/answer SDP..."),t.mySdp?(!(t.mySdp={type:t.pc.localDescription.type,sdp:t.pc.localDescription.sdp})===t.trickle&&(t.mySdp.trickle=!1),Q.debug(n),t.sdpSent=!0,n.success(t.mySdp)):Q.warn("Local SDP instance is invalid, not sending anything...")):Q.warn("Invalid handle, not sending anything"))):(e={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex},!0===c.trickle&&M(r,e))},c.pc.ontrack=function(e){var t,n;Q.log("Handling Remote Track"),Q.debug(e),e.streams&&(c.remoteStream=e.streams[0],s.onremotestream(c.remoteStream),!e.track.onended)&&(c.receiverTransforms&&(t=null,RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&c.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&c.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(c.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(c.receiverTransforms[e.track.kind]).pipeTo(t.writable))),n=null,Q.log("Adding onended callback to track:",e.track),e.track.onended=function(e){Q.log("Remote track removed:",e),c.remoteStream&&(clearTimeout(n),c.remoteStream.removeTrack(e.target),s.onremotestream(c.remoteStream))},e.track.onmute=function(e){Q.log("Remote track muted:",e),c.remoteStream&&null==n&&(n=setTimeout(function(){Q.log("Removing remote track"),c.remoteStream&&(c.remoteStream.removeTrack(e.target),s.onremotestream(c.remoteStream)),n=null},2520))},e.track.onunmute=function(e){if(Q.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{c.remoteStream.addTrack(e.target),s.onremotestream(c.remoteStream)}catch(e){Q.error(e)}})}}e&&a&&(Q.log("Adding local stream"),u=!0===i.simulcast2,a.getTracks().forEach(function(e){Q.log("Adding local track:",e);var t,n=null;u&&"audio"!==e.kind?(Q.log("Enabling rid-based simulcasting:",e),t=k(i.simulcastMaxBitrates),(t=c.pc.addTransceiver(e,{direction:"sendrecv",streams:[a],sendEncodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]}))&&(n=t.sender)):n=c.pc.addTrack(e,a),n&&c.senderTransforms&&(e=null,RTCRtpSender.prototype.createEncodedStreams?e=n.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===n.track.kind&&c.senderTransforms.audio?e=n.createEncodedAudioStreams():"video"===n.track.kind&&c.senderTransforms.video&&(e=n.createEncodedVideoStreams())),e&&(console.log(e),e.readableStream&&e.writableStream?e.readableStream.pipeThrough(c.senderTransforms[n.track.kind]).pipeTo(e.writableStream):e.readable&&e.writable&&e.readable.pipeThrough(c.senderTransforms[n.track.kind]).pipeTo(e.writable)))})),e=o,Q.debug("isDataEnabled:",e),("edge"===Q.webRTCAdapter.browserDetails.browser?(Q.warn("Edge doesn't support data channels yet"),0):null!=e&&!0===e.data)&&!c.dataChannel[Q.dataChanDefaultLabel]&&(Q.log("Creating default data channel"),j(r,Q.dataChanDefaultLabel,null,!1),c.pc.ondatachannel=function(e){Q.log("Data channel created by Janus:",e),j(r,e.channel.label,e.channel.protocol,e.channel)}),c.myStream&&s.onlocalstream(c.myStream),n?c.pc.setRemoteDescription(n).then(function(){if(Q.log("Remote description accepted!"),c.remoteSdp=n.sdp,c.candidates&&0<c.candidates.length){for(var e=0;e<c.candidates.length;e++){var t=c.candidates[e];Q.debug("Adding remote candidate:",t),t&&!0!==t.completed?c.pc.addIceCandidate(t):c.pc.addIceCandidate(Q.endOfCandidates)}c.candidates=[]}!function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:Q.noop;var r=E[e];if(!r||!r.webrtcStuff)return Q.warn("Invalid handle"),n.error("Invalid handle");var o=r.webrtcStuff,i=!0===n.simulcast;i?Q.log("Creating answer (iceDone="+o.iceDone+", simulcast="+i+")"):Q.log("Creating answer (iceDone="+o.iceDone+")");var a=null;if(Q.unifiedPlan){a={};var s=null,c=null,u=o.pc.getTransceivers();if(u&&0<u.length){var l=X(u);try{for(l.s();!(d=l.n()).done;){var d=d.value;d.sender&&d.sender.track&&"audio"===d.sender.track.kind||d.receiver&&d.receiver.track&&"audio"===d.receiver.track.kind?s=s||d:(d.sender&&d.sender.track&&"video"===d.sender.track.kind||d.receiver&&d.receiver.track&&"video"===d.receiver.track.kind)&&(c=c||d)}}catch(e){l.e(e)}finally{l.f()}}r=H(t),u=z(t);if(r||u){if(r&&u){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",Q.log("Setting audio transceiver to sendrecv:",s)}catch(e){Q.error(e)}}else if(r&&!u)try{s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",Q.log("Setting audio transceiver to sendonly:",s))}catch(e){Q.error(e)}else if(!r&&u)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",Q.log("Setting audio transceiver to recvonly:",s)}catch(e){Q.error(e)}else s=o.pc.addTransceiver("audio",{direction:"recvonly"}),Q.log("Adding recvonly audio transceiver:",s)}else if(t.removeAudio&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",Q.log("Setting audio transceiver to inactive:",s)}catch(e){Q.error(e)}r=J(t),u=Y(t);if(r||u){if(r&&u){if(c)try{c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",Q.log("Setting video transceiver to sendrecv:",c)}catch(e){Q.error(e)}}else if(r&&!u){if(c)try{c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",Q.log("Setting video transceiver to sendonly:",c)}catch(e){Q.error(e)}}else if(!r&&u)if(c)try{c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",Q.log("Setting video transceiver to recvonly:",c)}catch(e){Q.error(e)}else c=o.pc.addTransceiver("video",{direction:"recvonly"}),Q.log("Adding recvonly video transceiver:",c)}else if(t.removeVideo&&c)try{c.setDirection?c.setDirection("inactive"):c.direction="inactive",Q.log("Setting video transceiver to inactive:",c)}catch(e){Q.error(e)}}else a="firefox"===Q.webRTCAdapter.browserDetails.browser||"edge"===Q.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:z(t),offerToReceiveVideo:Y(t)}:{mandatory:{OfferToReceiveAudio:z(t),OfferToReceiveVideo:Y(t)}};Q.debug(a);var p=J(t);p&&i&&"firefox"===Q.webRTCAdapter.browserDetails.browser&&(Q.log("Enabling Simulcasting for Firefox (RID)"),u=o.pc.getSenders()[1],Q.log(u),t=u.getParameters(),Q.log(t),t=k(n.simulcastMaxBitrates),u.setParameters({encodings:n.sendEncodings||[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})),o.pc.createAnswer(a).then(function(e){Q.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,Q.log("Setting local description"),p&&i&&("chrome"===Q.webRTCAdapter.browserDetails.browser?Q.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==Q.webRTCAdapter.browserDetails.browser&&Q.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp={type:"answer",sdp:e.sdp},o.pc.setLocalDescription(e).catch(n.error),o.mediaConstraints=a,o.iceDone||o.trickle?((o.senderTransforms||o.receiverTransforms)&&(e.e2ee=!0),n.success(e)):Q.log("Waiting for all candidates...")},n.error)}(r,o,i)},i.error):function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:Q.noop;var r=E[e];if(!r||!r.webrtcStuff)return Q.warn("Invalid handle"),n.error("Invalid handle");var o=r.webrtcStuff,i=!0===n.simulcast;i?Q.log("Creating offer (iceDone="+o.iceDone+", simulcast="+i+")"):Q.log("Creating offer (iceDone="+o.iceDone+")");var a={};if(Q.unifiedPlan){var s=null,c=null,u=o.pc.getTransceivers();if(u&&0<u.length){var l=X(u);try{for(l.s();!(d=l.n()).done;){var d=d.value;d.sender&&d.sender.track&&"audio"===d.sender.track.kind||d.receiver&&d.receiver.track&&"audio"===d.receiver.track.kind?s=s||d:(d.sender&&d.sender.track&&"video"===d.sender.track.kind||d.receiver&&d.receiver.track&&"video"===d.receiver.track.kind)&&(c=c||d)}}catch(e){l.e(e)}finally{l.f()}}var p=H(t),u=z(t);p||u?p&&u?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",Q.log("Setting audio transceiver to sendrecv:",s)):p&&!u?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",Q.log("Setting audio transceiver to sendonly:",s)):!p&&u&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",Q.log("Setting audio transceiver to recvonly:",s)):(s=o.pc.addTransceiver("audio",{direction:"recvonly"}),Q.log("Adding recvonly audio transceiver:",s))):t.removeAudio&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",Q.log("Setting audio transceiver to inactive:",s));p=J(t),u=Y(t);p||u?p&&u?c&&(c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",Q.log("Setting video transceiver to sendrecv:",c)):p&&!u?c&&(c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",Q.log("Setting video transceiver to sendonly:",c)):!p&&u&&(c?(c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",Q.log("Setting video transceiver to recvonly:",c)):(c=o.pc.addTransceiver("video",{direction:"recvonly"}),Q.log("Adding recvonly video transceiver:",c))):t.removeVideo&&c&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive",Q.log("Setting video transceiver to inactive:",c))}else a.offerToReceiveAudio=z(t),a.offerToReceiveVideo=Y(t);!0===n.iceRestart&&(a.iceRestart=!0),Q.debug(a);var f=J(t);f&&i&&"firefox"===Q.webRTCAdapter.browserDetails.browser&&(Q.log("Enabling Simulcasting for Firefox (RID)"),(p=o.pc.getSenders().find(function(e){return"video"===e.track.kind}))&&(u=(u=p.getParameters())||{},t=k(n.simulcastMaxBitrates),u.encodings=n.sendEncodings||[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}],p.setParameters(u))),o.pc.createOffer(a).then(function(e){Q.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,Q.log("Setting local description"),f&&i&&("chrome"===Q.webRTCAdapter.browserDetails.browser||"safari"===Q.webRTCAdapter.browserDetails.browser?(Q.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t,n,r=e.split("\r\n"),o=!1,i=[-1],a=[-1],s=null,c=null,u=null,l=null,d=-1,p=0;p<r.length;p++)if(t=r[p].match(/m=(\w+) */)){if("video"===t[1]){if(!(i[0]<0)){d=p;break}o=!0}else if(-1<i[0]){d=p;break}}else if(o){if(r[p].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/))return Q.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var f=r[p].match(/a=ssrc-group:FID (\d+) (\d+)/);if(f)i[0]=f[1],a[0]=f[2],r.splice(p,1),p--;else{if(i[0]){if((n=r[p].match("a=ssrc:"+i[0]+" cname:(.+)"))&&(s=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" msid:(.+)"))&&(c=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" mslabel:(.+)"))&&(u=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" label:(.+)"))&&(l=n[1]),0===r[p].indexOf("a=ssrc:"+a[0])){r.splice(p,1),p--;continue}if(0===r[p].indexOf("a=ssrc:"+i[0])){r.splice(p,1),p--;continue}}0!=r[p].length||(r.splice(p,1),p--)}}if(i[0]<0)for(o=!(d=-1),p=0;p<r.length;p++)if(t=r[p].match(/m=(\w+) */)){if("video"===t[1]){if(!(i[0]<0)){d=p;break}o=!0}else if(-1<i[0]){d=p;break}}else if(o){if(i[0]<0){var h=r[p].match(/a=ssrc:(\d+)/);if(h){i[0]=h[1],r.splice(p,1),p--;continue}}else{if((n=r[p].match("a=ssrc:"+i[0]+" cname:(.+)"))&&(s=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" msid:(.+)"))&&(c=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" mslabel:(.+)"))&&(u=n[1]),(n=r[p].match("a=ssrc:"+i[0]+" label:(.+)"))&&(l=n[1]),0===r[p].indexOf("a=ssrc:"+a[0])){r.splice(p,1),p--;continue}if(0===r[p].indexOf("a=ssrc:"+i[0])){r.splice(p,1),p--;continue}}0!==r[p].length||(r.splice(p,1),p--)}if(i[0]<0)return Q.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;for(d<0&&(d=r.length),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random()),a[1]=Math.floor(4294967295*Math.random()),a[2]=Math.floor(4294967295*Math.random()),p=0;p<i.length;p++)s&&(r.splice(d,0,"a=ssrc:"+i[p]+" cname:"+s),d++),c&&(r.splice(d,0,"a=ssrc:"+i[p]+" msid:"+c),d++),u&&(r.splice(d,0,"a=ssrc:"+i[p]+" mslabel:"+u),d++),l&&(r.splice(d,0,"a=ssrc:"+i[p]+" label:"+l),d++),s&&(r.splice(d,0,"a=ssrc:"+a[p]+" cname:"+s),d++),c&&(r.splice(d,0,"a=ssrc:"+a[p]+" msid:"+c),d++),u&&(r.splice(d,0,"a=ssrc:"+a[p]+" mslabel:"+u),d++),l&&(r.splice(d,0,"a=ssrc:"+a[p]+" label:"+l),d++);return r.splice(d,0,"a=ssrc-group:FID "+i[2]+" "+a[2]),r.splice(d,0,"a=ssrc-group:FID "+i[1]+" "+a[1]),r.splice(d,0,"a=ssrc-group:FID "+i[0]+" "+a[0]),r.splice(d,0,"a=ssrc-group:SIM "+i[0]+" "+i[1]+" "+i[2]),(e=r.join("\r\n")).endsWith("\r\n")||(e+="\r\n"),e}(e.sdp)):"firefox"!==Q.webRTCAdapter.browserDetails.browser&&Q.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp={type:"offer",sdp:e.sdp},o.pc.setLocalDescription(e).catch(n.error),o.mediaConstraints=a,o.iceDone||o.trickle?((o.senderTransforms||o.receiverTransforms)&&(e.e2ee=!0),n.success(e)):Q.log("Waiting for all candidates...")},n.error)}(r,o,i)}function B(a,e,s){(s=s||{}).success="function"==typeof s.success?s.success:Q.noop,s.error="function"==typeof s.error?s.error:W;var c=s.jsep;if(e&&c)return Q.error("Provided a JSEP to a createOffer"),s.error("Provided a JSEP to a createOffer"),0;if(!(e||c&&c.type&&c.sdp))return Q.error("A valid JSEP is required for createAnswer"),s.error("A valid JSEP is required for createAnswer"),0;s.media="object"===K(s.media)&&s.media?s.media:{audio:!0,video:!0};var u=s.media,l=E[a];if(!l||!l.webrtcStuff)return Q.warn("Invalid handle"),s.error("Invalid handle"),0;var t=l.webrtcStuff;if(t.trickle=(e=s.trickle,Q.debug("isTrickleEnabled:",e),!1!==e),t.pc){if(Q.log("Updating existing media session"),u.update=!0,s.stream)s.stream!==t.myStream&&Q.log("Renegotiation involves a new external stream");else{if(u.addAudio){if(u.keepAudio=!1,u.replaceAudio=!1,u.removeAudio=!1,u.audioSend=!0,t.myStream&&t.myStream.getAudioTracks()&&t.myStream.getAudioTracks().length)return Q.error("Can't add audio stream, there already is one"),s.error("Can't add audio stream, there already is one"),0}else u.removeAudio?(u.keepAudio=!1,u.replaceAudio=!1,u.addAudio=!1,u.audioSend=!1):u.replaceAudio&&(u.keepAudio=!1,u.addAudio=!1,u.removeAudio=!1,u.audioSend=!0);if(t.myStream&&t.myStream.getAudioTracks()&&0!==t.myStream.getAudioTracks().length?!H(u)||u.removeAudio||u.replaceAudio||(u.keepAudio=!0):(u.replaceAudio&&(u.keepAudio=!1,u.replaceAudio=!1,u.addAudio=!0,u.audioSend=!0),H(u)&&(u.keepAudio=!1,u.addAudio=!0)),u.addVideo){if(u.keepVideo=!1,u.replaceVideo=!1,u.removeVideo=!1,u.videoSend=!0,t.myStream&&t.myStream.getVideoTracks()&&t.myStream.getVideoTracks().length)return Q.error("Can't add video stream, there already is one"),s.error("Can't add video stream, there already is one"),0}else u.removeVideo?(u.keepVideo=!1,u.replaceVideo=!1,u.addVideo=!1,u.videoSend=!1):u.replaceVideo&&(u.keepVideo=!1,u.addVideo=!1,u.removeVideo=!1,u.videoSend=!0);t.myStream&&t.myStream.getVideoTracks()&&0!==t.myStream.getVideoTracks().length?!J(u)||u.removeVideo||u.replaceVideo||(u.keepVideo=!0):(u.replaceVideo&&(u.keepVideo=!1,u.replaceVideo=!1,u.addVideo=!0,u.videoSend=!0),J(u)&&(u.keepVideo=!1,u.addVideo=!0)),u.addData&&(u.data=!0)}if(H(u)&&u.keepAudio&&J(u)&&u.keepVideo)return l.consentDialog(!1),L(a,c,u,s,t.myStream),0}else u.update=!1,u.keepAudio=!1,u.keepVideo=!1;if(u.update&&!t.streamExternal){if(u.removeAudio||u.replaceAudio){if(t.myStream&&t.myStream.getAudioTracks()&&t.myStream.getAudioTracks().length){var n=t.myStream.getAudioTracks()[0];Q.log("Removing audio track:",n),t.myStream.removeTrack(n);try{n.stop()}catch(a){}}if(t.pc.getSenders()&&t.pc.getSenders().length){var r=!0;if(u.replaceAudio&&Q.unifiedPlan&&(r=!1),r){var o=X(t.pc.getSenders());try{for(o.s();!(i=o.n()).done;){var i=i.value;i&&i.track&&"audio"===i.track.kind&&(Q.log("Removing audio sender:",i),t.pc.removeTrack(i))}}catch(a){o.e(a)}finally{o.f()}}}}if(u.removeVideo||u.replaceVideo){if(t.myStream&&t.myStream.getVideoTracks()&&t.myStream.getVideoTracks().length){var d=t.myStream.getVideoTracks()[0];Q.log("Removing video track:",d),t.myStream.removeTrack(d);try{d.stop()}catch(a){}}if(t.pc.getSenders()&&t.pc.getSenders().length){var p=!0;if(u.replaceVideo&&Q.unifiedPlan&&(p=!1),p){var f=X(t.pc.getSenders());try{for(f.s();!(h=f.n()).done;){var h=h.value;h&&h.track&&"video"===h.track.kind&&(Q.log("Removing video sender:",h),t.pc.removeTrack(h))}}catch(a){f.e(a)}finally{f.f()}}}}}if(s.stream){var m=s.stream;return Q.log("MediaStream provided by the application"),Q.debug(m),u.update&&t.myStream&&t.myStream!==s.stream&&!t.streamExternal&&(Q.stopAllTracks(t.myStream),t.myStream=null),t.streamExternal=!0,l.consentDialog(!1),L(a,c,u,s,m),0}if(H(u)||J(u)){if(!Q.isGetUserMediaAvailable())return s.error("getUserMedia not available"),0;var _={mandatory:{},optional:[]};l.consentDialog(!0);var g=H(u);g&&u&&"object"===K(u.audio)&&(g=u.audio);var v=J(u);if(v&&u){r=!0===s.simulcast,p=!0===s.simulcast2;if(!r&&!p||c||u.video||(u.video="hires"),u.video&&"screen"!=u.video&&"window"!=u.video)"object"===K(u.video)?v=u.video:(p=w=0,w="lowres"===u.video?(p=240,320):"lowres-16:9"===u.video?(p=180,320):"hires"===u.video||"hires-16:9"===u.video||"hdres"===u.video?(p=720,1280):"fhdres"===u.video?(p=1080,1920):"4kres"===u.video?(p=2160,3840):(p="stdres"===u.video?480:"stdres-16:9"===u.video?360:(Q.log("Default video setting is stdres 4:3"),480),640),Q.log("Adding media constraint:",u.video),v={height:{ideal:p},width:{ideal:w}},Q.log("Adding video constraint:",v));else if("screen"===u.video||"window"===u.video){function y(e,t){l.consentDialog(!1),e?s.error(e):L(a,c,u,s,t)}function b(e,n,r){Q.log("Adding media constraint (screen capture)"),Q.debug(e),navigator.mediaDevices.getUserMedia(e).then(function(t){r?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){t.addTrack(e.getAudioTracks()[0]),n(null,t)}):n(null,t)}).catch(function(e){l.consentDialog(!1),n(e)})}if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return _.video={},u.screenshareFrameRate&&(_.video.frameRate=u.screenshareFrameRate),u.screenshareHeight&&(_.video.height=u.screenshareHeight),u.screenshareWidth&&(_.video.width=u.screenshareWidth),_.audio=u.captureDesktopAudio,navigator.mediaDevices.getDisplayMedia(_).then(function(t){l.consentDialog(!1),H(u)&&!u.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){t.addTrack(e.getAudioTracks()[0]),L(a,c,u,s,t)}):L(a,c,u,s,t)},function(e){l.consentDialog(!1),s.error(e)}),0;if("chrome"===Q.webRTCAdapter.browserDetails.browser){var w=Q.webRTCAdapter.browserDetails.version,S=33;window.navigator.userAgent.match("Linux")&&(S=35),26<=w&&w<=S?(_={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:u.screenshareFrameRate,maxFrameRate:u.screenshareFrameRate,chromeMediaSource:"screen"}},audio:H(u)&&!u.keepAudio},b(_,y)):Q.extension.getScreen(function(e,t){return e?(l.consentDialog(!1),s.error(e)):((_={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:u.screenshareFrameRate,maxFrameRate:u.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,void b(_,y,H(u)&&!u.keepAudio))})}else if("firefox"===Q.webRTCAdapter.browserDetails.browser){if(!(33<=Q.webRTCAdapter.browserDetails.version)){S=new Error("NavigatorUserMediaError");return S.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",l.consentDialog(!1),s.error(S),0}_={video:{mozMediaSource:u.video,mediaSource:u.video},audio:H(u)&&!u.keepAudio},b(_,function(e,t){var n,r;y(e,t),e||(n=t.currentTime,r=window.setInterval(function(){t||window.clearInterval(r),t.currentTime==n&&(window.clearInterval(r),t.onended&&t.onended()),n=t.currentTime},500))})}return}}u&&"screen"===u.video||navigator.mediaDevices.enumerateDevices().then(function(e){var t,n=e.some(function(e){return"audioinput"===e.kind}),r=function(e){if(Q.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==K(e.video)||"object"!==K(e.video.mandatory))return!1;e=e.video.mandatory;return e.chromeMediaSource?"desktop"===e.chromeMediaSource||"screen"===e.chromeMediaSource:e.mozMediaSource?"window"===e.mozMediaSource||"screen"===e.mozMediaSource:!!e.mediaSource&&("window"===e.mediaSource||"screen"===e.mediaSource)}(u)||e.some(function(e){return"videoinput"===e.kind}),o=H(u),i=J(u),e=(t=u,Q.debug("isAudioSendRequired:",t),!!t&&!1!==t.audio&&!1!==t.audioSend&&void 0!==t.failIfNoAudio&&null!==t.failIfNoAudio&&!0===t.failIfNoAudio),t=(t=u,Q.debug("isVideoSendRequired:",t),!!t&&!1!==t.video&&!1!==t.videoSend&&void 0!==t.failIfNoVideo&&null!==t.failIfNoVideo&&!0===t.failIfNoVideo);if(o||i||e||t){o=!!o&&n,i=!!i&&r;if(!o&&!i)return l.consentDialog(!1),s.error("No capture device found"),!1;if(!o&&e)return l.consentDialog(!1),s.error("Audio capture is required, but no capture device found"),!1;if(!i&&t)return l.consentDialog(!1),s.error("Video capture is required, but no capture device found"),!1}r={audio:!(!n||u.keepAudio)&&g,video:!(!r||u.keepVideo)&&v};Q.debug("getUserMedia constraints",r),r.audio||r.video?navigator.mediaDevices.getUserMedia(r).then(function(e){l.consentDialog(!1),L(a,c,u,s,e)}).catch(function(e){l.consentDialog(!1),s.error({code:e.code,name:e.name,message:e.message})}):(l.consentDialog(!1),L(a,c,u,s,m))}).catch(function(e){l.consentDialog(!1),s.error(e)})}else L(a,c,u,s)}function F(e,n){(n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:W;var r=n.jsep,e=E[e];if(!e||!e.webrtcStuff)return Q.warn("Invalid handle"),n.error("Invalid handle"),0;var o=e.webrtcStuff;if(r){if(!o.pc)return Q.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),n.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep"),0;o.pc.setRemoteDescription(r).then(function(){if(Q.log("Remote description accepted!"),o.remoteSdp=r.sdp,o.candidates&&0<o.candidates.length){for(var e=0;e<o.candidates.length;e++){var t=o.candidates[e];Q.debug("Adding remote candidate:",t),t&&!0!==t.completed?o.pc.addIceCandidate(t):o.pc.addIceCandidate(Q.endOfCandidates)}o.candidates=[]}n.success()},n.error)}else n.error("Invalid JSEP")}function N(e,t){e=E[e];if(!e||!e.webrtcStuff)return Q.warn("Invalid handle"),0;var n=t?"remote":"local",r=e.webrtcStuff;return r.volume[n]||(r.volume[n]={value:0}),!r.pc.getStats||"chrome"!==Q.webRTCAdapter.browserDetails.browser&&"safari"!==Q.webRTCAdapter.browserDetails.browser?(Q.warn("Getting the "+n+" volume unsupported by browser"),0):t&&!r.remoteStream?(Q.warn("Remote stream unavailable"),0):t||r.myStream?r.volume[n].timer?r.volume[n].value:(Q.log("Starting "+n+" volume monitor"),r.volume[n].timer=setInterval(function(){r.pc.getStats().then(function(e){e.forEach(function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(r.volume[n].value=e.audioLevel||0))})})},200),0):(Q.warn("Local stream unavailable"),0)}function $(e,t){e=E[e];if(!e||!e.webrtcStuff)return Q.warn("Invalid handle"),!0;e=e.webrtcStuff;return e.pc?e.myStream?t?e.myStream.getVideoTracks()&&0!==e.myStream.getVideoTracks().length?!e.myStream.getVideoTracks()[0].enabled:(Q.warn("No video track"),!0):e.myStream.getAudioTracks()&&0!==e.myStream.getAudioTracks().length?!e.myStream.getAudioTracks()[0].enabled:(Q.warn("No audio track"),!0):(Q.warn("Invalid local MediaStream"),!0):(Q.warn("Invalid PeerConnection"),!0)}function q(e,t,n){e=E[e];if(!e||!e.webrtcStuff)return Q.warn("Invalid handle"),!1;e=e.webrtcStuff;return e.pc?e.myStream?t?e.myStream.getVideoTracks()&&0!==e.myStream.getVideoTracks().length?(e.myStream.getVideoTracks()[0].enabled=!n,!0):(Q.warn("No video track"),!1):e.myStream.getAudioTracks()&&0!==e.myStream.getAudioTracks().length?(e.myStream.getAudioTracks()[0].enabled=!n,!0):(Q.warn("No audio track"),!1):(Q.warn("Invalid local MediaStream"),!1):(Q.warn("Invalid PeerConnection"),!1)}function G(e){e=E[e];if(!e||!e.webrtcStuff)return Q.warn("Invalid handle"),"Invalid handle";var n=e.webrtcStuff;return n.pc?n.pc.getStats?n.bitrate.timer?n.bitrate.value:(Q.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval(function(){n.pc.getStats().then(function(e){e.forEach(function(e){var t;e&&(t=!1,(("video"===e.mediaType||-1<e.id.toLowerCase().indexOf("video"))&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0||"ssrc"==e.type&&e.bytesReceived&&("VP8"===e.googCodecName||""===e.googCodecName))&&(t=!0),t&&(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore||(e=n.bitrate.tsnow-n.bitrate.tsbefore,"safari"===Q.webRTCAdapter.browserDetails.browser&&(e/=1e3),e=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/e),"safari"===Q.webRTCAdapter.browserDetails.browser&&(e=parseInt(e/1e3)),n.bitrate.value=e+" kbits/sec"),n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow))})})},1e3),"0 kbits/sec"):(Q.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function W(e){Q.error("WebRTC error:",e)}function V(e,t){Q.log("Cleaning WebRTC stuff");var n=E[e];if(n){var r=n.webrtcStuff;if(r){!0===t&&(t={janus:"hangup",transaction:Q.randomString(12)},n.token&&(t.token=n.token),g&&(t.apisecret=g),Q.debug("Sending hangup request (handle="+e+"):"),Q.debug(t),l?(t.session_id=C,t.handle_id=e,d.send(JSON.stringify(t))):Q.httpAPICall(h+"/"+C+"/"+e,{verb:"POST",withCredentials:m,body:t})),r.remoteStream=null,r.volume&&(r.volume.local&&r.volume.local.timer&&clearInterval(r.volume.local.timer),r.volume.remote&&r.volume.remote.timer&&clearInterval(r.volume.remote.timer)),r.volume={},r.bitrate.timer&&clearInterval(r.bitrate.timer),r.bitrate.timer=null,r.bitrate.bsnow=null,r.bitrate.bsbefore=null,r.bitrate.tsnow=null,r.bitrate.tsbefore=null,r.bitrate.value=null,!r.streamExternal&&r.myStream&&(Q.log("Stopping local stream tracks"),Q.stopAllTracks(r.myStream)),r.streamExternal=!1,r.myStream=null;try{r.pc.close()}catch(e){}r.pc=null,r.candidates=null,r.mySdp=null,r.remoteSdp=null,r.iceDone=!1,r.dataChannel={},r.dtmfSender=null,r.senderTransforms=null,r.receiverTransforms=null}n.oncleanup()}}function H(e){return Q.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function z(e){return Q.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function J(e){return Q.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function Y(e){return Q.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}R(u),this.getServer=function(){return h},this.isConnected=function(){return v},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:Q.noop,e.error="function"==typeof e.error?e.error:Q.noop,e.reconnect=!0,R(e)},this.getSessionId=function(){return C},this.getInfo=function(e){!function(n){if((n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,Q.log("Getting info on Janus instance"),!v)return Q.warn("Is the server down? (connected=false)"),n.error("Is the server down? (connected=false)");var e=Q.randomString(12),t={janus:"info",transaction:e};if(_&&(t.token=_),g&&(t.apisecret=g),l)return T[e]=function(e){Q.log("Server info:"),Q.debug(e),"server_info"!==e.janus&&Q.error("Ooops: "+e.error.code+" "+e.error.reason),n.success(e)},d.send(JSON.stringify(t));Q.httpAPICall(h,{verb:"POST",withCredentials:m,body:t,success:function(e){Q.log("Server info:"),Q.debug(e),"server_info"!==e.janus&&Q.error("Ooops: "+e.error.code+" "+e.error.reason),n.success(e)},error:function(e,t){Q.error(e+":",t),""===t?n.error(e+": Is the server down?"):n.error(e+": "+t)}})}(e)},this.destroy=function(e){!function(n){(n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop;var e=!0===n.unload,r=!0;void 0!==n.notifyDestroyed&&null!==n.notifyDestroyed&&(r=!0===n.notifyDestroyed);var t=!0===n.cleanupHandles;if(Q.log("Destroying session "+C+" (unload="+e+")"),!C)return Q.warn("No session to destroy"),n.success(),r&&u.destroyed();if(t)for(var o in E)U(o,{noRequest:!0});if(!v)return Q.warn("Is the server down? (connected=false)"),C=null,n.success();var i={janus:"destroy",transaction:Q.randomString(12)};if(_&&(i.token=_),g&&(i.apisecret=g),e)return l?(d.onclose=null,d.close(),d=null):navigator.sendBeacon(h+"/"+C,JSON.stringify(i)),Q.log("Destroyed session:"),C=null,v=!1,n.success(),r&&u.destroyed();if(l){i.session_id=C;function a(){for(var e in p)d.removeEventListener(e,p[e]);d.removeEventListener("message",s),d.removeEventListener("error",c),f&&clearTimeout(f),d.close()}var s=function(e){e=JSON.parse(e.data);e.session_id==i.session_id&&e.transaction==i.transaction&&(a(),n.success(),r&&u.destroyed())},c=function(e){a(),n.error("Failed to destroy the server: Is the server down?"),r&&u.destroyed()};return d.addEventListener("message",s),d.addEventListener("error",c),1===d.readyState?d.send(JSON.stringify(i)):c()}Q.httpAPICall(h+"/"+C,{verb:"POST",withCredentials:m,body:i,success:function(e){Q.log("Destroyed session:"),Q.debug(e),C=null,v=!1,"success"!==e.janus&&Q.error("Ooops: "+e.error.code+" "+e.error.reason),n.success(),r&&u.destroyed()},error:function(e,t){Q.error(e+":",t),C=null,v=!1,n.success(),r&&u.destroyed()}})}(e)},this.attach=function(e){!function(n){if((n=n||{}).success="function"==typeof n.success?n.success:Q.noop,n.error="function"==typeof n.error?n.error:Q.noop,n.consentDialog="function"==typeof n.consentDialog?n.consentDialog:Q.noop,n.iceState="function"==typeof n.iceState?n.iceState:Q.noop,n.mediaState="function"==typeof n.mediaState?n.mediaState:Q.noop,n.webrtcState="function"==typeof n.webrtcState?n.webrtcState:Q.noop,n.slowLink="function"==typeof n.slowLink?n.slowLink:Q.noop,n.onmessage="function"==typeof n.onmessage?n.onmessage:Q.noop,n.onlocalstream="function"==typeof n.onlocalstream?n.onlocalstream:Q.noop,n.onremotestream="function"==typeof n.onremotestream?n.onremotestream:Q.noop,n.ondata="function"==typeof n.ondata?n.ondata:Q.noop,n.ondataopen="function"==typeof n.ondataopen?n.ondataopen:Q.noop,n.oncleanup="function"==typeof n.oncleanup?n.oncleanup:Q.noop,n.ondetached="function"==typeof n.ondetached?n.ondetached:Q.noop,!v)return Q.warn("Is the server down? (connected=false)"),n.error("Is the server down? (connected=false)");var r=n.plugin;if(!r)return Q.error("Invalid plugin"),n.error("Invalid plugin");var e=n.opaqueId,o=n.token||_,t=Q.randomString(12),e={janus:"attach",plugin:r,opaque_id:e,transaction:t};if(o&&(e.token=o),g&&(e.apisecret=g),l)return T[t]=function(e){if(Q.debug(e),"success"!==e.janus)return Q.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error("Ooops: "+e.error.code+" "+e.error.reason);var t=e.data.id;Q.log("Created handle: "+t);e={session:s,plugin:r,id:t,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return t},getPlugin:function(){return r},getVolume:function(){return N(t,!0)},getRemoteVolume:function(){return N(t,!0)},getLocalVolume:function(){return N(t,!1)},isAudioMuted:function(){return $(t,!1)},muteAudio:function(){return q(t,!1,!0)},unmuteAudio:function(){return q(t,!1,!1)},isVideoMuted:function(){return $(t,!0)},muteVideo:function(){return q(t,!0,!0)},unmuteVideo:function(){return q(t,!0,!1)},getBitrate:function(){return G(t)},send:function(e){x(t,e)},data:function(e){D(t,e)},dtmf:function(e){I(t,e)},consentDialog:n.consentDialog,iceState:n.iceState,mediaState:n.mediaState,webrtcState:n.webrtcState,slowLink:n.slowLink,onmessage:n.onmessage,createOffer:function(e){B(t,!0,e)},createAnswer:function(e){B(t,!1,e)},handleRemoteJsep:function(e){F(t,e)},onlocalstream:n.onlocalstream,onremotestream:n.onremotestream,ondata:n.ondata,ondataopen:n.ondataopen,oncleanup:n.oncleanup,ondetached:n.ondetached,hangup:function(e){V(t,!0===e)},detach:function(e){U(t,e)}};E[t]=e,n.success(e)},e.session_id=C,d.send(JSON.stringify(e));Q.httpAPICall(h+"/"+C,{verb:"POST",withCredentials:m,body:e,success:function(e){if(Q.debug(e),"success"!==e.janus)return Q.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error("Ooops: "+e.error.code+" "+e.error.reason);var t=e.data.id;Q.log("Created handle: "+t);e={session:s,plugin:r,id:t,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return t},getPlugin:function(){return r},getVolume:function(){return N(t,!0)},getRemoteVolume:function(){return N(t,!0)},getLocalVolume:function(){return N(t,!1)},isAudioMuted:function(){return $(t,!1)},muteAudio:function(){return q(t,!1,!0)},unmuteAudio:function(){return q(t,!1,!1)},isVideoMuted:function(){return $(t,!0)},muteVideo:function(){return q(t,!0,!0)},unmuteVideo:function(){return q(t,!0,!1)},getBitrate:function(){return G(t)},send:function(e){x(t,e)},data:function(e){D(t,e)},dtmf:function(e){I(t,e)},consentDialog:n.consentDialog,iceState:n.iceState,mediaState:n.mediaState,webrtcState:n.webrtcState,slowLink:n.slowLink,onmessage:n.onmessage,createOffer:function(e){B(t,!0,e)},createAnswer:function(e){B(t,!1,e)},handleRemoteJsep:function(e){F(t,e)},onlocalstream:n.onlocalstream,onremotestream:n.onremotestream,ondata:n.ondata,ondataopen:n.ondataopen,oncleanup:n.oncleanup,ondetached:n.ondetached,hangup:function(e){V(t,!0===e)},detach:function(e){U(t,e)}};E[t]=e,n.success(e)},error:function(e,t){Q.error(e+":",t),""===t?n.error(e+": Is the server down?"):n.error(e+": "+t)}})}(e)}}Q.useDefaultDependencies=function(e){var n=e&&e.fetch||fetch,o=e&&e.Promise||Promise,r=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new r(e,t)},extension:e&&e.extension||i,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,r){var t={method:r.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===r.verb&&(t.headers["Content-Type"]="application/json"),void 0!==r.withCredentials&&(t.credentials=!0===r.withCredentials?"include":r.withCredentials||"omit"),r.body&&(t.body=JSON.stringify(r.body));e=n(e,t).catch(function(e){return o.reject({message:"Probably a network error, is the server down?",error:e})});return r.timeout&&(t=new o(function(e,t){var n=setTimeout(function(){return clearTimeout(n),t({message:"Request timed out",timeout:r.timeout})},r.timeout)}),e=o.race([e,t])),e.then(function(t){return t.ok?K(r.success)===K(Q.noop)?t.json().then(function(e){r.success(e)}).catch(function(e){return o.reject({message:"Failed to parse response body",error:e,response:t})}):void 0:o.reject({message:"API call failed",response:t})}).catch(function(e){K(r.error)===K(Q.noop)&&r.error(e.message||"<< internal error >>",e)}),e}}},Q.useOldDependencies=function(e){var o=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return o.isArray(e)},extension:e&&e.extension||i,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,r){var t=void 0!==r.body?{contentType:"application/json",data:JSON.stringify(r.body)}:{},n=void 0!==r.withCredentials?{xhrFields:{withCredentials:r.withCredentials}}:{};return o.ajax(o.extend(t,n,{url:e,type:r.verb,cache:!1,dataType:"json",async:r.async,timeout:r.timeout,success:function(e){K(r.success)===K(Q.noop)&&r.success(e)},error:function(e,t,n){K(r.error)===K(Q.noop)&&r.error(t,n)}}))}}},Q.noop=function(){},Q.dataChanDefaultLabel="JanusDataChannel",Q.endOfCandidates=null,Q.stopAllTracks=function(e){try{var t=X(e.getTracks());try{for(t.s();!(n=t.n()).done;){var n=n.value;Q.log(n),n&&n.stop()}}catch(e){t.e(e)}finally{t.f()}}catch(e){}},Q.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:Q.noop,Q.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),Q.trace=Q.noop,Q.debug=Q.noop,Q.vdebug=Q.noop,Q.log=Q.noop,Q.warn=Q.noop,Q.error=Q.noop,!0===e.debug||"all"===e.debug)Q.trace=console.trace.bind(console),Q.debug=console.debug.bind(console),Q.vdebug=console.debug.bind(console),Q.log=console.log.bind(console),Q.warn=console.warn.bind(console),Q.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,n=X(e.debug);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r){case"trace":Q.trace=console.trace.bind(console);break;case"debug":Q.debug=console.debug.bind(console);break;case"vdebug":Q.vdebug=console.debug.bind(console);break;case"log":Q.log=console.log.bind(console);break;case"warn":Q.warn=console.warn.bind(console);break;case"error":Q.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+r+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}}catch(e){n.e(e)}finally{n.f()}}Q.log("Initializing library");var o=e.dependencies||Q.useDefaultDependencies();Q.isArray=o.isArray,Q.webRTCAdapter=o.webRTCAdapter,Q.httpAPICall=o.httpAPICall,Q.newWebSocket=o.newWebSocket,Q.extension=o.extension,Q.extension.init(),Q.listDevices=function(n,e){n="function"==typeof n?n:Q.noop,null==e&&(e={audio:!0,video:!0}),Q.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(e).then(function(t){navigator.mediaDevices.enumerateDevices().then(function(e){Q.debug(e),n(e),Q.stopAllTracks(t)})}).catch(function(e){Q.error(e),n([])}):(Q.warn("navigator.mediaDevices unavailable"),n([]))},Q.attachMediaStream=function(t,n){try{t.srcObject=n}catch(e){try{t.src=URL.createObjectURL(n)}catch(t){Q.error("Error attaching stream to element")}}},Q.reattachMediaStream=function(t,n){try{t.srcObject=n.srcObject}catch(e){try{t.src=n.src}catch(t){Q.error("Error reattaching stream to element")}}};var o=0<=["iPad","iPhone","iPod"].indexOf(navigator.platform)?"pagehide":"beforeunload",i=window["on"+o];if(window.addEventListener(o,function(e){for(var t in Q.log("Closing window"),Q.sessions)Q.sessions[t]&&Q.sessions[t].destroyOnUnload&&(Q.log("Destroying session "+t),Q.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));i&&"function"==typeof i&&i()}),Q.safariVp8=!1,"safari"===Q.webRTCAdapter.browserDetails.browser&&605<=Q.webRTCAdapter.browserDetails.version)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var a=X(RTCRtpSender.getCapabilities("video").codecs);try{for(a.s();!(s=a.n()).done;){var s=s.value;if(s&&s.mimeType&&"video/vp8"===s.mimeType.toLowerCase()){Q.safariVp8=!0;break}}}catch(e){a.e(e)}finally{a.f()}Q.safariVp8?Q.log("This version of Safari supports VP8"):Q.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var c=new RTCPeerConnection({});c.createOffer({offerToReceiveVideo:!0}).then(function(e){Q.safariVp8=-1!==e.sdp.indexOf("VP8"),Q.safariVp8?Q.log("This version of Safari supports VP8"):Q.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),c.close(),c=null})}if(Q.unifiedPlan=!1,"firefox"===Q.webRTCAdapter.browserDetails.browser&&59<=Q.webRTCAdapter.browserDetails.version)Q.unifiedPlan=!0;else if("chrome"===Q.webRTCAdapter.browserDetails.browser&&72<=Q.webRTCAdapter.browserDetails.version)Q.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var u=new RTCPeerConnection;try{u.addTransceiver("audio"),Q.unifiedPlan=!0}catch(e){}u.close()}else Q.unifiedPlan=!1;Q.initDone=!0,e.callback()}},Q.isWebrtcSupported=function(){return!!window.RTCPeerConnection},Q.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},Q.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++){var o=Math.floor(Math.random()*t.length);n+=t.substring(o,o+1)}return n},e.exports=Q},function(e,t,n){"use strict";var i=n(9),a=n(0),o=n(6),s=n(18),r=n(20),c=n(30);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l,d,d=(l=p,d=[{key:"registerEvents",value:function(e){}},{key:"updateUser",value:function(t,e){var n=e.getState().users.filter(function(e){return e.id==t})[0];n&&((e=$(".public_message:not(.linen)[data-user='"+t+"']"))&&(e.find(".public_message__avatar img").attr("src",n.avatar),e.find(".public_message__title").html(o.a.render(n)),e.find(".public_message__content").css("color",n.fontColor)),(e=$(".public_message.linen[data-user='"+t+"']"))&&(e.find(".public_message__avatar img").attr("src",n.avatar),e.find(".public_message__title").html(o.a.render(n))))}},{key:"remove",value:function(e){window.publicMessagesContainer.find(".public_message[data-id='"+e+"']").remove()}},{key:"clearSelfMessages",value:function(){return window.publicMessagesContainer.find(".public_self_message").remove()}},{key:"renderGreetUserMessage",value:function(e,t){var n=Date.now(),r=e.icon?"/uploads/greeting-messages/"+e.icon:t.getState().mUser.room.flag,o="<div class='public_message' style='background-color: "+e.backgroundColor+"' >";return o+="<p class='public_message__avatar'>",o+="<img width='36' height='38' src='"+Object(a.c)()+r+"' />",o+="</p>",o+="<div>",o+="<h5 class='public_message__title' style='color: "+e.titleColor+"'>",o+=e.title,o+="</h5>",o+="<h5 class='public_message__content' style='color: "+e.contentColor+"'>",o+=i.a.render(e.content,t),o+="</h5>",o+="</div>",o+="<span class='public_message__time fr time' data-time='"+n+"' style='color: "+e.titleColor+"'>"+Object(a.q)(n)+"</span>",(o+="<div class='clear'></div>")+"</div>"}},{key:"renderJoinLeaveMessage",value:function(e,t){var n=Date.now(),r="<div class='public_message linen' data-user='"+e.user.id+"' >";return r+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",r+="<img width='36' height='38' src='"+Object(a.c)()+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title'>",e.user?r+=o.a.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content'>",r+=i.a.render(e.content,t),e.room&&(r+=s.a.render(e.room,!0,t)),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(a.q)(n)+"</span>",(r+="<div class='clear'></div>")+"</div>"}},{key:"renderRoomGreeting",value:function(e,t){var n=Date.now(),r="<div class='public_message greeting' style='background: "+t.getState().settings.self_message_bg_color+"' >";return r+="<p class='public_message__avatar'>",r+="<img width='36' height='38' src='"+Object(a.c)()+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>"+t.getState().settings.rooms_greeting_title+"</h5>",r+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",r+=i.a.render(e.content,t),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(a.q)(n)+"</span>",(r+="<div class='clear'></div>")+"</div>"}},{key:"renderPublicMessage",value:function(e,t){var n="<div class='public_message' data-id='"+e.id+"' data-user='"+e.user.id+"'>";return n+="<p class='public_message__avatar' data-id='"+e.user.id+"'>","?test"==location.search?n+="<img width='36' height='38' src='/images/floating_rose2.png' />":n+="<img width='36' height='38' src='"+Object(a.c)()+e.icon+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title'>",e.user?n+=o.a.render(e.user):n+=e.title,n+="</h5>",e.user&&(n+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",n+=i.a.render(e.content,t),n+="</h5>"),n+="</div>",n+="<span class='public_message__time fr time' data-time='"+e.id+"'>"+Object(a.q)(e.id)+"</span>",t.getState().mUser.canRemovePublicMessages&&(n+="<button data-id='"+e.id+"' class='btn btn-danger fa fa-times public_message__remove'></button>"),(n+="<div class='clear'></div>")+"</div>"}},{key:"renderAd",value:function(e,t){var n="<div class='public_message public_message_ad' data-id='"+e.id+"' data-user='"+e.user.id+"' style='background: "+t.getState().settings.self_message_bg_color+"' >";return n+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",n+="<img width='36' height='38' src='"+Object(a.c)()+e.user.avatar+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title'>",e.user?n+=o.a.render(e.user):n+=e.title,n+="</h5>",n+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",n+=i.a.render(e.content,t),n+="<span class='public_message__content_title' style='color: blue; margin-right: 0.4rem'>إعلان<span class='fa fa-comment'></span></span>",n+="</h5>",n+="</div>",n+="<span class='public_message__time fr time' data-time='"+e.id+"'>"+Object(a.q)(e.id)+"</span>",t.getState().mUser.canRemovePublicMessages&&(n+="<button data-id='"+e.id+"' class='btn btn-danger fa fa-times public_message__remove'></button>"),(n+="<div class='clear'></div>")+"</div>"}},{key:"renderSelfMessage",value:function(e,t){var n=Date.now(),r="<div class='public_message public_self_message public_message_ad' style='background: "+t.getState().settings.self_message_bg_color+"' >";return r+="<p class='public_message__avatar'>",r+="<img width='36' height='38' src='"+p.getSelfMessageIcon(t)+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>"+e.title+"</h5>",r+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",r+=i.a.render(e.content,t),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(a.q)(n)+"</span>",(r+="<div class='clear'></div>")+"</div>"}},{key:"renderBotBrbMessage",value:function(e,t){var n=Date.now(),r="<div class='public_message public_bot_brb_message' >";return r+="<p class='public_message__avatar'>",r+="<img width='36' height='38' src='"+p.getBotBrbAvatar(t)+"' />",r+="</p>",r+="<h5 class='public_message__bot_brb_title' style='color: "+t.getState().settings.self_message_title_color+"'>بوت مسابقات برب</h5>",r+="<div>",r+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>",e.user?r+=o.a.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",r+=i.a.render(e.content,t),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(a.q)(n)+"</span>",(r+="<div class='clear'></div>")+"</div>"}},{key:"getSelfMessageIcon",value:function(e){return e.getState().settings.self_messages_icon?Object(a.c)()+"/uploads/"+e.getState().settings.self_messages_icon:Object(a.c)()+"/images/default_room.png"}},{key:"getBotBrbAvatar",value:function(e){return e.getState().settings.self_messages_icon?Object(a.c)()+"/uploads/"+e.getState().settings.self_messages_icon:Object(a.c)()+"/images/bot_brb.png"}},{key:"render",value:function(e,t){switch(e.type){case"GREET_USER":return p.renderGreetUserMessage(e,t);case"JOIN_LEAVE":return p.renderJoinLeaveMessage(e,t);case"ROOM_GREETING":return p.renderRoomGreeting(e,t);case"PUBLIC_MESSAGE":return p.renderPublicMessage(e,t);case"AD":return p.renderAd(e,t);case"SELF_MESSAGE":return p.renderSelfMessage(e,t);case"BOT_BRB_MESSAGE":return p.renderBotBrbMessage(e,t);default:return null}}},{key:"insert",value:function(t,n){20<=window.publicMessagesContainer.find(".public_message").length&&window.publicMessagesContainer.find(".public_message:first-child").remove();var e=p.render(t,n),e=window.publicMessagesContainer.append(e);e.find(".public_message__avatar").unbind("click").on("click",function(e){r.a.show($(this).data("id"),n)}),e.find(".public_message__remove").unbind("click").on("click",function(e){e=e.target.dataset.id;"AD"==t.type?n.getState().socket.emit("req",Object(a.f)({type:"REMOVE_PUBLIC_MESSAGE",data:{id:e,is_ad:!0,message:t.content}}),function(e){}):n.getState().socket.emit("req",Object(a.f)({type:"REMOVE_PUBLIC_MESSAGE",data:{id:e}}),function(e){})}),c.a.scrollToBottom(),"JOIN_LEAVE"==t.type&&s.a.registerEvents(n),e.find("img").on("contextmenu",function(){return!1})}}],(n=null)&&u(l.prototype,n),u(l,d),p);function p(){!function(e){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}(this)}t.a=d},function(e,t,n){"use strict";var r=n(91),s=n.n(r),o=n(0);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,r=(a=c,r=[{key:"keys",value:function(e){var t,n=e.getState().faces,r=[];for(t in n)r.push(n[t].key);return r}},{key:"icons",value:function(e){var t,n=e.getState().faces,r=[];for(t in n)r.push(n[t].icon);return r}},{key:"findKeys",value:function(e,t){for(var n,r=[],t=c.keys(t).map(function(e){return"("+e+")"}).sort(function(e,t){return e.length>t.length?-1:1}).toString().replace(/,/g,"|"),o=new RegExp("("+t+")"),i=0;i<10;i++){var a=o.exec(e);a&&(n=s.a.generate(),r.push({id:n,key:a[0]}),e=e.replace(o,n))}return{data:e,detectedFaces:r}}},{key:"renderImage",value:function(e,t){e=c.keys(t).indexOf(e);if(0<=e){e=c.icons(t)[e];return"?test"==location.search?"<img src='/images/floating_heart1.png' height='18' alt='' />":"<img src='"+Object(o.c)()+"/uploads/faces/"+e+"?v=1' height='18' alt='' />"}}},{key:"render",value:function(e,t){if(!e)return"";if(!c.keys(t).length)return"<span>"+e+"</span>";var n=c.findKeys(e,t);if(!n.detectedFaces.length)return"<span>"+n.data+"</span>";var r,o=n.data,i="";for(r in n.detectedFaces){var a,s=n.detectedFaces[r];void 0===o||void 0!==(o=(a=o.split(s.id))[1])&&(a[0]?i+="<span><span>"+a[0]+"</span>"+c.renderImage(s.key,t)+"</span>":i+="<span>"+c.renderImage(s.key,t)+"</span>")}return"<span>"+i+"<span>"+(o=o||"")+"</span></span>"}}],(n=null)&&i(a.prototype,n),i(a,r),c);function c(){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this)}t.a=r},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return{type:"SET_CURRENT_PANE",currentPane:e}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"f",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r=function(){return{type:"SET_USERS",users:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},o=function(){return{type:"SET_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},i=function(){return{type:"UPDATE_CURRENT_USER",updates:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},a=function(){return{type:"SET_REQUESTED_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},s=function(){return{type:"UPDATE_REQUESTED_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},c=function(){return{type:"UPDATE_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},u=function(){return{type:"UPDATE_USER_ATTRIBUTE",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},l=function(){return{type:"REMOVE_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},d=function(){return{type:"ADD_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}}},function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"h",function(){return o}),n.d(t,"g",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"c",function(){return d});var r=function(e){return{type:"SET_CURRENT_CONVERSATION",user:e}},o=function(e){return{type:"UPDATE_CURRENT_CONVERSATION",user:e}},i=function(e,t,n){return{type:"UPDATE_CONVERSATION_ID",oldID:e,newID:t,him:n}},a=function(e){return{type:"REMOVE_CONVERSATION",id:e}},s=function(e){return{type:"READ_CONVERSATION",id:e}},c=function(e,t,n,r){return{type:"ADD_MESSAGE_TO_CONVERSATION",conversation_id:e,me:t,him:n,seen:r,message:4<arguments.length&&void 0!==arguments[4]?arguments[4]:{}}},u=function(){return{type:"UPDATE_PRIVATE_MESSAGE_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},l=function(e){return{type:"REMOVE_CONVERSATION_BY_USER",him_id:e}},d=function(e,t,n){return{type:"REC_READ_CONVERSATION_MESSAGE",conversation_id:e,me:t,him:n}}},function(e,t,n){"use strict";var r=n(67),f=n.n(r),p=n(10),o=n(3),h=n(0),m=n(1),i=n(2),a=n(6);function _(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e){if(e){if("string"==typeof e)return s(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return n(e),0}s.done?t(c):Promise.resolve(c).then(r,o)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u,r=(u=v,r=[{key:"registerEvents",value:function(e){v.onPlayerClicked(e),v.onDiceClicked(e),v.onClose(e),v.onHide(e)}},{key:"startGame",value:function(t,e,n){for(var r in window.ludoPlayers=[],window.isLudoWaitingForMove=!1,e){var o=e[r];o.user_id&&window.ludoPlayers.push(o)}t.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_START_GAME",data:{players:window.ludoPlayers,turn:window.ludoPlayers[0].color,isPublic:n}}),function(e){return"string"==typeof(e=Object(h.d)(e))?alert(e):(window.ludoCurrentTurn=window.ludoPlayers[0].color,$(".pre_youcam_ludo_modal__header__close").trigger("click"),void setTimeout(function(){$("#youcam_ludo_container").html(""),v.render(t,t.getState().mUser.id)},500))})}},{key:"onPlayerClicked",value:function(t){$(".player").unbind("click").on("click",function(e){window.isLudoWaitingForMove=!1,v.movePlayer($(this),window.currentDiceValue,t,window.mUserLudoColor)})}},{key:"parseGameState",value:function(){var t=[];return window.ludoPlayers.forEach(function(e){t.push({color:e.color,user_id:e.user_id,coin1:$("#"+e.color+"-player-1").data("cp"),coin2:$("#"+e.color+"-player-2").data("cp"),coin3:$("#"+e.color+"-player-3").data("cp"),coin4:$("#"+e.color+"-player-4").data("cp")})}),t}},{key:"onDiceClicked",value:function(o){$("#"+window.mUserLudoColor+"-dice").unbind("click").on("click",function(e){var t,r=this;window.ludoCurrentTurn!=window.mUserLudoColor||window.isLudoPlayerMoving||window.isDiceRolling||window.isLudoWaitingForMove||!window.ludoPlayers||window.ludoPlayers.filter(function(e){return!e.winner}).length<2||(window.currentDiceValue=1+Math.floor(6*Math.random()),window.numberOfNonSixTries||(window.numberOfNonSixTries=0),window.numberOfNonSixTries>=10+Math.floor(6*Math.random())&&(window.currentDiceValue=6),6!=window.currentDiceValue?++window.numberOfNonSixTries:window.numberOfNonSixTries=0,window.hackedDiceValue&&(window.currentDiceValue=window.hackedDiceValue),o.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_DICE_CLICKED",data:{value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){}),$(this).attr("disabled","disabled"),v.isLudoMinimized()||(v.stopAllSounds(),window.dice_sound.play()),t=setInterval(function(){var e=1+Math.floor(6*Math.random());$(r).css("background-image","url(/images/dice"+e+".png)")},50),window.isDiceRolling=!0,setTimeout(function(){$(r).css("background-image","url(/images/dice"+window.currentDiceValue+".png)"),$(r).removeAttr("disabled"),clearInterval(t),window.isDiceRolling=!1,window.isLudoWaitingForMove=!0;var n,e=v.autoMovePlayer(o);6!=window.currentDiceValue&&0==$(".bg-"+window.mUserLudoColor+"[data-status='active']").length?(v.updateTurn(window.currentDiceValue,o),o.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){})):6!=window.currentDiceValue&&0<$(".bg-"+window.mUserLudoColor+"[data-status='active']").length&&(n=!1,$(".bg-"+window.mUserLudoColor+"[data-status='active']").each(function(e,t){v.getRedPath().length-t.dataset.cp>=window.currentDiceValue&&(n=!0)}),n||e||(v.updateTurn(window.currentDiceValue,o),o.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){})))},2e3))})}},{key:"rollDice",value:function(e,t){v.isLudoMinimized()||(v.stopAllSounds(),window.dice_sound.play());var n=$("#"+e+"-dice"),r=setInterval(function(){var e=1+Math.floor(6*Math.random());n.css("background-image","url(/images/dice"+e+".png)")},50);setTimeout(function(){n.css("background-image","url(/images/dice"+t+".png)"),clearInterval(r)},2e3)}},{key:"autoMovePlayer",value:function(e){var t,n,r,o,i,a,s,c,u,l=!1;return 6==window.currentDiceValue?0==$(".player.bg-"+window.mUserLudoColor+"[data-status='active']").length?$(".player.bg-"+window.mUserLudoColor+"[data-status='home']").first().trigger("click"):(t=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']"),a=$(".player.bg-"+window.mUserLudoColor+"[data-status='home']"),t.length&&!a.length?(n=[],t.each(function(e,t){v.getRedPath().length-t.dataset.cp>=window.currentDiceValue&&n.push(t)}),1==n.length?(v.getRedPath().length==window.currentDiceValue+parseInt(n[0].dataset.cp)&&(l=!0),$("#"+n[0].id).trigger("click")):1<n.length?(r=n[0].dataset.cp,o=0,n.forEach(function(e){e.dataset.cp==r&&o++}),n.length==o&&(v.getRedPath().length==window.currentDiceValue+parseInt(n[0].dataset.cp)&&(l=!0),$("#"+n[0].id).trigger("click"))):n.length||(window.isLudoWaitingForMove=!1)):a.length&&(i=[],t.each(function(e,t){v.getRedPath().length-t.dataset.cp>=window.currentDiceValue&&i.push(t)}),i.length||a.first().trigger("click"))):(a=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']")).length&&(s=[],a.each(function(e,t){v.getRedPath().length-t.dataset.cp>=window.currentDiceValue&&s.push(t)}),1==s.length?(v.getRedPath().length==window.currentDiceValue+parseInt(s[0].dataset.cp)&&(l=!0),$("#"+s[0].id).trigger("click")):1<s.length&&(c=s[0].dataset.cp,u=0,s.forEach(function(e){e.dataset.cp==c&&u++}),s.length==u&&(v.getRedPath().length==window.currentDiceValue+parseInt(s[0].dataset.cp)&&(l=!0),$("#"+s[0].id).trigger("click")))),v.focusCurrentTurn(e),l}},{key:"getWinPlayers",value:function(e){return $(".player.bg-"+e+"[data-status='win'][data-cp='"+v.getRedPath().length+"']").length}},{key:"updateTurn",value:function(e,t){if(6!=e)return window.isLudoWaitingForMove=!1,"red"==window.ludoCurrentTurn?window.ludoPlayers.filter(function(e){return"green"==e.color})[0]&&v.getWinPlayers("green")<4?(window.ludoCurrentTurn="green",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"yellow"==e.color})[0]&&v.getWinPlayers("yellow")<4?(window.ludoCurrentTurn="yellow",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"blue"==e.color})[0]&&v.getWinPlayers("blue")<4?(window.ludoCurrentTurn="blue",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"red"==e.color})[0]&&v.getWinPlayers("red")<4?(window.ludoCurrentTurn="red",void v.focusCurrentTurn(t)):void 0:"green"==window.ludoCurrentTurn?window.ludoPlayers.filter(function(e){return"yellow"==e.color})[0]&&v.getWinPlayers("yellow")<4?(window.ludoCurrentTurn="yellow",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"blue"==e.color})[0]&&v.getWinPlayers("blue")<4?(window.ludoCurrentTurn="blue",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"red"==e.color})[0]&&v.getWinPlayers("red")<4?(window.ludoCurrentTurn="red",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"green"==e.color})[0]&&v.getWinPlayers("green")<4?(window.ludoCurrentTurn="green",void v.focusCurrentTurn(t)):void 0:"yellow"==window.ludoCurrentTurn?window.ludoPlayers.filter(function(e){return"blue"==e.color})[0]&&v.getWinPlayers("blue")<4?(window.ludoCurrentTurn="blue",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"red"==e.color})[0]&&v.getWinPlayers("red")<4?(window.ludoCurrentTurn="red",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"green"==e.color})[0]&&v.getWinPlayers("green")<4?(window.ludoCurrentTurn="green",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"yellow"==e.color})[0]&&v.getWinPlayers("yellow")<4?(window.ludoCurrentTurn="yellow",void v.focusCurrentTurn(t)):void 0:"blue"==window.ludoCurrentTurn?window.ludoPlayers.filter(function(e){return"red"==e.color})[0]&&v.getWinPlayers("red")<4?(window.ludoCurrentTurn="red",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"green"==e.color})[0]&&v.getWinPlayers("green")<4?(window.ludoCurrentTurn="green",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"yellow"==e.color})[0]&&v.getWinPlayers("yellow")<4?(window.ludoCurrentTurn="yellow",void v.focusCurrentTurn(t)):window.ludoPlayers.filter(function(e){return"blue"==e.color})[0]&&v.getWinPlayers("blue")<4?(window.ludoCurrentTurn="blue",void v.focusCurrentTurn(t)):void 0:void 0}},{key:"movePlayer",value:function(s,i,c,u){if(6<i&&(i=6),i<0&&(i=1),!window.isLudoPlayerMoving&&!window.isDiceRolling&&i&&window.ludoCurrentTurn==u&&s.hasClass("bg-"+u)&&!(6!=i&&"home"==s.data("status")||"win"==s.data("status")||v.getRedPath().length-s.data("cp")<i)){u==window.mUserLudoColor&&c.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_PLAYER_CLICKED",data:{value:i,players:window.ludoPlayers,color:window.mUserLudoColor,id:s.attr("id")}}),function(e){});var e,l=s.attr("data-cp"),t=i;6==i&&"home"==s.data("status")&&(s.attr("data-status","active"),e=$("."+u+"-home .white-box .player-room").html(),$("."+u+"-home .white-box .player-room").html(e.replace(s.get(0).outerHTML,"")),t=1);for(var d=[],a=0;a<t;a++)d.push(1);p=f.a.mark(function e(){var t,n,r,o,i,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.isLudoPlayerMoving=!0,t=_(d),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=32;break}if(n.value,"win"==v.getPath(u)[l])return v.isLudoMinimized()||window.winner_sound.play(),r=s.get(0).outerHTML,(n=window.ludoSteps[v.getPath(u)[l-1]]).innerHTML=n.innerHTML.replace(r,""),s.attr("data-status","win"),s.attr("data-cp",++l),r="red"==u?".rwh":"","green"==u&&(r=".gwh"),"yellow"==u&&(r=".ywh"),"blue"==u&&(r=".bwh"),$(".winner-home "+r).html($(".winner-home "+r).html()+s.get(0).outerHTML),3<v.getWinPlayers(u)&&((o=$("."+u+"-home")).addClass("home-win"),o.find(".white-box").css("background-image","url(/images/crown"+$(".home-win").length+".png)"),o.css("opacity","1"),window.ludoPlayers=window.ludoPlayers.map(function(e){return e.color==u&&(e.winner=!0),e}),u==window.mUserLudoColor&&(i=window.ludoPlayers.filter(function(e){return e.winner}).length<2,c.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_WIN_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor,gameEnded:i}}),function(e){}),i&&v.resetData(!1))),e.next=22,v.sleep(150);e.next=25;break;case 22:return e.abrupt("return",0);case 25:o=window.ludoSteps[v.getPath(u)[l]],0!=l?(a=s.get(0).outerHTML,(i=window.ludoSteps[v.getPath(u)[l-1]]).innerHTML=i.innerHTML.replace(a,""),l++,s.attr("data-cp",l),a=s.get(0).outerHTML,o.innerHTML=o.innerHTML+a):(l++,s.attr("data-cp",l),a=s.get(0).outerHTML,o.innerHTML=o.innerHTML+a),v.isLudoMinimized()||(v.stopAllSounds(),window.step_sound.play());case 28:return e.next=30,v.sleep(150);case 30:e.next=4;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(2),t.e(e.t0);case 37:return e.prev=37,t.f(),e.finish(37);case 40:case"end":return e.stop()}},e,null,[[2,34,37,40]])}),n=function(){var e=this,a=arguments;return new Promise(function(t,n){var r=p.apply(e,a);function o(e){g(r,t,n,o,i,"next",e)}function i(e){g(r,t,n,o,i,"throw",e)}o(void 0)})},function(){return n.apply(this,arguments)}().then(function(){if(l<v.getPath(u).length){var e=[],t=0,n=window.ludoSteps[v.getPath(u)[l-1]];if(1<n.children.length&&!v.getSafeStops().includes(v.getPath(u)[l-1])){for(a=0;a<n.children.length;a++){var r=n.children[a],o="red";r.classList.contains("bg-green")&&(o="green"),r.classList.contains("bg-yellow")&&(o="yellow"),r.classList.contains("bg-blue")&&(o="blue"),r&&r.classList.contains("player")&&o!=u&&(r.dataset.cp="0",r.dataset.status="home",$("."+o+"-home .white-box .player-room").append(r.outerHTML),e.push(r),v.isLudoMinimized()||window.dead_sound.play(),window.isLudoPlayerMoving=!1,window.currentDiceValue=0,v.onPlayerClicked(c))}if(e.forEach(function(e){e.remove(),t++}),0<t)return 0}}window.isLudoPlayerMoving=!1,window.currentDiceValue=0,u==window.mUserLudoColor&&c.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_UPDATE_GAME_STATE",data:{players:window.ludoPlayers,currentTurn:window.ludoCurrentTurn,color:window.mUserLudoColor,state:v.parseGameState()}}),function(e){}),v.onPlayerClicked(c),v.updateTurn(i,c)})}var p,n}},{key:"focusCurrentTurn",value:function(e){$(".step").css("z-index","0"),$(".super-center").removeClass("active"),$(".super-center."+window.ludoCurrentTurn+"-home").addClass("active"),v.getSafeStops().forEach(function(e){if(e){var t=window.ludoSteps[e];if(1<t.children.length){var n=_(t.children);try{for(n.s();!(r=n.n()).done;){var r=r.value;r.classList.contains("bg-"+window.ludoCurrentTurn)?r.style.zIndex="1":r.style.zIndex="0"}}catch(e){n.e(e)}finally{n.f()}}else 1==t.children.length&&(t.children[0].style.zIndex="1")}}),window.ludoCurrentTurn==window.mUserLudoColor&&$("#show_ludo").addClass("active"),e&&window.ludoCurrentTurn==window.mUserLudoColor&&e.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_SET_TURN",data:{currentTurn:window.ludoCurrentTurn}}),function(e){})}},{key:"getSafeStops",value:function(){return[19,6,5,27,52,65,66,44]}},{key:"sleep",value:function(t){return new Promise(function(e){return setTimeout(e,t)})}},{key:"stopAllSounds",value:function(){window.step_sound.pause(),window.step_sound.currentTime=0,window.dead_sound.pause(),window.dead_sound.currentTime=0,window.inout_sound.pause(),window.inout_sound.currentTime=0,window.dice_sound.pause(),window.dice_sound.currentTime=0}},{key:"getPath",value:function(e){return"red"==e?[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]:"green"==e?[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]:"yellow"==e?[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]:"blue"==e?[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]:void 0}},{key:"getRedPath",value:function(){return[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]}},{key:"getGreenPath",value:function(){return[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]}},{key:"getYellowPath",value:function(){return[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]}},{key:"getBluePath",value:function(){return[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]}},{key:"setSizes",value:function(){var e,t=$(".winner-home").prop("clientHeight"),n=Math.round(Object(h.m)(50,t)),r=Math.round(Object(h.m)(40,t)),o=Math.round(Object(h.m)(28,t));$(".winner-home .stack").css("border-width",n),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",r).css("height",r),$(".player-room").css("gap",o),document.body.clientWidth<750?($(".ludo-board").css("width","100vw").css("height","100vw"),e=Math.round(Object(h.m)(17,t)),$(".player").css("width",e).css("height",e)):($(".ludo-board").css("width","80vh").css("height","80vh"),e=Math.round(Object(h.m)(20,t)),$(".player").css("width",e).css("height",e)),900<document.body.clientWidth?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),t=$(".winner-home").prop("clientHeight"),n=Math.round(Object(h.m)(50,t)),$(".winner-home .stack").css("border-width",n)}},{key:"onClose",value:function(t){$("#ludo-board__close").unbind("click").on("click",function(e){$(this).closest(".ludo-board").data("u")==t.getState().mUser.id?v.endGame(t):v.exit(t)})}},{key:"onHide",value:function(t){$("#ludo-board__hide").unbind("click").on("click",function(e){$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),v.onShowLudo(t)})}},{key:"onShowLudo",value:function(t){$("#show_ludo").unbind("click").on("click",function(e){$("#show_ludo").remove(),$("#youcam_ludo_container main").show(),t.dispatch(Object(p.a)(null)),m.a.togglePane(t,!0)})}},{key:"exit",value:function(e){e.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_EXIT_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){}),v.resetData(!0)}},{key:"endGame",value:function(e){e.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_END_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){})}},{key:"userOut",value:function(e,t){window.ludoPlayers=window.ludoPlayers.filter(function(e){return e.color!=t}),window.ludoCurrentTurn==t&&v.updateTurn(void 0,e),$(".ludo_user."+t).remove(),window.ludoPlayers.filter(function(e){return!e.winner}).length<2&&(window.mUserLudoColor&&e.getState().socket.emit("req",Object(h.f)({type:"YOUCAM_LUDO_END_PUBLIC_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),function(e){}),v.resetData(!window.mUserLudoColor))}},{key:"gameEnded",value:function(e,t){var n=window.ludoPlayers.filter(function(e){return e.color==t})[0],r=e.getState().users.filter(function(e){return e.id==n.user_id})[0];r&&(r={id:Date.now(),user:r,data:r,type:"ludo_ended",title:"إنهاء اللعبة"},e.dispatch(Object(o.a)(r)),i.a.render(r,e)),v.resetData(!0)}},{key:"resetData",value:function(e){e&&$("#youcam_ludo_container").html(""),window.ludoCurrentTurn=void 0,window.mUserLudoColor=void 0,window.ludoPlayers=[],window.isLudoPlayerMoving=!1,window.isLudoWaitingForMove=!1,window.currentDiceValue=0}},{key:"renderUser",value:function(e){if(!e)return"";var t="<div class='ludo_user "+e.color+"' >";return t+="<img class='ludo_user--avatar' src='"+e.avatar+"' />",(t+=a.a.render(e))+"</div>"}},{key:"isLudoMinimized",value:function(){return!!$("#show_ludo").length}},{key:"setState",value:function(e,t){e.players.forEach(function(e){for(var t=1;t<=4;t++){var n,r,o,i=e["coin"+t];0<i&&(n=window.ludoSteps[v.getPath(e.color)[i-1]],(r=$("#"+e.color+"-player-"+t)).attr("data-cp",i),i==v.getRedPath().length?(r.attr("data-status","win"),o=r.get(0).outerHTML,i="","red"==e.color&&(i=".rwh"),"green"==e.color&&(i=".gwh"),"yellow"==e.color&&(i=".ywh"),"blue"==e.color&&(i=".bwh"),$(".winner-home "+i).html($(".winner-home "+i).html()+o)):(r.attr("data-status","active"),o=r.get(0).outerHTML,n.innerHTML=n.innerHTML+o),r.remove())}}),v.onPlayerClicked(t)}},{key:"render",value:function(t,e,n){var r,o,i,a,s,c,u,l,d;t.getState().mUser.room&&(e=e||"",d=t.getState().users.filter(function(e){return e.room&&e.room.id==t.getState().mUser.room.id}),a=i=o=r=null,(s=window.ludoPlayers.filter(function(e){return"red"==e.color})[0])&&((r=d.filter(function(e){return e.id==s.user_id})[0]).color="red"),(c=window.ludoPlayers.filter(function(e){return"green"==e.color})[0])&&((o=d.filter(function(e){return e.id==c.user_id})[0]).color="green"),(u=window.ludoPlayers.filter(function(e){return"yellow"==e.color})[0])&&((i=d.filter(function(e){return e.id==u.user_id})[0]).color="yellow"),(l=window.ludoPlayers.filter(function(e){return"blue"==e.color})[0])&&((a=d.filter(function(e){return e.id==l.user_id})[0]).color="blue"),d='<main class="container">',d+='<span id="ludo-board__top_buttons">',window.mUserLudoColor&&(d+="<button class='btn btn-danger fa fa-times' id='ludo-board__close'></button>"),d+="<button class='btn btn-warning fa fa-minus' id='ludo-board__hide'></button>",d+="</span>",d+='<div class="ludo-board" data-u="'+e+'">',d+='<div class="red-home red-home-bg bg-red super-center">',d+='<button id="red-dice" class="d0"></button>',d+='<div class="white-box super-center">',d+='<div class="player-room">',d+='<div data-status="home" data-cp="0" class="player bg-red movered1" id="red-player-1"></div>',d+='<div data-status="home" data-cp="0" class="player bg-red movered2" id="red-player-2"></div>',d+='<div data-status="home" data-cp="0" class="player bg-red movered3" id="red-player-3"></div>',d+='<div data-status="home" data-cp="0" class="player bg-red movered4" id="red-player-4"></div>',d+="</div>",d+="</div>",d+=v.renderUser(r),d+="</div>",d+='<div class="step"></div>',d+='<div class="step"><span class="fa fa-arrow-down green"><span></div>',d+='<div class="step"></div>',d+='<div class="green-home green-home-bg bg-green super-center">',d+='<button id="green-dice" class="d0"></button>',d+='<div class="white-box super-center">',d+='<div class="player-room">',d+='<div data-status="home" data-cp="0" class="player bg-green movegreen1" id="green-player-1"></div>',d+='<div data-status="home" data-cp="0" class="player bg-green movegreen2" id="green-player-2"></div>',d+='<div data-status="home" data-cp="0" class="player bg-green movegreen3" id="green-player-3"></div>',d+='<div data-status="home" data-cp="0" class="player bg-green movegreen4" id="green-player-4"></div>',d+="</div>",d+="</div>",d+=v.renderUser(o),d+="</div>",d+='<div class="step"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step red-stop"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-green"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-red">',d+="</div>",d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="winner-home">',d+='<div class="rwh stack"></div>',d+='<div class="gwh stack"></div>',d+='<div class="bwh stack"></div>',d+='<div class="ywh stack"></div>',d+="</div>",d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step green-stop"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"><span class="fa fa-arrow-right red"></span></div>',d+='<div class="step bg-red"></div>',d+='<div class="step bg-red"></div>',d+='<div class="step bg-red"></div>',d+='<div class="step bg-red"></div>',d+='<div class="step bg-red"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step"><span class="fa fa-arrow-left yellow"></span></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step blue-stop"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-yellow"></div>',d+='<div class="step"></div>',d+='<div class="blue-home bg-blue blue-home-bg super-center">',d+='<button id="blue-dice" class="d0"></button>',d+='<div class="white-box super-center">',d+='<div class="player-room">',d+='<div data-status="home" data-cp="0" class="player bg-blue moveblue1" id="blue-player-1"></div>',d+='<div data-status="home" data-cp="0" class="player bg-blue moveblue2" id="blue-player-2"></div>',d+='<div data-status="home" data-cp="0" class="player bg-blue moveblue3" id="blue-player-3"></div>',d+='<div data-status="home" data-cp="0" class="player bg-blue moveblue4" id="blue-player-4"></div>',d+="</div>",d+="</div>",d+=v.renderUser(a),d+="</div>",d+='<div class="step"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step"></div>',d+='<div class="yellow-home yellow-home-bg bg-yellow super-center">',d+='<button id="yellow-dice" class="d0"></button>',d+='<div class="white-box super-center">',d+='<div class="player-room">',d+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow1" id="yellow-player-1"></div>',d+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow2" id="yellow-player-2"></div>',d+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow3" id="yellow-player-3"></div>',d+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow4" id="yellow-player-4"></div>',d+="</div>",d+="</div>",d+=v.renderUser(i),d+="</div>",d+='<div class="step"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step yellow-stop"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step bg-blue"></div>',d+='<div class="step"></div>',d+='<div class="step"></div>',d+='<div class="step"><span class="fa fa-arrow-up blue"></span></div>',d+='<div class="step"></div>',d+="</div>",d+="</main>",$("#youcam_ludo_container").html(d),t.dispatch(Object(p.a)(null)),m.a.togglePane(t,!0),window.ludoSteps=document.getElementsByClassName("step"),window.step_sound=new Audio("/step.mp3"),window.dead_sound=new Audio("/dead.mp3"),window.inout_sound=new Audio("/inout.mp3"),window.dice_sound=new Audio("/dice3.mp3"),window.winner_sound=new Audio("/winner.mp3"),window.ludoPlayers&&window.ludoPlayers.length&&window.ludoPlayers.forEach(function(e){e&&$("#"+e.color+"-dice").show()}),n&&v.setState(n,t),v.setSizes(),v.focusCurrentTurn(t),v.registerEvents(t))}}],(n=null)&&c(u.prototype,n),c(u,r),v);function v(){!function(e){if(!(e instanceof v))throw new TypeError("Cannot call a class as a function")}(this)}t.a=r},function(e,t,n){"use strict";var r=n(10),o=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,s,s=(a=c,s=[{key:"registerEvents",value:function(e){c.onClose(e)}},{key:"onClose",value:function(t){$(".chat_pane__header button").on("click",function(e){t.dispatch(Object(r.a)(null)),o.a.togglePane(t,!0)})}},{key:"render",value:function(e,t){var n="<div class='chat_pane__header label label-primary '>";return n+="<h3 "+(t?"style='text-align: center;'":"")+" class='label label-primary chat_pane__header__title'>"+e+"</h3>",(n+="<button class='btn btn-danger fa fa-times chat_pane__header__close'></button>")+"</div>"}}],(n=null)&&i(a.prototype,n),i(a,s),c);function c(){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this)}t.a=s},function(e,t,n){"use strict";var c=n(0),r=n(14),o=n(18),i=n(1);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=(f=l,p=[{key:"registerEvents",value:function(e){l.createRoom(e)}},{key:"createRoom",value:function(s){$("#createRomModal form").on("submit",function(e){e.preventDefault();var t=e.target.name.value.trim(),n=e.target.description.value.trim(),r=e.target.welcome.value.trim(),o=e.target.required_likes.value,i=e.target.password.value.trim(),a=e.target.capacity.value,e=e.target.permanent.checked;return t.length?t.length<2?l.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):s.getState().rooms.filter(function(e){return e.name==t}).length?l.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):a<2||50<a?l.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void s.getState().socket.emit("req",Object(c.f)({type:"CREATE_ROOM",data:{room:{name:t,description:n,welcome:r,password:i,required_likes:o,capacity:a,isPermanent:e}}}),function(e){return"string"==typeof(e=Object(c.d)(e))?alert(e):void(e&&"object"==u(e)&&(!1===e.error?l.showSuccessMessage("تم إنشاء الغرفة بنجاح"):!0===e.error&&l.showErrorMessage(e.message)))}):l.showErrorMessage("الرجاء إعطاء إسم للغرفة")})}},{key:"showErrorMessage",value:function(e){$("#createRomModal .alert-success").hide(),$("#createRomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#createRomModal .alert-success").text(e).show(),$("#createRomModal .alert-danger").hide()}},{key:"render",value:function(e){$("#createRomModal form").unbind("submit"),$("#create_room_container").html("<div class='modal fade room_modal' id='createRomModal' tabindex='-1' role='dialog' aria-hidden='true'><div class='modal-dialog' role='document'><div class='modal-content'><div class='room_modal__header modal-header label label-primary'><div class='modal-title'><p class='room_modal__header__name ellipsis'>إنشاء غرفة جديدة</p><button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button></div></div><div class='room_modal__body modal-body'><p class='alert alert-danger' style='display: none'></p><p class='alert alert-success' style='display: none'></p><form id='room_modal__body__form'><div><div><input type='text' name='name' placeholder='عنوان الغرفة' /></div><div><input type='text' name='description' placeholder='الوصف' /></div><div><input type='text' name='welcome' placeholder='رسالة الترحيب' /></div><div><input type='text' name='password' placeholder='كلمة المرور' /></div><div><input type='number' name='required_likes' placeholder='لايكات الدخول' /></div><div><input type='number' name='capacity' value='50' placeholder='حجم الغرفة من 2 إلى 50' /></div><div><input type='checkbox' name='permanent' id='room_modal__body__checkbox' /><label for='room_modal__body__checkbox'>تثبيت الغرفة</label></div><button class='btn btn-success'><span class='fa fa-plus'></span>إنشاء الغرفة&nbsp;</button></div></form></div></div></div></div>"),l.registerEvents(e)}}],(n=null)&&a(f.prototype,n),a(f,p),l);function l(){!function(e){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p,f,f=(n=h,f=[{key:"registerEvents",value:function(e){h.showCreateRoomDialog(e),h.setRooms(e)}},{key:"showCreateRoomDialog",value:function(t){$("#chat__body__rooms_pane__create_room").on("click",function(e){s.render(t)})}},{key:"setCurrentRoomActive",value:function(e){$("#chat__body__rooms_pane .chat_pane__room_item").removeClass("active"),e.getState().mUser.room&&$("#chat__body__rooms_pane .chat_pane__room_item[data-id='"+e.getState().mUser.room.id+"']").addClass("active")}},{key:"setRooms",value:function(t){var n;i.a.updateRoomsCount(t),"rooms"==t.getState().currentPane&&($(".chat_pane__room_item").unbind("click"),(n=$("#chat__body__rooms_pane .chat_pane__container")).html(""),t.getState().rooms.forEach(function(e){n.append(o.a.render(e,!1,t))}),o.a.registerEvents(t))}},{key:"scrollToTop",value:function(){document.querySelector("#chat__body__rooms_pane .chat_pane__container").scrollTo({top:0})}},{key:"render",value:function(e){e="<div id='chat__body__rooms_pane' class='chat_pane' style='background: "+Object(c.n)(e.getState().settings,!0)+"'>";return e+=r.a.render("غرف الدردشة"),e+="<div><button id='chat__body__rooms_pane__create_room' data-toggle='modal' data-target='#createRomModal' class='border btn btn-success fa fa-plus'>غرفه جديدة</button></div>",(e+="<div class='chat_pane__container border'></div>")+"</div>"}}],(p=null)&&d(n.prototype,p),d(n,f),h);function h(){!function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this)}t.a=f},function(e,t,n){var r,a,o,i,s,c,u,l,d,p,f;function h(e,t,n){var r,o=this._iv;o?(r=o,this._iv=void 0):r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]}function m(e){return"string"==typeof e?p:l}e.exports=(f=n(5),n(36),void(f.lib.Cipher||(e=(r=(d=f).lib).Base,a=r.WordArray,o=r.BufferedBlockAlgorithm,(n=d.enc).Utf8,i=n.Base64,s=d.algo.EvpKDF,c=r.Cipher=o.extend({cfg:e.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(r){return{encrypt:function(e,t,n){return m(t).encrypt(r,e,t,n)},decrypt:function(e,t,n){return m(t).decrypt(r,e,t,n)}}}}),r.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=d.mode={},n=r.BlockCipherMode=e.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),n=f.CBC=((f=n.extend()).Encryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;h.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),f.Decryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),h.call(this,e,t,r),this._prevBlock=o}}),f),f=(d.pad={}).Pkcs7={pad:function(e,t){for(var t=4*t,n=t-e.sigBytes%t,r=n<<24|n<<16|n<<8|n,o=[],i=0;i<n;i+=4)o.push(r);t=a.create(o,n);e.concat(t)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:n,padding:f}),reset:function(){c.reset.call(this);var e,t=this.cfg,n=t.iv,t=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=t.createEncryptor:(e=t.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(t,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),u=r.CipherParams=e.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(d.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,e=e.salt,t=e?a.create([1398893684,1701076831]).concat(e).concat(t):t;return t.toString(i)},parse:function(e){var t,n=i.parse(e),e=n.words;return 1398893684==e[0]&&1701076831==e[1]&&(t=a.create(e.slice(2,4)),e.splice(0,4),n.sigBytes-=16),u.create({ciphertext:n,salt:t})}},l=r.SerializableCipher=e.extend({cfg:e.extend({format:f}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),t=o.finalize(t),o=o.cfg;return u.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),d=(d.kdf={}).OpenSSL={execute:function(e,t,n,r){r=r||a.random(8);e=s.create({keySize:t+n}).compute(e,r),n=a.create(e.words.slice(t),4*n);return e.sigBytes=4*t,u.create({key:e,iv:n,salt:r})}},p=r.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:d}),encrypt:function(e,t,n,r){n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=n.iv;r=l.encrypt.call(this,e,t,n.key,r);return r.mixIn(n),r},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=n.iv,l.decrypt.call(this,e,t,n.key,r)}}))))},function(e,t,n){"use strict";var r=n(6),s=n(0),o=n(22),c=n(12),i=n(10),a=n(1),u=n(37),l=n(55),d=n(33),p=n(2),f=n(41),h=n.n(f),m=n(92),_=n.n(m),g=n(29),v=n(43),y=n(44);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}f=S,m=[{key:"registerEvents",value:function(e){S.close(e),S.mute(e),S.onCall(e),S.expand(),S.compress(),S.onWriting(e),S.onSubmit(e),S.sendMedia(e),S.stopRecording(e),S.startRecording(e),S.openFacePicker(e),S.onChatBoxClicked(e),S.triggerSendMediaInput(e)}},{key:"peerOnCall",value:function(e){window.peer.on("call",function(t){console.log("mPeer.call"),window.incomingCall=t,window.incomingCall.on("close",function(){window.incomingCall=null}),navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){window.incomingStream=e,t.answer(e),t.on("stream",function(e){S.playStream(e)}),t.on("close",function(){if(window.incomingStream){try{window.incomingStream.stop(),console.log("window.incomingStream.stop()")}catch(e){window.incomingStream.getTracks().forEach(function(e){e.stop()}),console.log("window.incomingStream.getTracks()")}window.incomingStream=null,window.callsAudio.src=null}})}).catch(function(e){console.log("peerOnCall.mediaDevices.getUserMedia.error",e),alert("هذا المتصفح لا يدعم هذه الخاصية, الرجاء إستعمال كروم أو فايرفوكس")})})}},{key:"onCall",value:function(n){$("#chat_box__footer__call").unbind("click").on("click",function(e){return navigator.mediaDevices?$("#call_container").html()?$("#call-dialog").show():void n.getState().socket.emit("req",Object(s.f)({type:"CALL_REQUEST",data:{id:n.getState().currentConversation.id}}),function(e){var t;"rigning"==e.message?(S.makeCall(n),n.dispatch(Object(g.a)(!0)),t={user:e.user,dialogType:"call-sent",statusClass:"warning",status:"يتم الإتصال الآن..."},n.dispatch(Object(v.a)(t)),y.a.render(n,t)):"not ready"==e.message?n.dispatch(Object(g.a)(!0)):alert(e.message)}):alert("هذا المتصفح أو الجهاز لا يدعم هذه الخصاية")})}},{key:"makeCall",value:function(n){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){var t=window.peer.call(n.getState().currentConversation.id,e);window.outgoinCall=t,window.outgoinStream=e,t.on("stream",function(e){S.playStream(e)})}).catch(function(e){alert(e.stack),console.log("makeCall.mediaDevices.getUserMedia.error",e)})}},{key:"playStream",value:function(t){try{window.callsAudio.srcObject=t}catch(e){window.callsAudio.src=window.URL.createObjectURL(t)}window.callsAudio.onloadedmetadata=function(e){window.callsAudio.play()}}},{key:"updateUser",value:function(t,e){var n;e.getState().currentConversation&&t==e.getState().currentConversation.id&&(!(n=e.getState().users.filter(function(e){return e.id==t})[0])||(e=$("#chat_box"))&&(e.find(".chat_box__header__avatar").attr("src",n.avatar),e.find(".chat_box__header__name").html(r.a.render(n))))}},{key:"openFacePicker",value:function(t){$("#chat_box #chat_box__footer__smile").unbind("click").on("click",function(e){t.dispatch(Object(l.a)(!0)),o.a.registerEvents(t)})}},{key:"onSubmit",value:function(r){$("#chat_box form").unbind("submit").on("submit",function(e){e.preventDefault();var t=r.getState().currentConversation.id,n=e.target.message,e=n.value.trim();e&&(S.sendMessage({message:e,id:t,type:"text"},n,r),n&&(n.value=""))})}},{key:"sendMessage",value:function(e,t,i){var n=e.message,a=e.id,e=e.type;!t||"text"!=e&&"youtube"!=e||t.focus(),i=i||window.store,a=a||i.getState().currentConversation.id,i.getState().socket.emit("req",Object(s.f)({type:"NEW_PRIVATE_MESSAGE",data:{id:a,message:n,type:e}}),function(e){return"string"==typeof(e=Object(s.d)(e))?p.a.render({id:Date.now(),user:i.getState().users.filter(function(e){return e.id==a})[0],type:null,message:e,title:"تنبيه"},i):void("object"==b(e)&&(t=a,n=i.getState().mUser,r=i.getState().currentConversation,o=e,e=i.getState().currentConversation.id==t,i.dispatch(Object(c.a)(t,n,r,e,o)),S.insert(o,n,i)));var t,n,r,o})}},{key:"triggerSendMediaInput",value:function(){$("#chat_box__footer__share").unbind("click").on("click",function(e){var t;$(this).closest("form").hasClass("loading")||(t=document.getElementById("chat_box__footer_attach"))&&t.click()})}},{key:"sendMedia",value:function(o){$("#chat_box__footer_attach").unbind("change").on("change",function(e){var n=this,r=new FormData;r.append("file",e.target.files[0]),o.getState().socket.emit("req",Object(s.f)({type:"BEFORE_SEND_MEDIA",data:{id:o.getState().currentConversation.id}}),function(e){return"string"==typeof(e=Object(s.d)(e))?alert(e):void(!0===e&&($(n).closest("form").addClass("loading"),t=$("#chat_box__footer__loading_percent"),h.a.post("/send_private_media",r,{onUploadProgress:function(e){e=Math.round(100*e.loaded/e.total);t.text(e<10?"0"+e:e)}}).then(function(e){!1===e.data.error&&S.sendMessage({message:e.data.file,id:o.getState().currentConversation.id,type:e.data.type},void 0,o),$(n).closest("form").removeClass("loading"),t.text("00")}).catch(function(e){$(n).closest("form").removeClass("loading"),t.text("00")})));var t})})}},{key:"insert",value:function(e,t,n){$("#chat_box_container #chat_box__body").append(u.a.render(e,t,n)),S.scrollToBottom(),u.a.registerEvents(n)}},{key:"insertIsWriting",value:function(e,t){$("#chat_box__body__is_writing").remove(),$("#chat_box_container #chat_box__body").append("<img src='/images/is_writing.gif' id='chat_box__body__is_writing' height='90' />"),setTimeout(function(){$("#chat_box__body__is_writing").remove()},2e3),S.scrollToBottom()}},{key:"onChatBoxClicked",value:function(t){$("#chat_box").unbind("click").on("click",function(e){t.dispatch(Object(i.a)(null)),a.a.togglePane(t,!0)})}},{key:"close",value:function(t){$("#chat_box__header__close").unbind("click").on("click",function(e){$("#chat_box_container").html(""),t.dispatch(Object(c.f)(null))})}},{key:"expand",value:function(){$("#chat_box__header__expand").unbind("click").on("click",function(e){$("#chat_box").addClass("expanded")})}},{key:"compress",value:function(){$("#chat_box__header__compress").unbind("click").on("click",function(e){$("#chat_box").removeClass("expanded")})}},{key:"onWriting",value:function(t){$("#chat_box__footer__input").unbind("input").on("input",function(e){(!window.lastPrivateInputTime||1e3<=Date.now()-window.lastPrivateInputTime)&&(window.lastPrivateInputTime=Date.now(),S.sendIsWriting(t))})}},{key:"sendIsWriting",value:function(e){var t=e.getState().currentConversation;t&&e.getState().socket.emit("req",Object(s.f)({type:"IS_WRITING",data:{user:t.id}}),function(){})}},{key:"mute",value:function(t){$("#chat_box__header__mute, #chat_box__header__unmute").unbind("click").on("click",function(e){t.getState().socket.emit("req",Object(s.f)({type:"TOGGLE_PRIVATE_BIP",data:{}}),function(e){e=Object(s.d)(e),d.a.updateUserAttribute("isPrivateBipEnabled",e,t),t.getState().mUser.reg_id||Object(s.p)("isPrivateBipEnabled",Object(s.f)(e,!0)),e?$("#chat_box").removeClass("muted"):$("#chat_box").addClass("muted")})})}},{key:"playNotification",value:function(e){!e.getState().mUser.isPrivateBipEnabled||(e=document.getElementById("private-bip"))&&e.play()}},{key:"renderMessages",value:function(n){var t=n.getState().currentConversation,r=n.getState().conversations.filter(function(e){return e.id==t.id})[0],o="";return r&&r.messages.forEach(function(e){var t=r.me.id==e.by?r.me:r.him;o+=u.a.render(e,t,n)}),o}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chat_box__body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"startRecording",value:function(t){$("#chat_box__footer__start_recording").unbind("click").on("click",function(e){$("#chat_box__footer__start_recording").hide(),$("#chat_box__footer__stop_recording").show(),window.isRecordingSound||(window.isRecordingSound=!0,window.store=t,navigator.mediaDevices.getUserMedia({audio:!0}).then(S.onMediaStreamSuccess).catch(S.onMediaStreamError))})}},{key:"stopRecording",value:function(e){$("#chat_box__footer__stop_recording").unbind("click").on("click",function(e){$("#chat_box__footer__stop_recording").hide(),$("#chat_box__footer__start_recording").show(),window.isRecordingSound=!1,null!=window.mediaRecorder&&(window.mediaRecorder.stop(),null!=window.mediaRecorder.stream&&window.mediaRecorder.stream.stop())})}},{key:"uploadblob",value:function(e,t){var n;e&&((n=new FormData).append("file",e),n.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_upload_blob",type:"POST",data:n,cache:!1,processData:!1,contentType:!1,success:function(e){(e=JSON.parse(e))&&!e.error&&e.src?t(e.src):alert("حدث خطأ أثناء حفظ التسجيل")},error:function(e){alert("حدث خطأ أثناء حفظ التسجيل")}}))}},{key:"onMediaStreamSuccess",value:function(e){try{window.mediaRecorder=new _.a(e);var n=null;window.mediaRecorder.bufferSize=8192,window.mediaRecorder.stream=e,window.mediaRecorder.mimeType="audio/webm",window.mediaRecorder.dur=Date.now(),window.mediaRecorder.ondataavailable=function(e){var t;(Date.now()-window.mediaRecorder.dur)/1e3<1||((t=$('<div class="audio-recorder"><audio type="audio/webm" controls></audio><button class="btn btn-success">إرسال</button>&nbsp;<button class="btn btn-danger">إلغاء</button></div>')).find("audio").attr("src",window.URL.createObjectURL(e)),S.uploadblob(e,function(e){t.find("audio").attr("src","/uploads/private/"+e),n=e}),t.find(".btn-success").click(function(){n&&S.sendMessage({message:n,id:null,type:"sound"}),t.remove()}),t.find(".btn-danger").click(function(){t.remove(),S.removeBlob(n)}),$("#chat_box__body").append(t))},window.mediaRecorder.start(3e4)}catch(e){console.log("onMediaStreamSuccess.error",e)}}},{key:"onMediaStreamError",value:function(e){window.isRecordingSound=!1,window.store=void 0,alert("هذا المتصفح لا يدعم ميزة التسجيل, الرجاء إستخدام جوجل كروم")}},{key:"removeBlob",value:function(e){window.store=void 0;var t=new FormData;t.append("file",e),t.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_remove_blob",type:"POST",data:t,cache:!1,processData:!1,contentType:!1,success:function(e){},error:function(e){}})}},{key:"render",value:function(e){var t=e.getState().currentConversation;if(!t)return $("#chat_box_container").html("");var n="<div id='chat_box' class='"+(e.getState().mUser.isPrivateBipEnabled?"":"muted")+"'>";n+="<header class='chat_box__header label-primary'>",n+="<img class='chat_box__header__avatar' width='25' height='25' src='"+t.avatar+"' alt='' />",n+="<p class='chat_box__header__name ellipsis'>"+r.a.render(t)+"</p>",n+="<button id='chat_box__header__close' class='btn btn-danger fa fa-minus pull-right'></button>",n+="<button id='chat_box__header__expand' class='btn btn-info fa fa-expand pull-right'></button>",n+="<button id='chat_box__header__compress'class='btn btn-info fa fa-compress pull-right'></button>",n+="<button id='chat_box__header__mute' class='btn btn-success fa fa-bell-o pull-right'></button>",n+="<button id='chat_box__header__unmute' class='btn btn-success fa fa-bell-slash-o pull-right'></button>",n+="</header><div class='clear'></div>",n+="<div class='chat_box__body' id='chat_box__body' style='background: "+Object(s.n)(e.getState().settings)+"'>",n+=S.renderMessages(e),n+="</div>",n+="<footer class='chat_box__footer'>",n+=o.a.render("private_messages","#chat_box__footer__input",e),n+="<form>",n+="<button id='chat_box__footer__start_recording' type='button' class='btn btn-primary fa fa-microphone'></button>",n+="<button id='chat_box__footer__stop_recording' type='button' class='btn btn-primary fa fa-stop'></button>",n+="<button type='button' id='chat_box__footer__call' class='btn btn-primary fa fa-phone'></button>",n+="<span style='position: relative'><span id='chat_box__footer__loading_percent'>00</span><img id='chat_box__footer__loader' src='/images/loader.gif' width='30' height='30' alt=''/></span>",n+="<button id='chat_box__footer__share' type='button' class='btn btn-primary fa fa-share-alt'></button>",n+="<img style='cursor: pointer' src='/images/smile.gif' alt='فيس' id='chat_box__footer__smile' class='chat_box__footer__smile' width='22' height='22' />",n+="<input class='chat_box__footer__input' id='chat_box__footer__input' dir='rtl' name='message' type='text' placeholder='أكتب رسالتك هنا...' autoComplete='off' />",n+="<button id='chat_box__footer__submit' class='btn btn-primary fa fa-send'></button>",n+="<input id='chat_box__footer_attach' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",n+="</form>",n+="</footer>",n+="</div>",$("#chat_box_container").html(n),e.dispatch(Object(c.b)(t.id)),S.registerEvents(e),S.scrollToBottom(),a.a.updateConversationsCount(e),u.a.registerEvents(e)}}],(n=null)&&w(f.prototype,n),w(f,m),m=S;function S(){!function(e){if(!(e instanceof S))throw new TypeError("Cannot call a class as a function")}(this)}t.a=m},function(e,t,n){"use strict";var i=n(0),a=n(9),o=n(15),s=n(31),c=n(4),u=n(13);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d,p,p=(d=f,p=[{key:"registerEvents",value:function(e){f.joinRoom(e)}},{key:"joinRoom",value:function(r){$(".chat_pane__room_item, .chat_pane__room_item--inline").unbind("click").on("click",function(e){if("object"==l(window.ludoPlayers)&&window.ludoPlayers.filter(function(e){return e.user_id==r.getState().mUser.id})[0])return alert("لايمكنك القيام بهذه العملية حتى تخرج من اللودو");var t=$(this).data("id"),n=null;r.getState().mUser.room&&r.getState().mUser.room.id==t||$(this).data("password")&&!r.getState().mUser.canOpenLockedRooms&&!(n=prompt("الرجاء إدخال كلمة المرور"))||(n={type:"JOIN_ROOM",data:{id:t,password:n}},r.getState().socket.emit("req",Object(i.f)(n),function(e){!1===(e=Object(i.d)(e)).error?(o.a.setRooms(r),o.a.setCurrentRoomActive(r),f.registerEvents(r),s.a.toggleInput(r),c.a.resetAllMics(),r.getState().mUser.room&&r.getState().mUser.room.micUsers.forEach(function(t){c.a.setUserOnMic(r,r.getState().users.filter(function(e){return e.id==t.user_id})[0],t.micId)}),c.a.toggle(r,r.getState().mUser.room.is_voice_room),$("body").attr("id","room-"+r.getState().mUser.room.id),r.getState().mUser.room.ludoGameState.players?(window.ludoPlayers=r.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=r.getState().mUser.room.ludoGameState.currentTurn,u.a.render(r,null,r.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),u.a.onShowLudo(r)):u.a.resetData(!0)):e.message&&alert(e.message)}))})}},{key:"renderRoom",value:function(e,t){var n=t.getState().mUser.room&&t.getState().mUser.room.id==e.id?"active":"",r=e.password?"locked":"",o=e.is_voice_room?"has-mic":"",o="<div data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item "+n+" "+r+" "+o+"' >";return"?test"==location.search?o+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='/images/floating_rose3.png' /></p>":o+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='"+Object(i.c)()+e.flag+"' /></p>",o+="<div>",o+="<h5 class='chat_pane__room_item__name'>",o+=e.name,o+="<img class='chat_pane__room_item--lock' alt='' src='"+Object(i.c)()+"/images/lock.png' />",o+="<img class='chat_pane__room_item--mic' width='20' alt='' src='"+Object(i.c)()+"/images/mic.png' />",o+="</h5>",o+="<h5 class='chat_pane__room_item__description'>",o+=a.a.render(e.description,t),o+="</h5>",o+="</div>",o+="<span class='chat_pane__room_item__users corner fa fa-user label label-primary fr'>"+e.users.length+"/"+e.capacity+"</span>",(o+="<div class='clear'></div>")+"</div>"}},{key:"renderInlineRoom",value:function(e,t){var n="<span data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item--inline label label-primary'>";return n+=e.name,(n+=t?"<img src='"+Object(i.c)()+e.flag+"' width='20' alt=''/>":"<span class='fa fa-sign-in'></span>")+"</span>"}},{key:"render",value:function(e,t,n,r){return e?t&&e?f.renderInlineRoom(e,r):f.renderRoom(e,n):""}}],(n=null)&&r(d.prototype,n),r(d,p),f);function f(){!function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this)}t.a=p},function(e,t,n){"use strict";var a=n(0),r=n(14),o=n(22),i=n(21),s=n(1),c=n(26),u=n(57),l=n(41),d=n.n(l);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f,n=(f=h,n=[{key:"registerEvents",value:function(e){h.publish(e),h.fetchPosts(e),h.attachFile(e),h.openFacePicker(e),h.triggerAttachFileInput(e)}},{key:"publish",value:function(n){$("#chat__body__wall_pane .chat__body__wall_pane__form").on("submit",function(e){e.preventDefault();var t=e.target.message,e=t.value.trim();e&&h.send({type:"text",body:e},t,n)})}},{key:"send",value:function(e,t,n){t&&(t.value=""),n.getState().socket.emit("req",Object(a.f)({type:"WALL_ADD_POST",data:e}),function(e){if("string"==typeof(e=Object(a.d)(e)))return alert(e)})}},{key:"fetchPosts",value:function(t){t.dispatch(Object(i.f)()),s.a.updateWallCout(t),t.getState().isPostsFetched||t.getState().socket.emit("req",Object(a.f)({type:"WALL_GET_POSTS",data:{}}),function(e){t.dispatch(Object(i.h)(Object(a.d)(e))),t.dispatch(Object(i.g)(!0)),h.renderPosts(t)})}},{key:"renderPosts",value:function(t){var n=$("#chat__body__wall_pane .chat_pane__container__posts");n.html(""),t.getState().posts.forEach(function(e){n.append(c.a.render(e,t))}),c.a.registerEvents(t)}},{key:"openFacePicker",value:function(t){$("#chat__body__wall_pane__form__attach__face").on("click",function(e){t.dispatch(Object(u.a)(!0))})}},{key:"updatePost",value:function(t,e){var n=e.getState().posts.filter(function(e){return e.id==t})[0];n&&((e=window.wallPane.find("#wall-post-"+n.id)).find(".wall_post__body__heart").text(n.likes),e.find(".wall_post__body__comments").text(n.comments))}},{key:"removePost",value:function(e){$("#wall-post-"+e).remove()}},{key:"addPost",value:function(e,t){e&&(window.wallPane.find(".chat_pane__container__posts").prepend(c.a.render(e,t)),c.a.registerEvents(t),window.wallPane.find(".wall_post").length>t.getState().settings.wall_msg_count&&window.wallPane.find(".wall_post:nth-child("+(t.getState().settings.wall_msg_count+1)+")").remove())}},{key:"setPosts",value:function(t){var n;s.a.updateWallCout(t),"wall"!=t.getState().currentPane||window.wallPane.find(".chat_pane__container__posts").length||($(".wall_post").unbind("click"),(n=window.wallPane.find(".chat_pane__container__posts")).html(""),t.getState().posts.forEach(function(e){n.append(c.a.render(e,t))}),c.a.registerEvents(t),document.querySelector("#chat__body__wall_pane .chat_pane__container").scrollTo({top:0}),window.wallPane.find("img").on("contextmenu",function(){return!1}))}},{key:"triggerAttachFileInput",value:function(){window.wallPane.find(".chat__body__wall_pane__form__attach").unbind("click").on("click",function(e){var t=document.getElementById("chat__body__wall_pane__form__file");t&&t.click()})}},{key:"attachFile",value:function(i){window.wallPane.find("#chat__body__wall_pane__form__file").unbind("change").on("change",function(e){var r=e.target.files[0],o=new FormData;o.append("file",r),i.getState().socket.emit("req",Object(a.f)({type:"WALL_BEFORE_SEND_MEDIA",data:{}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void(!1===e.error&&(o.append("hash",e.hash),o.append("id",e.user_id),t=null,"image"==(e=r.type.split("/")[0])&&(t="/wall_upload_photo_post"),"audio"==e&&(t="/wall_upload_sound_post"),"video"==e&&(t="/wall_upload_video_post"),t&&(window.wallPane.find(".chat__body__wall_pane__form__attach").hide(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").show(),n=$(".chat__body__wall_pane__form__loading_percent"),d.a.post(t,o,{onUploadProgress:function(e){e=Math.round(100*e.loaded/e.total);n.text(e<10?"0"+e:e)}}).then(function(e){!1===e.data.error&&h.send({type:e.data.type,body:e.data.body},null,i),window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),n.text("00")}).catch(function(e){window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),n.text("00")}))));var t,n})})}},{key:"update",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"";window.wallPane.find(".chat_pane__container__banner").css("background",e.getState().settings.wall_banner_background_color),window.wallPane.find(".chat_pane__container__banner").css("color",e.getState().settings.wall_banner_font_color),window.wallPane.find(".chat_pane__container__banner p").text(t),e.getState().settings.show_wall_banner?window.wallPane.find(".chat_pane__container__banner").show():window.wallPane.find(".chat_pane__container__banner").hide()}},{key:"render",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"",n="<div id='chat__body__wall_pane' class='chat_pane' style='background: "+Object(a.n)(e.getState().settings,!0)+"'>";return n+=r.a.render("الحائط للإبداع فقط",!0),n+="<div class='chat_pane__container border'>",n+="<div class='chat_pane__container__banner' style='background: "+e.getState().settings.wall_banner_background_color+"; color: "+e.getState().settings.wall_banner_font_color+"'>",n+="<p>"+t+"</p>",n+="</div>",n+="<div class='chat_pane__container__posts'></div>",n+="</div>",n+="<form class='chat__body__wall_pane__form'>",n+="<button type='button' class='border-color btn btn-primary fa fa-share-alt chat__body__wall_pane__form__attach'></button>",n+="<span><span class='chat__body__wall_pane__form__loading_percent'>00</span><img class='chat__body__wall_pane__form__loader' style='display: none' src='/images/loader.gif' width='24' height='24' alt='' /></span>",n+="<img class='chat__body__wall_pane__form__face' src='/images/smile.gif' alt='smile' id='chat__body__wall_pane__form__attach__face' width='22' height='22' />",n+="<input type='text' id='chat__body__wall_pane__form__input' class='border-color chat__body__wall_pane__form__input' name='message' placeholder='أكتب رسالتك هنا' autoComplete='off' dir='rtl'/>",n+="<button class='border-color fa fa-send btn btn-primary chat__body__wall_pane__form__send'>إرسال</button>",n+="<input id='chat__body__wall_pane__form__file' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",n+=o.a.render("wall","#chat__body__wall_pane__form__input",e),(n+="</form>")+"</div>"}}],(l=null)&&p(f.prototype,l),p(f,n),h);function h(){!function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this)}t.a=n},function(e,t,n){"use strict";var r=n(6),o=n(9),i=n(18),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=(J=f,Me=[{key:"registerEvents",value:function(e){f.clearGift(e),f.onSelect(e),f.close(e)}},{key:"clearGift",value:function(n){$(".gifts_picker__contianer__clear").unbind("click").on("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_REMOVE_GIFT",data:{userID:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"onSelect",value:function(o){$(".gifts_picker__contianer__img").unbind("click").on("click",function(e){var t=o.getState().requestedUser,n=$(this).data("id"),r=t.id;t.icon!=$(this).attr("src")&&o.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_GIFT",data:{userID:r,giftID:n}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"close",value:function(e){$(".gifts_picker__contianer__close").unbind("click").on("click",function(e){$("#user_profile .gifts_picker").hide(),$("#user_profile .user_profile__body__avatar").show()})}},{key:"render",value:function(e){var t="<div class='gifts_picker' style='display: none'>";return t+="<div class='gifts_picker__contianer'>",e.getState().gifts.forEach(function(e){t+="<img data-id='"+e.id+"' src='"+e.icon+"' class='gifts_picker__contianer__img' />"}),t+="</div>",t+="<button class='gifts_picker__contianer__clear btn btn-primary fa fa-times fl'>سحب الهدية</button>",t+="<button class='gifts_picker__contianer__close btn btn-danger fa fa-times fr'>إخفاء الهدايا</button>",t+="<div class='clear'></div>",t+="</div>"}}],(xe=null)&&s(J.prototype,xe),s(J,Me),f),u=n(12),l=n(17),d=n(10),p=n(1);function f(){!function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=(xe=_,J=[{key:"registerEvents",value:function(e){_.onAction(e)}},{key:"onAction",value:function(t){$("#user_profile__footer__actions__item--private").unbind("click").click("click",function(e){t.dispatch(Object(u.f)(t.getState().requestedUser)),t.dispatch(t.dispatch(Object(d.a)(null))),p.a.togglePane(t,!0),$("#user_profile").modal("hide"),l.a.render(t)})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--private' class='btn btn-default fa fa-comment'>محادثه خاصه</button></span>"}}],(Me=null)&&h(xe.prototype,Me),h(xe,J),_);function _(){!function(e){if(!(e instanceof _))throw new TypeError("Cannot call a class as a function")}(this)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=(Me=y,xe=[{key:"registerEvents",value:function(e){y.onAction(e)}},{key:"onAction",value:function(r){$("#user_profile__footer__actions__item--notify").unbind("click").click("click",function(e){var t=r.getState().requestedUser.id,n=prompt("الرجاء إدخال الرسالة التنبيهية");(n=n?n.trim():null)&&(n=n.substring(0,100),r.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_NOTIFY",data:{id:t,message:n}}),function(e){alert(Object(a.d)(e))}))})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--notify' class='btn btn-default fa fa-envelope-o'>تنبيه</button></span>"}}],(J=null)&&g(Me.prototype,J),g(Me,xe),y);function y(){!function(e){if(!(e instanceof y))throw new TypeError("Cannot call a class as a function")}(this)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=(J=S,Me=[{key:"registerEvents",value:function(e){S.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--like").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_LIKE",data:{id:t}}),function(e){!0===(e=Object(a.d)(e))&&($("#user_profile__footer__actions__item--like").parent().addClass("active"),$("#user_profile__footer__actions__item--like").find("span").text(n.getState().requestedUser.likes+1))})})}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.liked?"active":"")+"'>";return(t+="<button id='user_profile__footer__actions__item--like' class='btn btn-default fa fa-heart red'><span>"+e.getState().requestedUser.likes+"</span></button>")+"</span>"}}],(xe=null)&&b(J.prototype,xe),b(J,Me),S);function S(){!function(e){if(!(e instanceof S))throw new TypeError("Cannot call a class as a function")}(this)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=(xe=E,J=[{key:"registerEvents",value:function(e){E.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--album").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_GET_ALBUM",data:{id:t}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void n.dispatch(function(e){return{type:"SET_ALBUM",album:0<arguments.length&&void 0!==e?e:null}}(e))})})}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return(t+="<button id='user_profile__footer__actions__item--album' class='btn btn-default fa fa-image purple'><span dir='rtl'> ("+e.getState().requestedUser.albumLength+") </span><span>الألبوم</span></button>")+"</span>"}}],(Me=null)&&k(xe.prototype,Me),k(xe,J),E);function E(){!function(e){if(!(e instanceof E))throw new TypeError("Cannot call a class as a function")}(this)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(){return{type:"TOGGLE_REVEAL_NAMES",isRevealNamesOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}var P=(Me=A,xe=[{key:"registerEvents",value:function(){A.onAction()}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--gift").unbind("click").click("click",function(e){$("#user_profile .gifts_picker").show(),$("#user_profile .user_profile__body__avatar").hide()})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--gift' class='btn btn-default fa fa-diamond blue'>إرسال هدية</button></span>"}}],(J=null)&&T(Me.prototype,J),T(Me,xe),A);function A(){!function(e){if(!(e instanceof A))throw new TypeError("Cannot call a class as a function")}(this)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=(J=M,Me=[{key:"registerEvents",value:function(e){M.back(e)}},{key:"back",value:function(t){$("#reveal_names__header__back").unbind("click").on("click",function(e){t.dispatch(O(!1)),M.close()})}},{key:"renderName",value:function(e){if(!e)return"";var t="<div class='reveal_names__item'>";return t+="<p><span class='reveal_names__item__key'>العضو</span><span className='reveal_names__item__value'>"+e.username+"</span></p>",t+="<p><span class='reveal_names__item__key'>الزخرفة</span><span className='reveal_names__item__value'>"+e.decoration+"</span></p>",t+="<p><span class='reveal_names__item__key'>الدولة</span><span className='reveal_names__item__value'><img src='images/flags/"+e.country+".png' /></span></p>",t+="<p><span class='reveal_names__item__key'>الأيبي</span><span className='reveal_names__item__value'>"+e.ip+"</span></p>",(t+="<p><span class='reveal_names__item__key'>الجهاز</span><span className='reveal_names__item__value'>"+e.device+"</span></p>")+"</div>"}},{key:"renderNames",value:function(e){var t=$("#user_profile .reveal_names_body");t.html(""),e.getState().revealNames.forEach(function(e){t.append(M.renderName(e))})}},{key:"open",value:function(e){$("#reveal_names__container").show(),$("#user_profile__body__user_details").hide(),$("#user_profile .user_profile__footer").hide(),M.renderNames(e),M.back(e)}},{key:"close",value:function(){$("#reveal_names__container").hide(),$("#user_profile__body__user_details").show(),$("#user_profile .user_profile__footer").show()}},{key:"render",value:function(e){var t="<div id='reveal_names__container' class='reveal_names' style='display: none;'>";return t+="<p class='reveal_names__header'>",t+="<button id='reveal_names__header__back' class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="<span class='fr'>كشف النكات</span>",t+="</p>",(t+="<div class='reveal_names_body'>"+M.renderNames(e)+"</div>")+"</div>"}}],(xe=null)&&R(J.prototype,xe),R(J,Me),M);function M(){!function(e){if(!(e instanceof M))throw new TypeError("Cannot call a class as a function")}(this)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=(xe=U,J=[{key:"registerEvents",value:function(e){U.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--reveal-names").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_REVEAL_NAMES",data:{id:t}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void(Array.isArray(e)&&(n.dispatch(function(e){return{type:"SET_REVEAL_NAMES",names:0<arguments.length&&void 0!==e?e:{}}}(e)),n.dispatch(O(!0)),x.open(n)))})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--reveal-names' class='btn btn-default fa fa-search'>كشف النكات</button></span>"}}],(Me=null)&&j(xe.prototype,Me),j(xe,J),U),I=n(11);function U(){!function(e){if(!(e instanceof U))throw new TypeError("Cannot call a class as a function")}(this)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=(Me=F,xe=[{key:"registerEvents",value:function(e){F.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--remove-avatar").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_REMOVE_AVATAR",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))?alert(e):(n.dispatch(Object(I.g)(e)),je.clearAvatar(n))})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--remove-avatar' class='btn btn-default fa fa-ban maroon'>حذف الصورة</button></span>"}}],(J=null)&&L(Me.prototype,J),L(Me,xe),F);function F(){!function(e){if(!(e instanceof F))throw new TypeError("Cannot call a class as a function")}(this)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=(J=G,Me=[{key:"registerEvents",value:function(e){G.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--room-excpel").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_ROOM_EXCPEL",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--room-excpel' class='btn btn-default fa fa-sign-out magenta'>طرد من الغرفة</button></span>"}}],(xe=null)&&N(J.prototype,xe),N(J,Me),G);function G(){!function(e){if(!(e instanceof G))throw new TypeError("Cannot call a class as a function")}(this)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=(xe=H,J=[{key:"registerEvents",value:function(e){H.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--excpel").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_EXCPEL",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--excpel' class='btn btn-default fa fa-ban'>طرد</button></span>"}}],(Me=null)&&W(xe.prototype,Me),W(xe,J),H);function H(){!function(e){if(!(e instanceof H))throw new TypeError("Cannot call a class as a function")}(this)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J,Y=(Me=K,xe=[{key:"registerEvents",value:function(e){K.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--ban").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_BAN",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--ban' class='btn btn-default fa fa-ban'>باند</button></span>"}}],(J=null)&&z(Me.prototype,J),z(Me,xe),K),X=(n(25),n(28));function K(){!function(e){if(!(e instanceof K))throw new TypeError("Cannot call a class as a function")}(this)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=(Me=ee,xe=[{key:"registerEvents",value:function(e){ee.ignore(e),ee.unignore(e)}},{key:"ignore",value:function(n){$("#user_profile__footer__actions__item--ignore").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().ignoredUsers.includes(t)||(n.dispatch({type:"IGNORE_USER",id:t}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").addClass("ignored"),p.a.updateUsersCout(n),X.a.setUsers(n))})}},{key:"unignore",value:function(n){$("#user_profile__footer__actions__item--unignore").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().ignoredUsers.includes(t)&&(n.dispatch({type:"UNIGNORE_USER",id:t}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").removeClass("ignored"),p.a.updateUsersCout(n),X.a.setUsers(n))})}},{key:"render",value:function(e){var t=e.getState().requestedUser.id,t="<span class='user_profile__footer__actions__item "+(e.getState().ignoredUsers.includes(t)?"ignored":"")+"'>";return t+="<button id='user_profile__footer__actions__item--ignore' class='btn btn-default fa fa-ban red'>تجاهل</button>",(t+="<button id='user_profile__footer__actions__item--unignore' class='btn btn-default fa fa-ban red'>إلغاء التجاهل</button>")+"</span>"}}],(n=null)&&Q(Me.prototype,n),Q(Me,xe),ee);function ee(){!function(e){if(!(e instanceof ee))throw new TypeError("Cannot call a class as a function")}(this)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne=(n=re,Me=[{key:"registerEvents",value:function(e){re.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--reg-user-events").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_REG_USER_EVENTS",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e),!0===e&&(n.getState().requestedUser.regEvents?$("#user_profile__footer__actions__item--reg-user-events").text("إيقاف المراقبة"):$("#user_profile__footer__actions__item--reg-user-events").text("مراقبة العضو"))})})}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return e.getState().requestedUser.regEvents?t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'>إيقاف المراقبة</button>":t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'>مراقبة العضو</button>",t+"</span>"}}],(xe=null)&&te(n.prototype,xe),te(n,Me),re);function re(){!function(e){if(!(e instanceof re))throw new TypeError("Cannot call a class as a function")}(this)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ie=(xe=ae,n=[{key:"registerEvents",value:function(e){ae.onAction(e)}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--chat-app").unbind("click").click("click",function(e){window.open("/app.apk")})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--chat-app' class='btn btn-default fa fa-android green'>تطبيق الشات</button></span>"}}],(Me=null)&&oe(xe.prototype,Me),oe(xe,n),ae);function ae(){!function(e){if(!(e instanceof ae))throw new TypeError("Cannot call a class as a function")}(this)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ce=(Me=ue,xe=[{key:"registerEvents",value:function(e){ue.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item--cancel-radio").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CANCEL_RADIO",data:{id:t}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--cancel-radio' class='btn btn-default fa fa-ban'>سحب المايك</button></span>"}}],(n=null)&&se(Me.prototype,n),se(Me,xe),ue);function ue(){!function(e){if(!(e instanceof ue))throw new TypeError("Cannot call a class as a function")}(this)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var de=(n=pe,Me=[{key:"registerEvents",value:function(e){pe.mute(e),pe.unmute(e)}},{key:"mute",value:function(n){$("#user_profile__footer__actions__item--mute").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_MUTE",data:{id:t}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void $("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").addClass("muted")})})}},{key:"unmute",value:function(n){$("#user_profile__footer__actions__item--unmute").unbind("click").click("click",function(e){var t=n.getState().requestedUser.id;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_UNMUTE",data:{id:t}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void $("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").removeClass("muted")})})}},{key:"render",value:function(e){e="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.isMuted?"muted":"")+"'>";return e+="<button id='user_profile__footer__actions__item--mute' class='btn btn-default fa fa-microphone'>كتم</button>",(e+="<button id='user_profile__footer__actions__item--unmute' class='btn btn-default fa fa-microphone-slash'>إلغاء الكتم</button>")+"</span>"}}],(xe=null)&&le(n.prototype,xe),le(n,Me),pe);function pe(){!function(e){if(!(e instanceof pe))throw new TypeError("Cannot call a class as a function")}(this)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=(xe=me,n=[{key:"registerEvents",value:function(e){me.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item_group--change-decoration").unbind("submit").on("submit",function(e){e.preventDefault();var t=n.getState().requestedUser.id,e=e.target.decoration.value;n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CHANGE_DECORATION",data:{id:t,decoration:e}}),function(e){"string"==typeof(e=Object(a.d)(e))&&alert(e)})})}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-decoration' >";return t+="<label for='user_profile__footer__actions__change_decoration' class='label label-primary user_profile__footer__actions__item_group__label'>الزخرفة</label>",t+="<input type='text' id='user_profile__footer__actions__change_decoration' name='decoration' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.name+"'/>",(t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>")+"</form>"}}],(Me=null)&&fe(xe.prototype,Me),fe(xe,n),me);function me(){!function(e){if(!(e instanceof me))throw new TypeError("Cannot call a class as a function")}(this)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=(Me=ve,xe=[{key:"registerEvents",value:function(e){ve.onAction(e)}},{key:"onAction",value:function(r){$("#user_profile__footer__actions__item_group--control-likes").unbind("submit").on("submit",function(e){e.preventDefault();var t=r.getState().requestedUser.id,n=parseInt(e.target.likes.value);isNaN(n)||r.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CONTROL_LIKES",data:{id:t,likes:n}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void $("#user_profile__footer__actions__item--like").find("span").text(n)})})}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--control-likes' >";return t+="<label for='user_profile__footer__actions__control_likes' class='label label-primary user_profile__footer__actions__item_group__label'>لايكات</label>",t+="<input type='number' id='user_profile__footer__actions__control_likes' name='likes' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.likes+"'/>",(t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>")+"</form>"}}],(n=null)&&_e(Me.prototype,n),_e(Me,xe),ve);function ve(){!function(e){if(!(e instanceof ve))throw new TypeError("Cannot call a class as a function")}(this)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=(n=we,Me=[{key:"registerEvents",value:function(e){we.onAction(e)}},{key:"onAction",value:function(r){$("#user_profile__footer__actions__item_group--change-room").unbind("submit").on("submit",function(e){e.preventDefault();var t=r.getState().requestedUser,n=t.id,e=e.target.room.value;t.room&&t.room.id==e||r.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CHANGE_ROOM",data:{id:n,roomId:e}}),function(e){alert(Object(a.d)(e))})})}},{key:"render",value:function(e){var n=e.getState().requestedUser.room?e.getState().requestedUser.room.id:null,r="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-room' >";return r+="<label for='user_profile__footer__actions__change_room' class='label label-primary user_profile__footer__actions__item_group__label'>الغرفة</label>",r+="<select id='user_profile__footer__actions__change_room' name='room' class='user_profile__footer__actions__item_group__input'>",e.getState().rooms.forEach(function(e){var t=e.id==n?"selected":"";r+="<option dir='rtl' "+t+" value='"+e.id+"'>"+e.name+"</option>"}),r+="</select>",r+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",r+="</form>"}}],(xe=null)&&ye(n.prototype,xe),ye(n,Me),we);function we(){!function(e){if(!(e instanceof we))throw new TypeError("Cannot call a class as a function")}(this)}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=(xe=Ce,n=[{key:"registerEvents",value:function(e){Ce.onAction(e)}},{key:"onAction",value:function(n){$("#user_profile__footer__actions__item_group--change-subscription-end").unbind("submit").on("submit",function(e){e.preventDefault();var t=n.getState().requestedUser.id,e=parseInt(e.target.subscription_end.value);n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CHANGE_SUBSCRIPTION_END",data:{id:t,end:e}}),function(e){Object(a.d)(e)&&alert(Object(a.d)(e))})})}},{key:"toggle",value:function(e){e.getState().requestedUser&&(e.getState().requestedUser.isSuper&&!e.getState().requestedUser.isOwner?$("#user_profile__footer__actions__item_group--change-subscription-end").show():$("#user_profile__footer__actions__item_group--change-subscription-end").hide(),$("#user_profile__footer__actions__change_subscription_end").val(Object(a.e)(e.getState().requestedUser.subscription_end)))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-subscription-end' >";return t+="<label for='user_profile__footer__actions__change_subscription_end' class='label label-primary user_profile__footer__actions__item_group__label' style='width: 25%'>ينتهي بعد</label>",t+="<input type='number' id='user_profile__footer__actions__change_subscription_end' name='subscription_end' class='user_profile__footer__actions__item_group__input' style='width: 55%' value='"+Object(a.e)(e.getState().requestedUser.subscription_end)+"'/>",(t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>")+"</form>"}}],(Me=null)&&Se(xe.prototype,Me),Se(xe,n),Ce);function Ce(){!function(e){if(!(e instanceof Ce))throw new TypeError("Cannot call a class as a function")}(this)}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Te=(Me=Oe,xe=[{key:"registerEvents",value:function(e){Oe.onAction(e)}},{key:"onAction",value:function(r){$("#user_profile__footer__actions__item_group--change-role").unbind("submit").on("submit",function(e){e.preventDefault();var t=r.getState().requestedUser,n=t.id,e=e.target.role.value;t.role!=e&&r.getState().socket.emit("req",Object(a.f)({type:"PROFILE_ACTION_CHANGE_ROLE",data:{id:n,roleId:e}}),function(e){Object(a.d)(e)&&alert(Object(a.d)(e)),ke.toggle(r)})})}},{key:"render",value:function(n){var r="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-role' >";return r+="<label for='user_profile__footer__actions__change_role' class='label label-primary user_profile__footer__actions__item_group__label'>الرتبة</label>",r+="<select id='user_profile__footer__actions__change_role' name='role' class='user_profile__footer__actions__item_group__input'>",n.getState().requestedUser.roles.forEach(function(e){var t=e.id==n.getState().requestedUser.role?"selected":"";r+="<option dir='rtl' "+t+" value='"+e.id+"'>"+e.name+"</option>"}),r+="</select>",r+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",r+="</form>"}}],(n=null)&&Ee(Me.prototype,n),Ee(Me,xe),Oe);function Oe(){!function(e){if(!(e instanceof Oe))throw new TypeError("Cannot call a class as a function")}(this)}function Pe(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function Ae(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Pe(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe,Me,Me=(n=De,Me=[{key:"registerEvents",value:function(e){}},{key:"registerActionEvents",value:function(e){m.registerEvents(e),v.registerEvents(e),w.registerEvents(e),C.registerEvents(e),P.registerEvents(),D.registerEvents(e),B.registerEvents(e),q.registerEvents(e),V.registerEvents(e),Y.registerEvents(e),Z.registerEvents(e),ie.registerEvents(e),ce.registerEvents(e),de.registerEvents(e),he.registerEvents(e),ge.registerEvents(e),be.registerEvents(e),Te.registerEvents(e),ke.registerEvents(e),ne.registerEvents(e)}},{key:"show",value:function(t,n){if(!n.getState().isRequestingProfile){var e=n.getState().users.filter(function(e){return e.id==t})[0];if(!e)return n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_SHOW",data:{id:t,force:!0}}),function(e){n.dispatch(function(e){return{type:"SET_IS_REQUESTING_PROFILE",isRequestingProfile:0<arguments.length&&void 0!==e&&e}}(!1)),(e=Object(a.d)(e)).user&&(n.dispatch(Object(I.c)(Ae(Ae({},e.user),{},{actions:e.actions,roles:e.roles,liked:e.liked}))),De.render(n),$("#user_profile").modal("show"))});n.dispatch(Object(I.c)(Ae(Ae({},e),{},{actions:window.userActions,roles:window.roles,liked:!1}))),De.render(n),$("#user_profile").modal("show"),n.getState().socket.emit("req",Object(a.f)({type:"PROFILE_SHOW",data:{id:t}}),function(e){e=Object(a.d)(e),De.setLikes(e.likes,e.liked),ke.toggle(n)})}}},{key:"setLikes",value:function(e,t){(t?$("#user_profile__footer__actions__item--like").parent().addClass("active"):$("#user_profile__footer__actions__item--like").parent().removeClass("active")).find("span").text(e),$("#user_profile__footer__actions__item_group--control-likes").find("input").val(e)}},{key:"clearAvatar",value:function(e){e=e.getState().requestedUser.avatar;$("#user_profile .user_profile__body__avatar").attr("src",e)}},{key:"render",value:function(e){var t=e.getState().requestedUser;if(!t)return $("#user_profile_container").html("");$("#user_profile_container").html("");var n="<div class='modal fade' id='user_profile' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document' style='max-width: 345px'>",n+="<div class='modal-content'>",n+="<div class='user_profile__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<img class='user_profile__header__avatar' width='25' height='25' src='"+Object(a.c)()+t.avatar+"' alt=''/>",n+="<p class='user_profile__header__name ellipsis'>",n+=r.a.render(t),n+="</p>",n+="<button data-dismiss='modal' class='btn btn-danger user_profile__header__close'>&times;</button>",n+="</div><div class='clear'></div>",n+="</div>",n+="<div class='user_profile__scroll_area' id='user_profile__scroll_area'>",n+="<div class='user_profile__body modal-body'>",t.actions.reveal_names&&(n+=x.render(e),x.registerEvents(e)),n+="<div id='user_profile__body__user_details'>",n+="<img class='user_profile__body__avatar img-rounded img-thumbnail' src='"+Object(a.c)()+t.avatar.replace("/sm/","/lg/")+"' alt=''/>",n+=c.render(e),n+=t.actions.ip?"<p class='user_profile__body__ip label label-success'>"+t.ip+"</p>":"",n+="<p style='color: "+t.statusColor+"' class='user_profile__body__status'>",n+=o.a.render(t.status,e),n+="</p>",n+="<div dir='rtl'>",n+="<div class='user_profile__body__room'>",n+=i.a.render(t.room,!0,e,!0),n+="</div>",n+="<span class='user_profile__body__country_flag'>",n+="<span class='user_profile__body__country_name'>"+t.countryName+"</span>",n+="<img width='18' src='"+Object(a.c)()+t.countryFlag+"' alt='' />",n+="</span>",n+="</div>",n+="<div class='clear'></div>",n+="</div>",n+="</div>",n+="<div class='user_profile__footer modal-footer'>",n+="<div class='user_profile__footer__actions'>",n+=m.render(e),n+=t.actions.notify?v.render(e):"",n+=w.render(e),n+=t.actions.gift?P.render():"",n+=t.actions.reveal_names?D.render(e):"",n+=t.actions.remove_avatar?B.render(e):"",n+=t.actions.room_excpel?q.render(e):"",n+=t.actions.excpel?V.render(e):"",n+=t.actions.ban?Y.render(e):"",n+=Z.render(e),n+=ie.render(e),n+=t.actions.admin_mute?de.render(e):"",n+=t.actions.change_decoration?he.render(e):"",n+=t.actions.control_likes?ge.render(e):"",n+=t.actions.change_room?be.render(e):"",n+=t.actions.change_role?Te.render(e):"",n+=t.actions.change_role?ke.render(e):"",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#user_profile_container").html(n),De.registerEvents(e),De.registerActionEvents(e),c.registerEvents(e),i.a.registerEvents(e),ke.toggle(e),$("#user_profile").find("img").on("contextmenu",function(){return!1})}}],(xe=null)&&Re(n.prototype,xe),Re(n,Me),De),je=t.a=Me;function De(){!function(e){if(!(e instanceof De))throw new TypeError("Cannot call a class as a function")}(this)}},function(e,t,n){"use strict";n.d(t,"h",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"j",function(){return a}),n.d(t,"i",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return p});var r=function(){return{type:"SET_POSTS",posts:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},o=function(){return{type:"ADD_POST",post:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},wallMsgCount:1<arguments.length?arguments[1]:void 0}},i=function(e){return{type:"REMOVE_POST",id:e}},a=function(){return{type:"UPDATE_POSTS_USER",user:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},s=function(){return{type:"UPDATE_POST_ATTRIBUTE",post:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},c=function(){return{type:"INC_POST_COMMENTS_COUNT",post:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},u=function(){return{type:"DEC_POST_COMMENTS_COUNT",post:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},l=function(){return{type:"INC_NEW_POSTS_COUNT"}},d=function(){return{type:"RESET_NEW_POSTS_COUNT"}},p=function(e){return{type:"IS_POSTS_FETCHED",isPostsFetched:e}}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o,i,a,a=(i=s,a=[{key:"registerEvents",value:function(e){s.onSelect()}},{key:"onSelect",value:function(){$(".emoji_picker img.emoji_picker__item").unbind("click").on("click",function(e){var t=e.target.dataset.key,e=document.querySelector($(this).parent().data("input"));e&&(e.value=e.value.trim()+" "+t+" ",e.focus())})}},{key:"toggle",value:function(e){e&&(e.getState().isPublicMessagesFacePickerOpen?$(".emoji_picker.public_messages").show():$(".emoji_picker.public_messages").hide(),e.getState().isPrivateMessagesFacePickerOpen?$(".emoji_picker.private_messages").show():$(".emoji_picker.private_messages").hide(),e.getState().isWallFacePickerOpen?$(".emoji_picker.wall").show():$(".emoji_picker.wall").hide(),e.getState().isWallCommentsFacePickerOpen?$(".emoji_picker.wall-comments").show():$(".emoji_picker.wall-comments").hide())}},{key:"render",value:function(e,t,n){var r="<div class='emoji_picker "+e+"' data-input='"+t+"' style='display: none'>";return n.getState().faces.map(function(e){"?test"==location.search?r+="<img src='/images/floating_heart1.png' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />":r+="<img src='/uploads/faces/"+e.icon+"' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />"}),r+="</div>"}}],(o=null)&&r(i.prototype,o),r(i,a),s);function s(){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this)}t.a=a},function(e,t,n){"use strict";var u=n(6),l=n(9),r=n(20);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a,a=(i=s,a=[{key:"registerEvents",value:function(e){s.getProfile(e)}},{key:"getProfile",value:function(n){$(".chat_pane__user_item").unbind("click").on("click",function(e){var t=$(this).closest(".chat_pane__user_item").data("id");r.a.show(t,n)})}},{key:"render",value:function(e,t,n){var r=e.micStatus.onMic?"on-mic ":"",o=e.micStatus.onHand?"on-hand ":"",i=e.micStatus.soundOff?"on-sound-off ":"",a=e.micTime?e.micTime+Date.now():0,s=e.active?"active":"",c=e.isHidden?"hidden":"",c="<div id='user-"+e.id+"' data-id='"+e.id+"' class='border chat_pane__user_item "+s+" "+c+" '>";return c+="<p class='chat_pane__user_item__avatar'>","?test"==location.search?c+="<img class='"+e.state+"' width='36' height='36' alt='' src='/images/floating_rose2.png' />":c+="<img class='"+e.state+"' width='36' height='36' alt='' src='"+e.avatar+"?v=1' />",c+=t?"<span class='status "+e.state+"'></span>":"",c+="</p>",c+="<div>",c+="<h5 class='chat_pane__user_item__name'>",c+=u.a.render(e),c+="</h5>",c+="<h5 style='color: "+e.statusColor+"' class='chat_pane__user_item__status'>",c+=l.a.render(e.status,n),e.hashTag&&(c+="<span class='chat_pane__user_item__status__hash'>#"+e.hashTag+"</span>"),c+="</h5>",c+="</div>",c+="<img class='chat_pane__user_item__flag' alt='' width='16' height='16' src='"+e.countryFlag+"' />",c+="<div class='clear'></div>",t&&(c+="<p class='chat_pane__user_item__mic_status "+r+" "+o+" "+i+"' >",e.micStatus.onMic&&(c+="<span class='mic-time' data-time='"+a+"'>00:00</span>"),c+="<img class='mic' alt='' src='/images/mic.png' />",c+="<img class='hand' alt='' src='/images/hand.png' />",c+="<img class='sound-off' alt='' src='/images/sound-off.png' />",c+="</p>"),c+"</div>"}}],(n=null)&&o(i.prototype,n),o(i,a),s);function s(){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this)}t.a=a},function(e,t,n){"use strict";var o=n(71),n=n(134),r=Object.prototype.toString;function i(e){return"[object Array]"===r.call(e)}function a(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===r.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:n,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:s,isStream:function(e){return a(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function n(){var r={};function e(e,t){"object"==typeof r[t]&&"object"==typeof e?r[t]=n(r[t],e):r[t]=e}for(var t=0,o=arguments.length;t<o;t++)c(arguments[t],e);return r},extend:function(n,e,r){return c(e,function(e,t){n[t]=r&&"function"==typeof e?o(e,r):e}),n},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(23),c=n(6),u=n(9);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(20);var s,l,l=(s=d,l=[{key:"registerEvents",value:function(e){d.filterUsersByName(e)}},{key:"updateUser",value:function(t,e){var n,r,o,i,a,s=$("#chat__body__users-pane #user-"+t);!s||(n=e.getState().users.filter(function(e){return e.id==t})[0])&&(r=n.micStatus.onMic?"on-mic ":"",o=n.micStatus.onHand?"on-hand ":"",i=n.micStatus.soundOff?"on-sound-off ":"",a=n.micTime?n.micTime+Date.now():0,n.active?s.addClass("active"):s.removeClass("active"),n.isHidden?s.addClass("hidden"):s.removeClass("hidden"),s.find(".chat_pane__user_item__avatar img").attr("src",n.avatar).removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(n.state),s.find(".chat_pane__user_item__avatar .status").removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(n.state),s.find(".chat_pane__user_item__name").html(c.a.render(n)),s.find(".chat_pane__user_item__status").html(u.a.render(n.status,e)).css("color",n.statusColor),s.find(".chat_pane__user_item__mic_status").removeClass("on-mic").removeClass("on-hand").removeClass("on-sound-off").addClass(r).addClass(o).addClass(i),n.micStatus.onMic&&s.find(".chat_pane__user_item__mic_status .mic-time").data("time",a))}},{key:"filterUsersByName",value:function(n){$("#chat__body__users-pane input.chat_pane__search").on("keyup",function(e){var t;0==e.target.value.trim().indexOf("#")?n.dispatch({type:"FILTER_USERS_BY_HASH_TAG",hashTag:(t=e.target.value.trim().replaceAll("#","")).trim()?t:null}):n.dispatch({type:"FILTER_USERS_BY_NAME",name:(e=e.target.value.trim()).trim()?e:null}),d.setUsers(n)})}},{key:"updateCurrentRoomName",value:function(e){$(".chat_pane__container .chat_pane__container__room_name").text(e.getState().mUser.room?e.getState().mUser.room.name:"")}},{key:"setUsers",value:function(e){"users"==e.getState().currentPane&&(d.setUsersOnCurrentRoom(e),d.setUsersOnOtherRooms(e),d.updateCurrentRoomName(e),window.usersPane.find("img").on("contextmenu",function(){return!1}))}},{key:"setUsersOnCurrentRoom",value:function(t){window.usersPane.find("#chat__body__users-pane__current_room .chat_pane__user_item").unbind("click");var n=window.usersPane.find("#chat__body__users-pane__current_room");n.html(""),t.getState().usersFilter?isNaN(t.getState().usersFilter)?t.getState().users.filter(function(e){return e.room&&t.getState().mUser.room&&e.room.id==t.getState().mUser.room.id&&e.name.toLowerCase().includes(t.getState().usersFilter.toLowerCase())}).forEach(function(e){n.append(i.a.render(e,!0,t))}):t.getState().users.filter(function(e){return e.room&&t.getState().mUser.room&&e.room.id==t.getState().mUser.room.id&&e.hashTag==t.getState().usersFilter}).forEach(function(e){n.append(i.a.render(e,!0,t))}):t.getState().users.filter(function(e){return e.room&&t.getState().mUser.room&&e.room.id==t.getState().mUser.room.id&&!t.getState().ignoredUsers.includes(e.id)}).forEach(function(e){n.append(i.a.render(e,!0,t))}),i.a.registerEvents(t)}},{key:"setUsersOnOtherRooms",value:function(t){window.usersPane.find("#chat__body__users-pane__other_rooms .chat_pane__user_item").unbind("click");var n=window.usersPane.find("#chat__body__users-pane__other_rooms");n.html(""),t.getState().usersFilter?t.getState().users.filter(function(e){return(!e.room||!t.getState().mUser.room||e.room.id!=t.getState().mUser.room.id)&&e.name.toLowerCase().includes(t.getState().usersFilter.toLowerCase())}).forEach(function(e){n.append(i.a.render(e,!0,t))}):t.getState().users.filter(function(e){return!e.room||!t.getState().mUser.room||e.room.id!=t.getState().mUser.room.id&&!t.getState().ignoredUsers.includes(e.id)}).forEach(function(e){n.append(i.a.render(e,!0,t))}),i.a.registerEvents(t)}},{key:"scrollToTop",value:function(){window.usersPane.find(".chat_pane__container").scrollTop(0)}},{key:"render",value:function(e){e=" <div id='chat__body__users-pane' class='chat_pane' style='background: "+Object(r.n)(e.getState().settings,!0)+"'>";return e+=o.a.render("المتواجدين"),e+="<input type='text' name='user-name' class='form-control chat_pane__search' placeholder='البحث...' />",e+="<div class='chat_pane__container border'>",e+="<h4 class='chat_pane__label label label-primary right'>المتواجدون في <span class='chat_pane__container__room_name'></span></h4>",e+="<div id='chat__body__users-pane__current_room'></div>",e+="<h4 class='chat_pane__label label label-primary'>المتواجدون في غرف أخرى</h4>",e+="<div id='chat__body__users-pane__other_rooms'></div>",(e+="</div>")+"</div>"}}],(n=null)&&a(s.prototype,n),a(s,l),d);function d(){!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this)}t.a=l},function(e,t,n){"use strict";var r=n(0),o=n(6),i=n(9),a=n(45),s=n(20),c=n(93),u=n.n(c);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d,n=(d=p,n=[{key:"registerEvents",value:function(e){p.youtubeVideoClicked(e),p.videoClicked(e),p.photoClicked(e),p.soundClicked(e),p.getProfile(e),p.remove(e),p.comment(e),p.like(e),u.a.init({wrapAround:!0,disableScrolling:!0})}},{key:"like",value:function(t){$("#chat__body__wall_pane .wall_post .wall_post__body__heart").unbind("click").on("click",function(e){e.stopPropagation();e=$(this).parent().data("id");t.getState().socket.emit("req",Object(r.f)({type:"WALL_LIKE_POST",data:{id:e}}),function(e){if("string"==typeof(e=Object(r.d)(e)))return alert(e)})})}},{key:"remove",value:function(t){$("#chat__body__wall_pane .wall_post .wall_post__body__remove").unbind("click").on("click",function(e){e.stopPropagation();e=$(this).parent().data("id");t.getState().socket.emit("req",Object(r.f)({type:"WALL_REMOVE_POST",data:{id:e}}),function(e){if("string"==typeof(e=Object(r.d)(e)))return alert(e)})})}},{key:"comment",value:function(r){$("#chat__body__wall_pane .wall_post .wall_post__body__comments").unbind("click").on("click",function(e){var t=$(this).parent().data("id"),n=r.getState().posts.filter(function(e){return e.id==t})[0];r.dispatch(function(e){return{type:"SET_WALL_COMMENTS_POST",wallCommentsPost:0<arguments.length&&void 0!==e?e:{}}}(n)),a.a.render(n,r)})}},{key:"getProfile",value:function(t){$("#chat__body__wall_pane .wall_post .wall_post__avatar img").unbind("click").on("click",function(e){e.stopPropagation();e=$(this).closest(".wall_post").data("user");s.a.show(e,t)})}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()})}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",function(e){e.stopPropagation();e=document.getElementById("wall_media_"+$(this).attr("data-id"));e&&(e.insertAdjacentHTML("afterend",'<img class="wall_post__body--video" autoplay controls src="/uploads/wall/photos/'+$(this).attr("data-src")+'"/>'),e.remove())})}},{key:"soundClicked",value:function(){$(".wall_post__body--sound").unbind("click").on("click",function(e){e.stopPropagation();e=document.getElementById("wall_media_"+$(this).attr("data-id"));e&&(e.insertAdjacentHTML("afterend",'<audio class="wall_post__body--sound" autoplay controls src="/uploads/wall/sounds/'+$(this).attr("data-src")+'"></audio>'),e.remove())})}},{key:"videoClicked",value:function(){$(".wall_post__body--video").unbind("click").on("click",function(e){e.stopPropagation();e=document.getElementById("wall_media_"+$(this).attr("data-id"));e&&(e.insertAdjacentHTML("afterend",'<video class="wall_post__body--video" autoplay controls src="/uploads/wall/videos/'+$(this).attr("data-src")+'"></video>'),e.remove())})}},{key:"youtubeVideoClicked",value:function(){$(".wall_post .yt-btn").unbind("click").on("click",function(e){e.stopPropagation();try{var t=$(this).data("post-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",t=document.getElementById("yt-btn-"+t);t&&(t.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),t.remove())}catch(e){}})}},{key:"renderPostBody",value:function(e,t){switch(e.type){case"text":return"<span class='wall_post__body--text'>"+i.a.render(e.body,t)+"</span>";case"photo":return"<button id='wall_media_"+e.id+"' class='wall_post__body--photo btn fa fa-file-photo-o' data-id='"+e.id+"' data-src='"+e.body+"'>عرض الصورة</button>";case"sound":return"<button id='wall_media_"+e.id+"' class='wall_post__body--sound btn fa fa-file-sound-o' data-id='"+e.id+"' data-src='"+e.body+"'>عرض الصوت</button>";case"video":return"<button id='wall_media_"+e.id+"' class='wall_post__body--video btn fa fa-file-video-o' data-id='"+e.id+"' data-src='"+e.body+"'>عرض الفيديو</button>";case"youtube":var n="<button class='yt-btn' id='yt-btn-"+e.id+"' data-post-id='"+e.id+"' data-yid='"+e.body+"'>";return n+="<img src='"+Object(r.c)()+"images/youtube.png'/>",(n+="<img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+e.body+"/0.jpg' />")+"</button>"}}},{key:"render",value:function(e,t){var n=e.active?"active":"",n="<div data-user='"+e.user.id+"' id='wall-post-"+e.id+"' class='wall_post "+n+"' >";return n+="<p class='wall_post__avatar'>",n+="<img class='radius' width='36' height='36' alt='' src='"+Object(r.c)()+e.user.avatar+"' />",n+="</p>",n+="<div>",n+="<h5 class='wall_post__name'>",n+=o.a.render(e.user),n+="</h5>",n+="<h5 style='color: "+e.user.fontColor+"' class='wall_post__body'>",n+=p.renderPostBody(e,t),n+="</h5>",n+="<div class='wall_post__footer' data-id='"+e.id+"'>",n+="<button data-toggle='modal' data-target='#wall_comments' class='wall_post__body__comments fl btn btn-primary fa fa-comments'>"+e.comments+"</button>",n+="<button class='wall_post__body__heart fl btn btn-danger fa fa-heart'>"+e.likes+"</button>",n+="<button class='wall_post__body__remove fr btn btn-danger fa fa-times'></button>",n+="</div>",n+="<span class='wall_post__time fr time' data-time='"+e.time+"'>"+Object(r.q)(e.time)+"</span>",n+="</div>",(n+="<div class='clear'></div>")+"</div>"}}],(c=null)&&l(d.prototype,c),l(d,n),p);function p(){!function(e){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}(this)}t.a=n},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(6),a=n(9),s=n(12),c=n(17),u=n(1);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=(m=p,h=[{key:"registerEvents",value:function(e){p.openChat(e),p.remove(e)}},{key:"openChat",value:function(o){$("#chat__body__conversations_pane .conversations_item").unbind("click").on("click",function(e){var t=o.getState().currentConversation;$(this).removeClass("unread");var n=$(this).data("id"),r=o.getState().conversations.filter(function(e){return e.id==n})[0];r&&r.him&&(t&&t.id==r.id||(o.dispatch(Object(s.f)(r.him)),c.a.render(o)))})}},{key:"remove",value:function(n){$("#chat__body__conversations_pane .conversations_item__remove").unbind("click").on("click",function(e){e.stopPropagation();var t=$(this).closest(".conversations_item").data("id"),e=n.getState().conversations.filter(function(e){return e.id==t})[0];n.getState().currentConversation&&n.getState().currentConversation.id==e.id&&(n.dispatch(Object(s.f)(null)),$("#chat_box_container").html("")),n.dispatch(Object(s.d)(e.id)),$(this).closest(".conversations_item").remove(),u.a.updateConversationsCount(n)})}},{key:"renderLastMessage",value:function(e,t){var n=e.messages.length;if(n){n=e.messages[n-1];return"text"==n.type?a.a.render(n.body,t):"photo"==n.type?"<span class='fa fa-camera'></span>":"sound"==n.type?"<span class='fa fa-microphone'></span>":"video"==n.type?"<span class='fa fa-video-camera'></span>":"youtube"==n.type?"<span class='fa fa-youtube'></span>":void 0}}},{key:"render",value:function(e,t){var n=e.seen?"":"unread",n="<div data-id='"+e.id+"' class='conversations_item "+n+" "+e.him.state+"' >";return n+="<div class='conversations_item__holder fl'>",n+="<p class='conversations_item__avatar'><img class='radius' width='30' height='30' src='"+e.him.avatar+"' /></p>",n+="<div>",n+="<h5 class='conversations_item__name'>",n+=i.a.render(e.him),n+="</h5>",n+="<h5 style='color: "+e.him.fontColor+"' class='conversations_item__last_message'>",n+=p.renderLastMessage(e,t),n+="</h5>",n+="</div>",n+="</div>",n+="<button class='conversations_item__remove btn btn-danger fa fa-times fr'>حذف</button>",(n+="<div class='clear'></div>")+"</div>"}}],(n=null)&&l(m.prototype,n),l(m,h),p);function p(){!function(e){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}(this)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h,m,m=(n=_,m=[{key:"registerEvents",value:function(e){}},{key:"renderConversations",value:function(t){var n=$("#chat__body__conversations_pane .chat_pane__container");n.html(""),t.getState().conversations.filter(function(e){return!t.getState().ignoredUsers.includes(e.him.id)}).forEach(function(e){n.append(d.render(e,t))}),d.registerEvents(t)}},{key:"render",value:function(e){var t="<div id='chat__body__conversations_pane' class='chat_pane' style='background: "+Object(r.n)(e.getState().settings,!0)+"'>";return t+=o.a.render("المحادثات الخاصة"),(t+="<div class='chat_pane__container border'>"+_.renderConversations(e)+"</div>")+"</div>"}}],(h=null)&&f(n.prototype,h),f(n,m),_);function _(){!function(e){if(!(e instanceof _))throw new TypeError("Cannot call a class as a function")}(this)}t.a=m},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(10),a=n(1),s=n(23);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u,l,l=(u=d,l=[{key:"registerEvents",value:function(e){d.close(e),d.setUsers(e)}},{key:"close",value:function(t){$(".chat__body__ignored-users-pane__back button").unbind("click").on("click",function(e){t.dispatch(Object(i.a)("settings")),a.a.togglePane(t)})}},{key:"setUsers",value:function(t){var n=$("#chat__body__ignored-users-pane .chat_pane__container");n.html(""),t.getState().users.forEach(function(e){t.getState().ignoredUsers.includes(e.id)&&n.append(s.a.render(e,!0,t))}),s.a.registerEvents(t)}},{key:"render",value:function(e){e="<div id='chat__body__ignored-users-pane' class='chat_pane' style='background: "+Object(r.n)(e.getState().settings,!0)+"'>";return e+=o.a.render("المستخدمون المتجاهلين"),e+="<p class='chat__body__ignored-users-pane__back'>",e+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",e+="</p>",(e+="<div class='chat_pane__container border'></div>")+"</div>"}}],(n=null)&&c(u.prototype,n),c(u,l),d);function d(){!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this)}t.a=l},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"SET_IS_CALL_DIALOG_OPEN",isCallDialogOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}},function(e,t,n){"use strict";var r=n(10),o=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,s,s=(a=c,s=[{key:"registerEvents",value:function(e){c.hideAllPanes(e)}},{key:"hideAllPanes",value:function(t){window.publicMessagesContainer&&window.publicMessagesContainer.on("click",function(e){t.dispatch(Object(r.a)(null)),o.a.togglePane(t,!0)})}},{key:"scrollToBottom",value:function(){window.publicMessagesContainer&&window.publicMessagesContainer.animate({scrollTop:window.publicMessagesContainer.prop("scrollHeight")},100)}},{key:"render",value:function(){return"<div id='chat__body__messages_container'></div>"}}],(n=null)&&i(a.prototype,n),i(a,s),c);function c(){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this)}t.a=s},function(e,t,n){"use strict";var r=n(22),o=n(0),i=n(10),a=n(54),s=n(8),c=n(1),u=n(4),l=n(13);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f,h,h=(f=m,h=[{key:"registerEvents",value:function(e){m.onFormSubmit(e),m.onLeaveRoom(e),m.openFacePicker(e),m.closePanes(e)}},{key:"onFormSubmit",value:function(n){$("#chat__body__message-input form").on("submit",function(e){e.preventDefault();var t=e.target.message.value.substring(0,250),e=e.target.message;t.trim()&&(e.value="",e.focus(),n.getState().socket.emit("req",Object(o.f)({type:"NEW_PUBLIC_MESSAGE",data:{message:t}}),function(e){return"string"==typeof(e=Object(o.d)(e))?alert(e):(t=m.sanitize(t,n.getState().settings.public_msg_length),s.a.insert({id:Date.now(),user:n.getState().mUser,icon:n.getState().mUser.avatar,title:n.getState().mUser.name,content:t,type:"PUBLIC_MESSAGE"},n),void(window.lastMessage={time:Date.now(),isPublic:!0,isPrivate:!1,msg:e.data.message}))}))})}},{key:"onLeaveRoom",value:function(t){$(".chat__body__message-input__leave_room").on("click",function(){return"object"==d(window.ludoPlayers)&&window.ludoPlayers.filter(function(e){return e.user_id==t.getState().mUser.id})[0]?alert("لايمكنك القيام بهذه العملية حتى تخرج من اللودو"):void t.getState().socket.emit("req",Object(o.f)({type:"LEAVE_ROOM",data:{}}),function(e){e=Object(o.d)(e),s.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:"(هذا المستخدم غادر الغرفة)",type:"JOIN_LEAVE"},t),m.toggleInput(t),u.a.toggle(t,!1),l.a.resetData(!0),$("body").attr("id","")})})}},{key:"toggleInput",value:function(e){e.getState().mUser.room?$("#chat__body__message-input__input, .chat__body__message-input__leave_room").removeAttr("disabled"):$("#chat__body__message-input__input, .chat__body__message-input__leave_room").attr("disabled","disabled")}},{key:"openFacePicker",value:function(t){$("#chat__body__message-input__face").on("click",function(e){t.dispatch(Object(a.a)(!0)),m.closePanes(t)})}},{key:"closePanes",value:function(t){$("#chat__body__message-input__input").on("focus",function(e){t.dispatch(Object(i.a)(null)),c.a.togglePane(t)})}},{key:"canSendMessage",value:function(e){return e.getState().mUser.likes>=e.getState().settings.required_likes_public}},{key:"isXSS",value:function(e){return"string"==typeof e&&/on[a-zA-Z ]{0,}=/g.test(e)}},{key:"convertArNumbers",value:function(t){try{return(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/٠/g,"0")).replace(/١/g,"1")).replace(/٢/g,"2")).replace(/٣/g,"3")).replace(/٤/g,"4")).replace(/٥/g,"5")).replace(/٦/g,"6")).replace(/٧/g,"7")).replace(/٨/g,"8")).replace(/٩/g,"9")}catch(e){return t}}},{key:"parseShortcuts",value:function(e){try{var t=e.split(" ");if(!t.length)return"";var n="";return window.shortcuts.values.length?(t.forEach(function(e){var t;e.trim().length&&(t=window.shortcuts.keys.indexOf(e),n+=0<=t?" "+window.shortcuts.values[t]:" "+e)})," "==n.charAt(0)?n.replace(" ",""):n):e}catch(e){return""}}},{key:"sanitize",value:function(e,t){try{return"string"!=typeof e?"":m.isXSS(e)?"------":(e=m.convertArNumbers(e),e=(e=t?e.substring(0,t):e).replace(/\s+/g," ").replace(/</g,"").replace(/>/g,""),e=m.parseShortcuts(e))}catch(e){return""}}},{key:"render",value:function(e){var t=e.getState().mUser.room?"":"disabled",n="<div id='chat__body__message-input'>";return n+=r.a.render("public_messages","#chat__body__message-input__input",e),n+="<form>",n+="<button type='button' class='chat__body__message-input__leave_room btn btn-primary fa fa-sign-out'></button>",n+="<img class='chat__body__message-input__face' id='chat__body__message-input__face' src='/images/smile.gif' alt='فيس' />",n+="<input "+t+" class='border-color chat__body__message-input__input' name='message' id='chat__body__message-input__input' autoComplete='off' type='text' placeholder='أكتب رسالتك هنا' />",n+="<button class='btn btn-primary fa fa-send chat__body__message-input__submit'>إرسال</button>",(n+="</form>")+"</div>"}}],(n=null)&&p(f.prototype,n),p(f,h),m);function m(){!function(e){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this)}t.a=h},function(e,t,n){"use strict";function r(){return{type:"SET_IS_TV_BOX_OPEN",isTvBoxOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}var o=n(0);function i(e){"touchstart"===e.type?(window.tvInitialX=e.touches[0].clientX-window.tvXOffset,window.tvInitialY=e.touches[0].clientY-window.tvYOffset):(window.tvInitialX=e.clientX-window.tvXOffset,window.tvInitialY=e.clientY-window.tvYOffset);var t=document.querySelector("#tv_box__header"),n=document.querySelector("#tv_box__title"),r=document.querySelector("#tv_box__body");e.target!==t&&e.target!==n&&e.target!==r||(window.tvDragActive=!0)}function a(e){window.tvInitialX=window.tvCurrentX,window.tvInitialY=window.tvCurrentY,window.tvDragActive=!1}function s(e){var t;window.tvDragActive&&(e.preventDefault(),"touchmove"===e.type?(window.tvCurrentX=e.touches[0].clientX-window.tvInitialX,window.tvCurrentY=e.touches[0].clientY-window.tvInitialY):(window.tvCurrentX=e.clientX-window.tvInitialX,window.tvCurrentY=e.clientY-window.tvInitialY),window.tvXOffset=window.tvCurrentX,window.tvYOffset=window.tvCurrentY,t=window.tvCurrentX,e=window.tvCurrentY,document.querySelector("#tv_box").style.transform="translate3d("+t+"px, "+e+"px, 0)")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=(f=l,p=[{key:"register",value:function(){var e=document.querySelector("#chat");window.tvDragActive=!1,window.tvXOffset=window.tvXOffset||0,window.tvYOffset=window.tvYOffset||0,e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",a,!1),e.addEventListener("touchmove",s,!1),e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",s,!1)}},{key:"unregister",value:function(){var e=document.querySelector("#chat");e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchend",a,!1),e.removeEventListener("touchmove",s,!1),e.removeEventListener("mousedown",i,!1),e.removeEventListener("mouseup",a,!1),e.removeEventListener("mousemove",s,!1)}}],(n=null)&&c(f.prototype,n),c(f,p),l);function l(){!function(e){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p,f,f=(n=h,f=[{key:"registerEvents",value:function(e){h.onClose(e)}},{key:"onClose",value:function(t){$("#tv_box__close").unbind().on("click",function(e){h.close(t)})}},{key:"close",value:function(e){e.dispatch(r(!1)),u.unregister(),$("#tv_box").html("")}},{key:"open",value:function(e){e.getState().isTvBoxOpen||($("#tv_box").html(h.render(e)),e.dispatch(r(!0)),h.onClose(e),u.register())}},{key:"update",value:function(e){var t=e.getState().settings.tv_box_title?e.getState().settings.tv_box_title:"",e=h.parseURL(e.getState().settings.tv_box_url);$("#tv_box__title").text(t),$("#tv_box__body iframe").attr("src")!=e&&$("#tv_box__body iframe").attr("src",e)}},{key:"parseURL",value:function(e){if(!e)return"";var t=Object(o.h)(e);return t?"https://www.youtube.com/embed/"+t+"?playsinline=1":e}},{key:"render",value:function(e){var t="<div>";return t+="<header id='tv_box__header' class='label label-primary'>",t+="<span id='tv_box__title'>"+(e.getState().settings.tv_box_title?e.getState().settings.tv_box_title:"")+"</span>",t+="<button id='tv_box__close' class='fa fa-close btn btn-danger'></button>",t+="</header>",t+="<div id='tv_box__body' class='fl'>",t+="<iframe src='"+h.parseURL(e.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",(t+="</div>")+"</div>"}}],(p=null)&&d(n.prototype,p),d(n,f),h);function h(){!function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this)}t.a=f},function(e,t,n){"use strict";n(132);var c=n(0),o=n(11),r=n(10),i=n(1);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=(C=f,y=[{key:"registerEvents",value:function(e){f.editRoom(e),f.deleteRoom(e)}},{key:"editRoom",value:function(s){$("#editRoomModal form").on("submit",function(e){e.preventDefault();var t=e.target.name.value.trim(),n=e.target.description.value.trim(),r=e.target.welcome.value.trim(),o=e.target.password.value.trim(),i=e.target.required_likes.value,a=e.target.capacity.value,e=$(this).data("id");return t.length?t.length<2?f.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):t!=s.getState().mUser.room.name&&s.getState().rooms.filter(function(e){return e.name==t}).length?f.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):a<2||50<a?f.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void s.getState().socket.emit("req",Object(c.f)({type:"EDIT_ROOM",data:{room:{id:e,name:t,description:n,welcome:r,password:o,required_likes:i,capacity:a,is_voice_room:s.getState().mUser.room.is_voice_room}}}),function(e){return"string"==typeof(e=Object(c.d)(e))?alert(e):void(e&&"object"==u(e)&&(!1===e.error?f.showSuccessMessage("تم تعديل الغرفة بنجاح"):!0===e.error&&f.showErrorMessage(e.message)))}):f.showErrorMessage("الرجاء إعطاء إسم للغرفة")})}},{key:"deleteRoom",value:function(t){$("#room_modal__body__form__delete").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"REMOVE_ROOM",data:{room:{id:t.getState().mUser.room.id}}}),function(e){return"string"==typeof(e=Object(c.d)(e))?alert(e):void(e&&"object"==u(e)&&(!1===e.error?f.showSuccessMessage("تمت العملية بنجاح, سيتم حذف الغرفة عندما تفرغ"):!0===e.error&&f.showErrorMessage(e.message)))})})}},{key:"showErrorMessage",value:function(e){$("#editRoomModal .alert-success").hide(),$("#editRoomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#editRoomModal .alert-success").text(e).show(),$("#editRoomModal .alert-danger").hide()}},{key:"render",value:function(e,t){var n=e.description||"",r=e.welcome||"",o=e.required_likes||0,i="<div class='modal fade room_modal' id='editRoomModal' tabindex='-1' role='dialog' aria-hidden='true'>";i+="<div class='modal-dialog' role='document'>",i+="<div class='modal-content'>",i+="<div class='room_modal__header modal-header label label-primary'>",i+="<div class='modal-title'>",i+="<p class='room_modal__header__name ellipsis'>تعديل الغرفة</p>",i+="<button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button>",i+="</div>",i+="</div>",i+="<div class='room_modal__body modal-body'>",i+="<p class='alert alert-danger' style='display: none'></p>",i+="<p class='alert alert-success' style='display: none'></p>",i+="<form data-id='"+e.id+"' id='room_modal__body__form'>",i+="<div>",i+="<div><input type='text' name='name' value='"+e.name+"' placeholder='عنوان الغرفة' /></div>",i+="<div><input type='text' name='description' value='"+n+"' placeholder='الوصف' /></div>",i+="<div><input type='text' name='welcome' value='"+r+"' placeholder='رسالة الترحيب' /></div>",i+="<div><input type='text' name='password' placeholder='كلمة المرور' /></div>",i+="<div><input type='number' name='required_likes' value='"+o+"' placeholder='لايكات الدخول' /></div>",i+="<div><input type='number' name='capacity' value='"+e.capacity+"' placeholder='حجم الغرفة من 2 إلى 50' /></div>",i+="<button class='btn btn-success pull-left'><span class='fa fa-save'></span>حفظ التعديلات&nbsp;</button>",i+="<button id='room_modal__body__form__delete' type='button' class='btn btn-danger pull-right'><span class='fa fa-remove'></span>حذف الغرفة</button>",i+="</div>",i+="</form>",i+="</div>",i+="</div>",i+="</div>",i+="</div>",$("#room_modal__body__form__delete").unbind("click"),$("#editRoomModal form").unbind("submit"),$("#edit_room_container").html(i),f.registerEvents(t)}}],(d=null)&&a(C.prototype,d),a(C,y),f),l=n(14),d=n(41),p=n.n(d);function f(){!function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=(C=g,y=[{key:"registerEvents",value:function(e){g.onFormSubmited(e)}},{key:"onFormSubmited",value:function(t){$("#bot_brb_modal__body__form").unbind("submit").on("submit",function(e){e.preventDefault(),e.originalEvent.submitter.classList.contains("btn-success")?g.start(t,$(this)):e.originalEvent.submitter.classList.contains("btn-warning")?g.pause(t,$(this)):e.originalEvent.submitter.classList.contains("btn-danger")?g.stop(t,$(this)):e.originalEvent.submitter.classList.contains("btn-info")&&g.update(t,$(this))})}},{key:"start",value:function(e,t){var n=t.find("input[name='num_rounds']").val(),r=t.find("input[name='bot_brb_modal__body__form__speed']").val(),t=t.find("input[name='bot_brb_modal__body__form__excpel']").prop("checked"),r={type:"BOT_BRB_CREATE",data:{room_id:e.getState().mUser.room.id,num_rounds:n,excpel:t,speed:r}};e.getState().socket.emit("req",Object(c.f)(r),function(e){g.setBot(e.bot),$("#manageBotBrbModal .bot_brb_modal__header__close").click()})}},{key:"pause",value:function(e,t){var n={type:"BOT_BRB_PAUSE",data:{room_id:e.getState().mUser.room.id}};e.getState().socket.emit("req",Object(c.f)(n),function(e){g.setBot(e.bot)})}},{key:"stop",value:function(e,t){var n={type:"BOT_BRB_STOP",data:{room_id:e.getState().mUser.room.id}};e.getState().socket.emit("req",Object(c.f)(n),function(e){g.setBot(e.bot)})}},{key:"update",value:function(e,t){t=t.find("input[name='bot_brb_modal__body__form__speed']").val(),t={type:"BOT_BRB_UPDATE",data:{room_id:e.getState().mUser.room.id,speed:t}};e.getState().socket.emit("req",Object(c.f)(t),function(e){g.setBot(e.bot)})}},{key:"setBot",value:function(e){if(!e)return $("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),void $("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled");e.isPaused?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")):e.isStopped?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled")):e.isStarted&&($("#bot_brb_modal__body__form__button--start").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--pause").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")),e.isStarted||e.isPaused?$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").attr("disabled","disabled"):$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").removeAttr("disabled"),$("#bot_num_rounds").val(e.num_rounds),$("#bot_brb_modal__body__form__speed").val(e.speed),e.excpel?$("#bot_brb_modal__body__form__excpel").attr("checked","checked"):$("#bot_brb_modal__body__form__excpel").removeAttr("checked")}},{key:"render",value:function(e){var t="<div class='modal fade bot_brb_modal' id='manageBotBrbModal' tabindex='-1' role='dialog' aria-hidden='true'>";t+="<div class='modal-dialog' role='document'>",t+="<div class='modal-content'>",t+="<div class='bot_brb_modal__header modal-header label label-primary'>",t+="<div class='modal-title'>",t+="<p class='bot_brb_modal__header__name ellipsis'>"+e.getState().mUser.room.name+"</p>",t+="<button data-dismiss='modal' class='btn btn-danger bot_brb_modal__header__close fa fa-times'></button>",t+="</div>",t+="</div>",t+="<div class='bot_brb_modal__body modal-body'>",t+="<p class='alert alert-danger' style='display: none'></p>",t+="<p class='alert alert-success' style='display: none'></p>",t+="<form id='bot_brb_modal__body__form'>",t+="<div>",t+="<div><input type='number' id='bot_num_rounds' min='2' max='10' name='num_rounds' value='5' placeholder='عدد الجولات' /></div>",t+='<div class="form-group">',t+='<input type="checkbox" id="bot_brb_modal__body__form__excpel" name="bot_brb_modal__body__form__excpel"/>',t+='<label for="bot_brb_modal__body__form__excpel">أطرد خصمك</label>',t+="</div>",t+='<div class="form-group">',t+='<label for="bot_brb_modal__body__form__speed">سرعة البوت</label><br>',t+="<input type='number' id='bot_brb_modal__body__form__speed' min='100' max='5000' name='bot_brb_modal__body__form__speed' value='1000' placeholder='رقم من 100 إلى 5000' style='width: 50%' />",t+="<button id='bot_brb_modal__body__form__button--update' class='btn btn-info pull-right'><span class='fa fa-refresh'></span>تحديث السرعة&nbsp;</button>",t+="</div>",t+="<div class='bot_brb_modal__body__form__buttons'>",t+="<button id='bot_brb_modal__body__form__button--start' class='btn btn-success'><span class='fa fa-play'></span>تشغيل&nbsp;</button>",t+="<button id='bot_brb_modal__body__form__button--pause' class='btn btn-warning'><span class='fa fa-pause'></span>إيقاف مؤقت&nbsp;</button>",t+="<button id='bot_brb_modal__body__form__button--stop' class='btn btn-danger'><span class='fa fa-stop'></span>إيقاف&nbsp;</button>",t+="</div>",t+="</div>",t+="</form>",t+="</div>",t+="</div>",t+="</div>",t+="</div>",$("#manage_bot_brb_container").html(t),g.registerEvents(e),g.setBot(null)}}],(d=null)&&h(C.prototype,d),h(C,y),g),_=n(13);function g(){!function(e){if(!(e instanceof g))throw new TypeError("Cannot call a class as a function")}(this)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y,b=(d=S,C=[{key:"registerEvents",value:function(e){S.requestRed(e),S.requestGreen(e),S.requestYellow(e),S.requestBlue(e),S.startGame(e)}},{key:"requestRed",value:function(o){$("#pre_youcam_ludo_modal__body__form--request-red").unbind("click").on("click",function(e){e.preventDefault();var t=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),r=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),e=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return t?(n==t&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),r==t&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),e==t&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-red__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-red").hide(),t==o.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-red__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-red").prop("disabled",!0)):(o.getState().socket.emit("req",Object(c.f)({type:"YOUCAM_LUDO_REQUEST",data:{user:t,color:"red"}}),function(e){e=Object(c.d)(e)}),void setTimeout(function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-red__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-red__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-red").show())},1e4))):alert("الرجاء إختيار لاعب من القائمة")})}},{key:"requestGreen",value:function(o){$("#pre_youcam_ludo_modal__body__form--request-green").unbind("click").on("click",function(e){e.preventDefault();var t=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),r=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),e=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return n?(t==n&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),r==n&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),e==n&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-green__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-green").hide(),n==o.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-green__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-green").prop("disabled",!0)):(o.getState().socket.emit("req",Object(c.f)({type:"YOUCAM_LUDO_REQUEST",data:{user:n,color:"green"}}),function(e){e=Object(c.d)(e)}),void setTimeout(function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-green__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-green__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-green").show())},1e4))):alert("الرجاء إختيار لاعب من القائمة")})}},{key:"requestYellow",value:function(o){$("#pre_youcam_ludo_modal__body__form--request-yellow").unbind("click").on("click",function(e){e.preventDefault();var t=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),r=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),e=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return r?(t==r&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),n==r&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),e==r&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-yellow__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-yellow").hide(),r==o.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-yellow").prop("disabled",!0)):(o.getState().socket.emit("req",Object(c.f)({type:"YOUCAM_LUDO_REQUEST",data:{user:r,color:"yellow"}}),function(e){e=Object(c.d)(e)}),void setTimeout(function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-yellow__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-yellow").show())},1e4))):alert("الرجاء إختيار لاعب من القائمة")})}},{key:"requestBlue",value:function(o){$("#pre_youcam_ludo_modal__body__form--request-blue").unbind("click").on("click",function(e){e.preventDefault();var t=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),r=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),e=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return e?(t==e&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),r==e&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),n==e&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),$("#pre_youcam_ludo_modal__body__form--request-blue__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-blue").hide(),e==o.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-blue__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-blue").prop("disabled",!0)):(o.getState().socket.emit("req",Object(c.f)({type:"YOUCAM_LUDO_REQUEST",data:{user:e,color:"blue"}}),function(e){e=Object(c.d)(e)}),void setTimeout(function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-blue__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-blue__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-blue").show())},1e4))):alert("الرجاء إختيار لاعب من القائمة")})}},{key:"startGame",value:function(i){$(".pre_youcam_ludo_modal__body__form__button--start").unbind("click").on("click",function(e){e.preventDefault();var t=$(this).hasClass("public"),n=document.querySelector("#pre_youcam_ludo_modal__body__form--select-red").value,r=document.querySelector("#pre_youcam_ludo_modal__body__form--select-green").value,o=document.querySelector("#pre_youcam_ludo_modal__body__form--select-yellow").value,e=document.querySelector("#pre_youcam_ludo_modal__body__form--select-blue").value;n==i.getState().mUser.id&&(window.mUserLudoColor="red"),r==i.getState().mUser.id&&(window.mUserLudoColor="green"),o==i.getState().mUser.id&&(window.mUserLudoColor="yellow"),e==i.getState().mUser.id&&(window.mUserLudoColor="blue"),_.a.startGame(i,[{color:"red",user_id:n},{color:"green",user_id:r},{color:"yellow",user_id:o},{color:"blue",user_id:e}],t)})}},{key:"render",value:function(t){var e,n;t.getState().mUser.room&&(e=t.getState().users.filter(function(e){return e.room&&e.room.id==t.getState().mUser.room.id}),n="<div class='modal fade pre_youcam_ludo_modal' id='preYoucamLudoModal' tabindex='-1' role='dialog' aria-hidden='true'>",n+="<div class='modal-dialog' role='document'>",n+="<div class='modal-content'>",n+="<div class='pre_youcam_ludo_modal__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<p class='pre_youcam_ludo_modal__header__name ellipsis'>يوكام لودو</p>",n+="<button data-dismiss='modal' class='btn btn-danger pre_youcam_ludo_modal__header__close fa fa-times'></button>",n+="</div>",n+="</div>",n+="<div class='pre_youcam_ludo_modal__body modal-body'>",n+="<p class='alert alert-danger' style='display: none'></p>",n+="<p class='alert alert-success' style='display: none'></p>",n+="<form id='pre_youcam_ludo_modal__body__form'>",n+="<div>",n+="<div><img height='30' class='pre_youcam_ludo_modal__body__form--player-icon' src='/images/ludo_red.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-red' name='red' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",e.forEach(function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"}),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-red' class='btn btn-primary btn btn-default'>إرسال</button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-red__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_green.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-green' name='green' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",e.forEach(function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"}),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-green' class='btn btn-primary btn btn-default'>إرسال</button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-green__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_yellow.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-yellow' name='yellow' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",e.forEach(function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"}),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-yellow' class='btn btn-primary btn btn-default'>إرسال</button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-yellow__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_blue.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-blue' name='blue' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",e.forEach(function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"}),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-blue' class='btn btn-primary btn btn-default'>إرسال</button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-blue__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div class='pre_youcam_ludo_modal__body__form__buttons'>",n+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start private btn btn-success'><span class='fa fa-play'></span>بدأ اللعب خاص &nbsp;</button>",n+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start public btn btn-success'><span class='fa fa-users'></span>بدأ اللعب عام &nbsp;</button>",n+="</div>",n+="</div>",n+="</form>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#youcam_ludo_container").html(n),S.registerEvents(t))}}],(y=null)&&v(d.prototype,y),v(d,C),S),w=n(34);function S(){!function(e){if(!(e instanceof S))throw new TypeError("Cannot call a class as a function")}(this)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C,C=(d=E,C=[{key:"registerEvents",value:function(e){E.submit(e),E.initJSColor(),E.openAdmin(e),E.closeChat(e),E.onBotBrbClicked(e),E.openIngoredUsers(e),E.removeNameBgColor(e),E.openNotifications(e),E.changeFontSize(e),E.hideRoleIcon(e),E.triggerChangeAvatarInput(e),E.changeAvatar(e),E.removeAvatar(e),E.togglePrivate(e),E.toggleNotifications(e),E.changePassword(e),E.sendAd(e),E.manageRoom(e),E.youcamLudo(e),E.broadcastLive(e)}},{key:"prependHash",value:function(e){return"string"!=typeof e?"":e.includes("#")?e:"#"+e}},{key:"initJSColor",value:function(){var e,t=document.getElementsByClassName("jscolor");for(e in t)try{new jscolor(t[e]).importColor()}catch(t){}}},{key:"changeFontSize",value:function(t){$("#chat__body__settings_pane__container__button--change-font-size option[value='"+t.getState().mUser.fontSize+"']").attr("selected","selected"),document.querySelector("html").style.fontSize=t.getState().mUser.fontSize+"px",$("#chat__body__settings_pane__container__button--change-font-size").on("change",function(e){e={type:"USER_SETTINGS_SET_FONT_SIZE",data:{fontSize:e.target.value}};t.getState().socket.emit("req",Object(c.f)(e),function(e){e=Object(c.d)(e),t.getState().mUser.reg_id||Object(c.p)("fontSize",Object(c.f)(e,!0)),t.dispatch(Object(o.f)({fontSize:e})),document.querySelector("html").style.fontSize=e+"px"})})}},{key:"submit",value:function(r){$("#chat__body__settings_pane form").on("submit",function(e){e.preventDefault();var t=e.target.decoration.value.substring(0,50),n=e.target.status.value.substring(0,300);if(r.getState().mUser.name!=t&&r.getState().mUser.likes<r.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+r.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الإسم");if(r.getState().mUser.status!=n&&r.getState().mUser.likes<r.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+r.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الحالة");e={type:"USER_SETTINGS_SAVE",data:{decoration:t,status:n,fontColor:E.prependHash(e.target.fontColor.value.trim()),nameColor:E.prependHash(e.target.nameColor.value.trim()),nameBgColor:E.prependHash(e.target.nameBgColor.value.trim()),statusColor:E.prependHash(e.target.statusColor.value.trim())}};r.getState().socket.emit("req",Object(c.f)(e),function(t){t=Object(c.d)(t),r.getState().mUser.reg_id||Object.keys(t).forEach(function(e){e="name"==e?"gun":e,Object(c.p)(e,Object(c.f)(t["gun"==e?"name":e],!0))})})})}},{key:"triggerChangeAvatarInput",value:function(n){$("#chat__body__settings_pane__container__button--change_avatar").on("click",function(e){return n.getState().mUser.likes<n.getState().settings.required_likes_to_change_avatar?alert("يجب أن تتوفر على "+n.getState().settings.required_likes_to_change_avatar+" حتى تتمكن من تغيير الصورة"):void($(this).hasClass("is-loading")||(t=document.getElementById("change_avatar_input"))&&t.click());var t})}},{key:"changeAvatar",value:function(n){$("#change_avatar_input").on("change",function(e){var t=new FormData;t.append("avatar",e.target.files[0]),$("#chat__body__settings_pane__container__button--change_avatar").addClass("disabled"),p.a.post("/change_avatar",t).then(function(e){$("#chat__body__settings_pane__container__button--change_avatar").removeClass("disabled"),!1===e.data.error&&(e={type:"USER_SETTINGS_CHANGE_AVATAR",data:{avatar:e.data.avatar}},n.getState().socket.emit("req",Object(c.f)(e),function(e){n.getState().mUser.reg_id||Object(c.p)("avatar",Object(c.f)(e,!0)),e=Object(c.d)(e),E.updateUserAttribute("avatar","/uploads/avatars/sm/"+e,n),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src","/uploads/avatars/sm/"+e)}))}).catch(function(e){})})}},{key:"removeAvatar",value:function(t){$("#chat__body__settings_pane__container__button--remove-avatar").on("click",function(e){confirm("هلل أنت متأكد من حذف الصورة؟")&&t.getState().socket.emit("req",Object(c.f)({type:"USER_SETTINGS_REMOVE_AVATAR",data:{}}),function(e){t.getState().mUser.reg_id||Object(c.p)("avatar",null),e=Object(c.d)(e),E.updateUserAttribute("avatar",e,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src",e)})})}},{key:"updateUserAttribute",value:function(e,t,n){var r={};r[e]=t,n.dispatch(Object(o.f)(r))}},{key:"updateDecoration",value:function(e){$("#chat__body__settings_pane form input[name='decoration']").val(e.getState().mUser.name)}},{key:"openIngoredUsers",value:function(t){$("#chat__body__settings_pane__container__button--ignored_users").on("click",function(e){t.dispatch(Object(r.a)("ignored_users")),i.a.togglePane(t)})}},{key:"openNotifications",value:function(t){$("#chat__body__settings_pane__container__button--notifications").on("click",function(e){t.dispatch(Object(r.a)("notifications")),i.a.togglePane(t)})}},{key:"removeNameBgColor",value:function(t){$(".chat__body__settings_pane__container__rm_bg_color").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"USER_SETTINGS_REMOVE_NAME_BG_COLOR",data:{}}),function(e){e=Object(c.d)(e),t.getState().mUser.reg_id||Object(c.p)("nameBgColor",Object(c.f)(e,!0)),E.updateUserAttribute("nameBgColor",e,t),$("input[name='nameBgColor']").val("FFFFFF"),E.initJSColor()})})}},{key:"hideRoleIcon",value:function(t){$("#chat__body__settings_pane__container__button--toggle-star").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"USER_SETTINGS_HIDE_ROLE_ICON",data:{}}),function(e){e=Object(c.d)(e),E.updateUserAttribute("isRoleIconHidden",e,t),e?($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").removeClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").addClass("toggle_star--active")):($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").addClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").removeClass("toggle_star--active"))})})}},{key:"togglePrivate",value:function(t){$("#chat__body__settings_pane__container__button--toggle_private").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"USER_SETTINGS_TOGGLE_PRIVATE",data:{}}),function(e){e=Object(c.d)(e),E.updateUserAttribute("isPrivateDisabled",e,t),e?($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").removeClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").addClass("toggle_private--active")):($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").addClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").removeClass("toggle_private--active"))})})}},{key:"toggleNotifications",value:function(t){$("#chat__body__settings_pane__container__button--toggle_notifications").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"USER_SETTINGS_TOGGLE_NOTIFICATIONS",data:{}}),function(e){e=Object(c.d)(e),E.updateUserAttribute("isNotificationsDisabled",e,t),e?($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").removeClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").addClass("toggle_notifications--active")):($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").addClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").removeClass("toggle_notifications--active"))})})}},{key:"changePassword",value:function(r){$("#chat__body__settings_pane__container__button-change_password").on("click",function(e){var t=prompt("الرجاء إدخال كلمة المرور الجديدة");if(t){if(t.length<6)return alert("كلمة المرور لا يجب أن تقل عن 6 أحرف");var n={type:"USER_SETTINGS_CHANGE_PASSWORD",data:{password:t}};r.getState().socket.emit("req",Object(c.f)(n),function(e){(e=Object(c.d)(e)).error||Object(c.p)("mup",Object(c.f)(t,!0)),alert(e.message)})}})}},{key:"sendAd",value:function(n){$("#chat__body__settings_pane__container__button--send_ad").on("click",function(e){var t=prompt("الرجاء إدخال الرسالة:");t&&(t={type:"USER_SETTINGS_SEND_AD",data:{message:t}},n.getState().socket.emit("req",Object(c.f)(t),function(e){}))})}},{key:"manageRoom",value:function(t){$("#chat__body__settings_pane__container__button--manage_room").on("click",function(e){return t.getState().mUser.room?void s.render(t.getState().mUser.room,t):alert("الرجاء الدخول إلى غرفة حتى تتمكن من إدارتها")})}},{key:"youcamLudo",value:function(t){$("#chat__body__settings_pane__container__button--youcam-ludo").on("click",function(e){t.getState().mUser.isPlaying||b.render(t)})}},{key:"broadcastLive",value:function(t){$("#chat__body__settings_pane__container__button--broadcast_live").on("click",function(e){t.getState().socket.emit("req",Object(c.f)({type:"BROADCAST_LIVE_START",data:{}}),function(e){"string"==typeof(e=Object(c.d)(e))&&("success"==e?(w.a.init(t,!0),w.a.render(t,t.getState().mUser.id)):alert(e))})})}},{key:"openAdmin",value:function(t){$("#chat__body__settings_pane__container__button--open_admin").on("click",function(e){window.open("/fadmn/home/".concat(t.getState().grantedSettings.adminToken),"_blank").focus()})}},{key:"onBotBrbClicked",value:function(n){$("#chat__body__settings_pane__container__button--bot-brb").on("click",function(e){if(!n.getState().mUser.room)return alert("يجب أن  تكون داخل غرفة حتى تتمكن من تشغيل البوت");m.render(n);var t={type:"BOT_BRB_OPEN",data:{room_id:n.getState().mUser.room.id}};n.getState().socket.emit("req",Object(c.f)(t),function(e){m.setBot(e.bot,n)})})}},{key:"closeChat",value:function(t){$("#chat__body__settings_pane__container__button--close-chat").on("click",function(e){window.confirmOnExit=!1,t.getState().socket.disconnect()})}},{key:"render",value:function(e){var t="<div id='chat__body__settings_pane' class='chat_pane' style='background: "+Object(c.n)(e.getState().settings,!0)+"'>";return t+=l.a.render("الإعدادات"),t+="<div class='chat__body__settings_pane__container'>",t+="<div style='margin-bottom: 5px' >",t+="<label class='label label-primary'>الزخرفة</label>",t+="<label class='label label-primary pull-right'>الملف الشخصي</label>",t+="<form>",t+="<input type='text' name='decoration' value='"+e.getState().mUser.name+"' class='form-control' />",t+="<div>",t+="<label class='label label-primary'>الحالة</label>",t+="<input type='text' name='status' value='"+e.getState().mUser.status+"' class='form-control' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الحالة</label>",t+="<input type='text' name='statusColor' value='"+e.getState().mUser.statusColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخط</label>",t+="<input type='text' name='fontColor' value='"+e.getState().mUser.fontColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الإسم</label>",t+="<input type='text' name='nameColor' value='"+e.getState().mUser.nameColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخلفية</label>",t+="<input type='text' name='nameBgColor' value='"+e.getState().mUser.nameBgColor+"' class='jscolor form-input' />",t+="<button type='button' class='chat__body__settings_pane__container__rm_bg_color btn btn-danger fa fa-times'></button>",t+="</div>",t+="<button name='submit' class='chat__body__settings_pane__container__submit btn btn-success fa fa-save fr'>حفظ</button>",t+="<div class='clear'></div>",t+="</form>",t+="</div>",t+="<select id='chat__body__settings_pane__container__button--change-font-size' class='form-control label-primary' value='"+e.getState().mUser.fontSize+"' style='height: auto' >",t+="<option value='18'>حجم الخط 10</option>",t+="<option value='20'>حجم الخط 11</option>",t+="<option value='22'>حجم الخط 12</option>",t+="<option value='24'>حجم الخط 13</option>",t+="<option value='26'>حجم الخط 14</option>",t+="<option value='28'>حجم الخط 15</option>",t+="<option value='30'>حجم الخط 16</option>",t+="</select>",t+="<div id='chat__body__settings_pane__container__button--ignored_users' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-ban'></span>المستخدمون المتجاهلين</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--notifications' class='chat__body__settings_pane__container__button form-control info'>",t+="<span><span class='fa fa-bell'></span>الإشعارات</span>",t+="</div>",e.getState().grantedSettings.hide_role_icon&&(t+="<div id='chat__body__settings_pane__container__button--toggle-star' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_star toggle_star__hide "+(e.getState().mUser.isRoleIconHidden?"":"toggle_star--active")+"'><span class='fa fa-eye-slash'></span>إخفاء النجمة</span>",t+="<span class='toggle_star toggle_star__show "+(e.getState().mUser.isRoleIconHidden?"toggle_star--active":"")+"'><span class='fa fa-eye'></span>إظهار النجمة</span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--change_avatar' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa'>",t+="<img class='avatar' src='"+e.getState().mUser.avatar+"' width='20' height='20' alt='' />",t+="<img class='loader' src='/images/loader.gif' width='20' height='20' alt=''/>",t+="</span>تغيير الصورة</span>",t+="<input accept='image/*' type='file' id='change_avatar_input' style='position: absolute; top: -1000px' />",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--remove-avatar' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-remove'></span>حذف الصورة</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--toggle_private' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_private toggle_private__enable "+(e.getState().mUser.isPrivateDisabled?"toggle_private--active":"")+"'><span class='fa fa-check'></span>تفعيل المحادثات الخاصة</span>",t+="<span class='toggle_private toggle_private__disable "+(e.getState().mUser.isPrivateDisabled?"":"toggle_private--active")+"'><span class='fa fa-times'></span>تعطيل المحادثات الخاصة</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--toggle_notifications' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_notifications toggle_notifications__enable "+(e.getState().mUser.isNotificationsDisabled?"toggle_notifications--active":"")+"'><span class='fa fa-check'></span>تفعيل التنبيهات</span>",t+="<span class='toggle_notifications toggle_notifications__disable "+(e.getState().mUser.isNotificationsDisabled?"":"toggle_notifications--active")+"'><span class='fa fa-times'></span>تعطيل التنبيهات</span>",t+="</div>",e.getState().grantedSettings.change_password&&(t+="<div id='chat__body__settings_pane__container__button-change_password' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-key'></span>تغيير كلمة المرور</span>",t+="</div>"),e.getState().grantedSettings.admin_rooms_edit&&(t+="<div data-toggle='modal' data-target='#editRoomModal' id='chat__body__settings_pane__container__button--manage_room' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-home'></span>إدارة الغرفة</span>",t+="</div>"),e.getState().grantedSettings.send_ad&&(t+="<div id='chat__body__settings_pane__container__button--send_ad' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-send'></span>الإعلان للأدعية و المسابقات</span>",t+="</div>"),e.getState().grantedSettings.bot_brb&&(t+="<div data-toggle='modal' data-target='#manageBotBrbModal' id='chat__body__settings_pane__container__button--bot-brb' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-dashboard'></span>بوت برب</span>",t+="</div>"),e.getState().grantedSettings.youcam_ludo&&(t+="<div data-toggle='modal' data-target='#preYoucamLudoModal' id='chat__body__settings_pane__container__button--youcam-ludo' class='chat__body__settings_pane__container__button form-control' style='background-color: #980F5A; color: #FFFFFF;'>",t+="<span><span class='fa fa-gamepad' style='color: #FFFFFF'></span>يوكام لودو</span>",t+="</div>"),e.getState().grantedSettings.broadcast_live&&(t+="<div id='chat__body__settings_pane__container__button--broadcast_live' class='chat__body__settings_pane__container__button form-control' style='background-color: #3a85ab; color: #FFFFFF;'>",t+="<span><span class='fa fa-tv' style='color: #FFFFFF'></span>بث مباشر</span>",t+="</div>"),e.getState().grantedSettings.admin&&(t+="<div id='chat__body__settings_pane__container__button--open_admin' class='chat__body__settings_pane__container__button form-control success'>",t+="<span><span class='fa fa-star'></span>لوحة التحكم</span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--close-chat' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-sign-out'></span>تسجيل الخروج</span>",t+="</div>",(t+="</div>")+"</div>"}}],(n=null)&&k(d.prototype,n),k(d,C),E);function E(){!function(e){if(!(e instanceof E))throw new TypeError("Cannot call a class as a function")}(this)}t.a=C},function(e,t,n){"use strict";function r(e,t){"touchstart"===e.type?(window["broadcast-live-"+t+"-InitialX"]=e.touches[0].clientX-window["broadcast-live-"+t+"-XOffset"],window["broadcast-live-"+t+"-InitialY"]=e.touches[0].clientY-window["broadcast-live-"+t+"-YOffset"]):(window["broadcast-live-"+t+"-InitialX"]=e.clientX-window["broadcast-live-"+t+"-XOffset"],window["broadcast-live-"+t+"-InitialY"]=e.clientY-window["broadcast-live-"+t+"-YOffset"]);var n=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__header"),r=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__title"),o=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__body");e.target!==n&&e.target!==r&&e.target!==o||(window["broadcast-live-"+t+"-DragActive"]=!0)}function o(e,t){window["broadcast-live-"+t+"-InitialX"]=window["broadcast-live-"+t+"-CurrentX"],window["broadcast-live-"+t+"-InitialY"]=window["broadcast-live-"+t+"-CurrentY"],window["broadcast-live-"+t+"-DragActive"]=!1}function i(e,t){var n;window["broadcast-live-"+t+"-DragActive"]&&(e.preventDefault(),"touchmove"===e.type?(window["broadcast-live-"+t+"-CurrentX"]=e.touches[0].clientX-window["broadcast-live-"+t+"-InitialX"],window["broadcast-live-"+t+"-CurrentY"]=e.touches[0].clientY-window["broadcast-live-"+t+"-InitialY"]):(window["broadcast-live-"+t+"-CurrentX"]=e.clientX-window["broadcast-live-"+t+"-InitialX"],window["broadcast-live-"+t+"-CurrentY"]=e.clientY-window["broadcast-live-"+t+"-InitialY"]),window["broadcast-live-"+t+"-XOffset"]=window["broadcast-live-"+t+"-CurrentX"],window["broadcast-live-"+t+"-YOffset"]=window["broadcast-live-"+t+"-CurrentY"],n=window["broadcast-live-"+t+"-CurrentX"],e=window["broadcast-live-"+t+"-CurrentY"],document.querySelector("#broadcast_live__box-"+t).style.transform="translate3d("+n+"px, "+e+"px, 0)")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s,c=(l=p,h=[{key:"register",value:function(t){var e=document.querySelector("#chat");window["broadcast-live-"+t+"-DragActive"]=!1,window["broadcast-live-"+t+"-XOffset"]=window["broadcast-live-"+t+"-XOffset"]||0,window["broadcast-live-"+t+"-YOffset"]=window["broadcast-live-"+t+"-YOffset"]||0,e.addEventListener("touchstart",function(e){r(e,t)},!1),e.addEventListener("touchend",function(e){o(0,t)},!1),e.addEventListener("touchmove",function(e){i(e,t)},!1),e.addEventListener("mousedown",function(e){r(e,t)},!1),e.addEventListener("mouseup",function(e){o(0,t)},!1),e.addEventListener("mousemove",function(e){i(e,t)},!1)}},{key:"unregister",value:function(t){var e=document.querySelector("#chat");e.removeEventListener("touchstart",function(e){r(e,t)},!1),e.removeEventListener("touchend",function(e){o(0,t)},!1),e.removeEventListener("touchmove",function(e){i(e,t)},!1),e.removeEventListener("mousedown",r,!1),e.removeEventListener("mouseup",function(e){o(0,t)},!1),e.removeEventListener("mousemove",function(e){i(e,t)},!1)}}],(s=null)&&a(l.prototype,s),a(l,h),p),u=n(0),l=n(7),d=n.n(l);function p(){!function(e){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}(this)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l,h,n=(h=m,n=[{key:"registerEvents",value:function(e){m.onClose(e)}},{key:"onClose",value:function(n){$(".broadcast_live_box__close").unbind().on("click",function(e){var t=$(this).closest(".broadcast_live_box");m.close(n,t)})}},{key:"close",value:function(t,e,n){c.unregister(e.data("id")),e.remove();e=e.data("id");e==t.getState().mUser.id?t.getState().socket.emit("req",Object(u.f)({type:"BROADCAST_LIVE_END",data:{}}),function(e){e=Object(u.d)(e),m.destroySession(t,!0)}):n?$("#show_broadcast_live").remove():m.renderButton(t,e)}},{key:"renderButton",value:function(e,t){$("#broadcast_live_container").append("<div id='show_broadcast_live' data-id='"+t+"'><img src='/images/broadcast_live_icon.png' /></div>"),m.onShowBroadcastLiveBox(e)}},{key:"onShowBroadcastLiveBox",value:function(n){$("#show_broadcast_live").unbind("click").on("click",function(e){var t=$(this).data("id");$("#show_broadcast_live").remove(),m.render(n,t),m.init(n,!1,m.generateJanusRoomID(t))})}},{key:"getIceServers",value:function(e){return e?[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://audio.chat-host.net:2083"}},{key:"init",value:function(e,t,n){window.incomingBroadcastLiveStreams={},window.outgoingBroadcastLiveStream=null,window.janusBroadcastLiveSession=null,window.broadcastLivePluginHandle=null,window.janusBroadcastLiveUserID=m.generateJanusUserID(e.getState().socket.id),window.broadcastLiveOpaqueId="videoroomtest-"+d.a.randomString(15),window.broadcastLliveReconnectionInterval=null,window.BroadcastLiveFeeds=[],d.a.init({debug:!1,dependencies:d.a.useDefaultDependencies(),callback:function(){m.onJanusInitialized(e,t,n)},iceServers:m.getIceServers(!0)})}},{key:"onJanusInitialized",value:function(t,e,n){window.janusBroadcastLiveSession=new d.a({server:m.getJanusServer(),success:function(){m.onJanusSessionSuccess(t,janusBroadcastLiveSession,e,n)},error:function(e){"Lost connection to the server (is it down?)"==e&&m.handleServerConnectionLost(t)},destroyed:function(){m.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(e){e.getState().mUser.room&&$("#broadcast_live__box-"+e.getState().mUser.id).length&&(m.close(e,$("#broadcast_live__box-"+e.getState().mUser.id)),m.destroySession()),window.broadcastLliveReconnectionInterval=setInterval(function(){d.a.init({debug:!1,dependencies:d.a.useDefaultDependencies(),callback:function(){m.onJanusInitialized(e)},iceServers:m.getIceServers(!0)})},5e3)}},{key:"onJanusSessionSuccess",value:function(n,e,t,r){window.broadcastLliveReconnectionInterval&&(clearInterval(window.broadcastLliveReconnectionInterval),window.broadcastLliveReconnectionInterval=null),e.attach({plugin:"janus.plugin.videoroom",success:function(e){m.onJanusAttachSuccess(n,e,t,r)},error:function(e){},consentDialog:function(e){},onmessage:function(e,t){m.onJanusAttachMessage(e,t,n)},onlocalstream:function(e){m.onJanusAttachLocalStream(n,e)},onremotestream:function(e){},webrtcState:function(e){d.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusAttachSuccess",value:function(e,t,n,r){window.broadcastLivePluginHandle=t,n?m.createRoom(e):m.joinRoom(r,!0)}},{key:"onJanusAttachMessage",value:function(e,t,n){var r=e.videoroom;if(r){if("joined"===r&&e.id&&(m.isRoomOwner(n,e.room)&&window.broadcastLivePluginHandle.createOffer({media:{audioSend:!0,videoRecv:!1},success:function(e){var t={request:"configure",audio:!0,video:!0,id:n.getState().mUser.id};window.broadcastLivePluginHandle.send({message:t,jsep:e})},error:function(e){console.log(e),alert("الرجاء منح الصلاحيات للمتصفح بتصوير الشاشة"),d.a.error("WebRTC error:",e)}}),window.broadcastLivePluginHandle.send({message:{request:"publish",video:!0,audio:!0,data:!1}}),e.publishers)){var o=e.publishers;for(u in d.a.debug("Got a list of available publishers/feeds:",o),o){var i=o[u].id,a=o[u].display,s=o[u].audio_codec,c=o[u].video_codec;d.a.debug("  >> ["+i+"] "+a+" (audio: "+s+", video: "+c+")"),m.newRemoteFeed(n,i,a,s,c,e.room)}}if("created"!==r)if("destroyed"===r)d.a.warn("The room has been destroyed!");else if("roomchanged"===r)window.myJanusBroadcastLiveID=e.id;else if("event"===r)if(e.publishers)for(var u in o=e.publishers)i=o[u].id,a=o[u].display,s=o[u].audio_codec,c=o[u].video_codec,m.newRemoteFeed(n,i,a,s,c);else e.leaving||e.unpublished||e.error&&426===e.error_code&&m.createRoom(n)}t&&window.broadcastLivePluginHandle.handleRemoteJsep({jsep:t})}},{key:"newRemoteFeed",value:function(t,n,e,r,o,i){var a=null;window.janusBroadcastLiveSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.broadcastLiveOpaqueId,success:function(e){(a=e).simulcastStarted=!1,a.audioCodec=r;e={request:"join",room:i,ptype:"subscriber",feed:n,offer_video:!0,offer_data:!1};a.send({message:e})},error:function(e){d.a.error("  -- Error attaching plugin...",e)},onmessage:function(e,t){var n=e.videoroom;if(!e.error&&n&&"attached"===n){for(var r=1;r<6;r++)if(!window.BroadcastLiveFeeds[r]){(window.BroadcastLiveFeeds[r]=a).rfindex=r;break}a.rfid=e.id,a.rfdisplay=e.display}t&&a.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){d.a.debug("Got SDP!",e);var t={request:"start",room:i};a.send({message:t,jsep:e})},error:function(e){d.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){d.a.log(" WebRTC PeerConnection (feed #"+a.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(e){e.getVideoTracks().length&&m.playLocalStream(t,e,m.getJanusUserID(window.broadcastLivePluginHandle.rfdisplay))},onremotestream:function(e){m.playRemoteStream(t,e,m.getJanusUserID(a.rfdisplay))},oncleanup:function(){}})}},{key:"destroySession",value:function(e,t){window.outgoingBroadcastLiveStream&&window.outgoingBroadcastLiveStream.getTracks().forEach(function(e){return e.stop()}),window.janusBroadcastLiveSession&&window.janusBroadcastLiveSession.isConnected()&&(t?window.broadcastLivePluginHandle.send({message:{request:"destroy",room:m.generateJanusRoomID(e.getState().mUser.id)},success:function(e){"destroyed"==e.videoroom&&(window.janusBroadcastLiveSession.destroy(),m.destroyAllFeeds())}}):(window.janusBroadcastLiveSession.destroy(),m.destroyAllFeeds()))}},{key:"onJanusSessionDestroyed",value:function(e){e.getState().mUser.room&&e.getState().mUser.room.is_users_cam_enabled}},{key:"destroyAllFeeds",value:function(){window.BroadcastLiveFeeds.forEach(function(e){e.session.destroy()}),window.BroadcastLiveFeeds=[]}},{key:"isRoomOwner",value:function(e,t){return m.generateJanusRoomID(e.getState().mUser.id)==t}},{key:"generateJanusRoomID",value:function(e){e+="broacast-live";for(var t=new URL(socketIOHost),n=0,r=0;r<e.length;r++)n+=e.charCodeAt(r);return n=t.port+""+t.port*n,parseInt(n)}},{key:"getJanusUserID",value:function(e){return e.replace(new URL(socketIOHost).hostname+".","")}},{key:"joinRoom",value:function(e,t){window.broadcastLivePluginHandle&&0<e&&window.broadcastLivePluginHandle.send({message:{request:"join",ptype:"publisher",room:e,display:window.janusBroadcastLiveUserID}})}},{key:"createRoom",value:function(t){var n;window.broadcastLivePluginHandle&&(n=m.generateJanusRoomID(t.getState().mUser.id),window.broadcastLivePluginHandle.send({message:{request:"create",room:n,permanent:!1,bitrate:64e3,publishers:1,description:socketIOHost},success:function(e){"created"==e.videoroom?(m.joinRoom(e.room),t.getState().socket.emit("req",Object(u.f)({type:"BROADCAST_LIVE_PUBLISH",data:{}}),function(e){})):"event"==e.videoroom&&e.error&&427==e.error_code&&m.joinRoom(n)}}))}},{key:"onJanusAttachLocalStream",value:function(e,t){(window.outgoingBroadcastLiveStream=t).getVideoTracks().length&&m.playLocalStream(e,t)}},{key:"playLocalStream",value:function(e,t){window.outgoingBroadcastLiveStream=t;var n=document.querySelector("#broadcast_live__box-"+e.getState().mUser.id+" video");if("srcObject"in n)try{n.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;n.src=URL.createObjectURL(t)}else n.src=URL.createObjectURL(t);n.onloadedmetadata=function(e){n.paused&&n.play(),n.muted=!1}}},{key:"playRemoteStream",value:function(e,t,n){window.incomingBroadcastLiveStreams[n]=t;var r=document.querySelector("#broadcast_live__box-"+n+" video");if("srcObject"in r)try{r.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;r.src=URL.createObjectURL(t)}else r.src=URL.createObjectURL(t);r.onloadedmetadata=function(e){r.paused&&r.play(),r.muted=!1}}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"generateJanusUserID",value:function(e){return new URL(socketIOHost).hostname+"."+e}},{key:"render",value:function(e,t){var n="<div class='broadcast_live_box' id='broadcast_live__box-"+t+"' data-id='"+t+"'>";n+="<header class='broadcast_live_box__header label label-primary'>",n+="<span class='broadcast_live_box__title'>بث مباشر</span>",n+="<button data-id='"+t+"' class='broadcast_live_box__close fa fa-close btn btn-danger'></button>",n+="</header>",n+="<div class='broadcast_live_box__body fl'>",n+="<video autoplay muted controls></video>",n+="</div>",n+="</div>",$("#broadcast_live_container").append(n),m.registerEvents(e),c.register(t)}}],(l=null)&&f(h.prototype,l),f(h,n),m);function m(){!function(e){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this)}t.a=n},function(e,t,n){var r=n(151),o=n(152),n=o;n.v1=r,n.v4=o,e.exports=n},function(e,t,n){var r,l,o,i,a;e.exports=(a=n(5),n(59),n(60),e=(o=(r=a).lib).Base,l=o.WordArray,o=(n=r.algo).MD5,i=n.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),o=l.create(),i=o.words,a=n.keySize,s=n.iterations;i.length<a;){c&&r.update(c);var c=r.update(e).finalize(t);r.reset();for(var u=1;u<s;u++)c=r.finalize(c),r.reset();o.concat(c)}return o.sigBytes=4*a,o}}),r.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)},a.EvpKDF)},function(e,t,n){"use strict";var o=n(0),i=n(6),r=n(9),a=n(20);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c,u,u=(c=l,u=[{key:"registerEvents",value:function(e){l.getProfile(e),l.photoClicked(),l.youtubeVideoClicked()}},{key:"updateUser",value:function(t,e){var n;e.getState().currentConversation&&(!(n=e.getState().users.filter(function(e){return e.id==t})[0])||(e=$(".private_message[data-user-id='"+t+"']"))&&(e.find(".private_message__avatar img").attr("src",n.avatar),e.find(".private_message__title").html(i.a.render(n)),e.find(".private_message__body").css("color",n.fontColor)))}},{key:"getProfile",value:function(n){$("#chat_box .private_message .private_message__avatar img").unbind("click").on("click",function(e){var t=$(this).closest(".private_message").data("user-id");a.a.show(t,n)})}},{key:"getBaseDir",value:function(){return"/uploads/private/"}},{key:"photoClicked",value:function(){$(".private_message__body__image").unbind("click").on("click",function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()})}},{key:"youtubeVideoClicked",value:function(){$(".private_message .yt-btn").unbind("click").on("click",function(e){e.stopPropagation();try{var t=$(this).data("msg-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",t=document.getElementById("yt-btn-"+t);t&&(t.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),t.remove())}catch(e){}})}},{key:"renderMessageBody",value:function(e,t){switch(e.type){case"text":return r.a.render(e.body,t);case"photo":return"<img src='"+l.getBaseDir()+e.body+"' alt='' class='private_message__body__image private_message__body__media' />";case"sound":return"<audio controls class='private_message__body__media'><source src='"+l.getBaseDir()+e.body+"' /></audio>";case"video":return"<video controls class='private_message__body__media'><source src='"+l.getBaseDir()+e.body+"' /></video>";case"youtube":return"<button id='yt-btn-"+e.id+"' class='yt-btn' data-msg-id='"+e.id+"' data-yid='"+e.body+"'><img src='images/youtube.png'/><img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+e.body+"/0.jpg' /></button>";default:return""}}},{key:"render",value:function(e,t,n){var r="<div class='private_message "+(t.id==n.getState().mUser.id?"mine":"")+" "+(e.read?"read":"")+" linen' data-user-id='"+t.id+"'>";return r+="<p class='private_message__avatar'><img class='radius' width='28' height='28' src='"+t.avatar+"' /></p>",r+="<div>",r+="<h5 class='private_message__title'>",r+=i.a.render(t),r+="</h5>",r+="<h5 class='private_message__body' style='color: "+t.fontColor+"'>",r+=l.renderMessageBody(e,n),r+="</h5>",r+="</div>",r+="<img class='private_message__check' src='/images/tick.png' />",r+="<img class='private_message__dbl_check' src='/images/tick.png' />",r+="<span class='private_message__time fr time' data-time='"+e.time+"'>"+Object(o.q)(e.time)+"</span>",(r+="<div class='clear'></div>")+"</div>"}}],(n=null)&&s(c.prototype,n),s(c,u),l);function l(){!function(e){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this)}t.a=u},function(e,t,n){var c;e.exports=(n=n(5),c=n.lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var i=n.charAt(64);return!i||-1!==(i=e.indexOf(i))&&(t=i),function(e,t,n){for(var r,o,i=[],a=0,s=0;s<t;s++)s%4&&(r=n[e.charCodeAt(s-1)]<<s%4*2,o=n[e.charCodeAt(s)]>>>6-s%4*2,i[a>>>2]|=(r|o)<<24-a%4*8,a++);return c.create(i,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)},function(e,t,n){var o;e.exports=(o=n(5),function(c){var e=o,t=e.lib,n=t.WordArray,r=t.Hasher,t=e.algo,T=[];!function(){for(var e=0;e<64;e++)T[e]=4294967296*c.abs(c.sin(e+1))|0}();t=t.MD5=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],s=e[t+1],c=e[t+2],u=e[t+3],l=e[t+4],d=e[t+5],p=e[t+6],f=e[t+7],h=e[t+8],m=e[t+9],_=e[t+10],g=e[t+11],v=e[t+12],y=e[t+13],b=e[t+14],w=e[t+15],S=O(S=i[0],E=i[1],C=i[2],k=i[3],a,7,T[0]),k=O(k,S,E,C,s,12,T[1]),C=O(C,k,S,E,c,17,T[2]),E=O(E,C,k,S,u,22,T[3]);S=O(S,E,C,k,l,7,T[4]),k=O(k,S,E,C,d,12,T[5]),C=O(C,k,S,E,p,17,T[6]),E=O(E,C,k,S,f,22,T[7]),S=O(S,E,C,k,h,7,T[8]),k=O(k,S,E,C,m,12,T[9]),C=O(C,k,S,E,_,17,T[10]),E=O(E,C,k,S,g,22,T[11]),S=O(S,E,C,k,v,7,T[12]),k=O(k,S,E,C,y,12,T[13]),C=O(C,k,S,E,b,17,T[14]),S=P(S,E=O(E,C,k,S,w,22,T[15]),C,k,s,5,T[16]),k=P(k,S,E,C,p,9,T[17]),C=P(C,k,S,E,g,14,T[18]),E=P(E,C,k,S,a,20,T[19]),S=P(S,E,C,k,d,5,T[20]),k=P(k,S,E,C,_,9,T[21]),C=P(C,k,S,E,w,14,T[22]),E=P(E,C,k,S,l,20,T[23]),S=P(S,E,C,k,m,5,T[24]),k=P(k,S,E,C,b,9,T[25]),C=P(C,k,S,E,u,14,T[26]),E=P(E,C,k,S,h,20,T[27]),S=P(S,E,C,k,y,5,T[28]),k=P(k,S,E,C,c,9,T[29]),C=P(C,k,S,E,f,14,T[30]),S=A(S,E=P(E,C,k,S,v,20,T[31]),C,k,d,4,T[32]),k=A(k,S,E,C,h,11,T[33]),C=A(C,k,S,E,g,16,T[34]),E=A(E,C,k,S,b,23,T[35]),S=A(S,E,C,k,s,4,T[36]),k=A(k,S,E,C,l,11,T[37]),C=A(C,k,S,E,f,16,T[38]),E=A(E,C,k,S,_,23,T[39]),S=A(S,E,C,k,y,4,T[40]),k=A(k,S,E,C,a,11,T[41]),C=A(C,k,S,E,u,16,T[42]),E=A(E,C,k,S,p,23,T[43]),S=A(S,E,C,k,m,4,T[44]),k=A(k,S,E,C,v,11,T[45]),C=A(C,k,S,E,w,16,T[46]),S=R(S,E=A(E,C,k,S,c,23,T[47]),C,k,a,6,T[48]),k=R(k,S,E,C,f,10,T[49]),C=R(C,k,S,E,b,15,T[50]),E=R(E,C,k,S,d,21,T[51]),S=R(S,E,C,k,v,6,T[52]),k=R(k,S,E,C,u,10,T[53]),C=R(C,k,S,E,_,15,T[54]),E=R(E,C,k,S,s,21,T[55]),S=R(S,E,C,k,h,6,T[56]),k=R(k,S,E,C,w,10,T[57]),C=R(C,k,S,E,p,15,T[58]),E=R(E,C,k,S,y,21,T[59]),S=R(S,E,C,k,l,6,T[60]),k=R(k,S,E,C,g,10,T[61]),C=R(C,k,S,E,c,15,T[62]),E=R(E,C,k,S,m,21,T[63]),i[0]=i[0]+S|0,i[1]=i[1]+E|0,i[2]=i[2]+C|0,i[3]=i[3]+k|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32;var o=c.floor(n/4294967296),n=n;t[15+(64+r>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t[14+(64+r>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var t=this._hash,i=t.words,a=0;a<4;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return t},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function O(e,t,n,r,o,i,a){a=e+(t&n|~t&r)+o+a;return(a<<i|a>>>32-i)+t}function P(e,t,n,r,o,i,a){a=e+(t&r|n&~r)+o+a;return(a<<i|a>>>32-i)+t}function A(e,t,n,r,o,i,a){a=e+(t^n^r)+o+a;return(a<<i|a>>>32-i)+t}function R(e,t,n,r,o,i,a){a=e+(n^(t|~r))+o+a;return(a<<i|a>>>32-i)+t}e.MD5=r._createHelper(t),e.HmacMD5=r._createHmacHelper(t)}(Math),o.MD5)},function(e,p,t){var r,n=t(165),i=t(85),f=t(167),a=t(168),o=t(169);"undefined"!=typeof ArrayBuffer&&(r=t(170));var s="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),u=s||c;p.protocol=3;var l=p.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=n(l),h={type:"error",data:"parser error"},m=t(171);function _(e,t,n){for(var o=new Array(e.length),r=a(e.length,n),i=0;i<e.length;i++)!function(n,e,r){t(e,function(e,t){o[n]=t,r(e,o)})}(i,e[i],r)}p.encodePacket=function(e,a,t,n){"function"==typeof a&&(n=a,a=!1),"function"==typeof t&&(n=t,t=null);var r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(e,t){if(!a)return p.encodeBase64Packet(e,t);var n=e.data,r=new Uint8Array(n),o=new Uint8Array(1+n.byteLength);o[0]=l[e.type];for(var i=0;i<r.length;i++)o[i+1]=r[i];return t(o.buffer)}(e,n);if(void 0!==m&&r instanceof m)return function(e,t,n){if(!t)return p.encodeBase64Packet(e,n);if(u)return function(e,t,n){if(!t)return p.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){p.encodePacket({type:e.type,data:r.result},t,!0,n)},r.readAsArrayBuffer(e.data)}(e,t,n);t=new Uint8Array(1);return t[0]=l[e.type],n(new m([t.buffer,e.data]))}(e,a,n);if(r&&r.base64)return n("b"+p.packets[e.type]+e.data.data);r=l[e.type];return void 0!==e.data&&(r+=t?o.encode(String(e.data),{strict:!1}):String(e.data)),n(""+r)},p.encodeBase64Packet=function(t,n){var r,o="b"+p.packets[t.type];if(void 0!==m&&t.data instanceof m){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var a=new Uint8Array(t.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},p.decodePacket=function(e,t,n){if(void 0===e)return h;if("string"==typeof e){if("b"===e.charAt(0))return p.decodeBase64Packet(e.substr(1),t);if(n&&!1===(e=function(e){try{e=o.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return h;var r=e.charAt(0);return Number(r)==r&&d[r]?1<e.length?{type:d[r],data:e.substring(1)}:{type:d[r]}:h}r=new Uint8Array(e)[0];e=f(e,1);return m&&"blob"===t&&(e=new m([e])),{type:d[r],data:e}},p.decodeBase64Packet=function(e,t){var n=d[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};e=r.decode(e.substr(1));return"blob"===t&&m&&(e=new m([e])),{type:n,data:e}},p.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=i(e);return n&&o?m&&!u?p.encodePayloadAsBlob(e,r):p.encodePayloadAsArrayBuffer(e,r):e.length?void _(e,function(e,t){p.encodePacket(e,!!o&&n,!1,function(e){t(null,e.length+":"+e)})},function(e,t){return r(t.join(""))}):r("0:")},p.decodePayload=function(e,t,n){if("string"!=typeof e)return p.decodePayloadAsBinary(e,t,n);if("function"==typeof t&&(n=t,t=null),""===e)return n(h,0,1);for(var r,o,i="",a=0,s=e.length;a<s;a++){var c=e.charAt(a);if(":"===c){if(""===i||i!=(r=Number(i)))return n(h,0,1);if(i!=(o=e.substr(a+1,r)).length)return n(h,0,1);if(o.length){if(o=p.decodePacket(o,t,!1),h.type===o.type&&h.data===o.data)return n(h,0,1);if(!1===n(o,a+r,s))return}a+=r,i=""}else i+=c}return""!==i?n(h,0,1):void 0},p.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));_(e,function(e,t){p.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.reduce(function(e,t){return e+(t="string"==typeof t?t.length:t.byteLength).toString().length+t+2},0),a=new Uint8Array(n),s=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}a[s++]=t?0:1;for(var i=n.byteLength.toString(),o=0;o<i.length;o++)a[s++]=parseInt(i[o]);for(a[s++]=255,r=new Uint8Array(n),o=0;o<r.length;o++)a[s++]=r[o]}),r(a.buffer)})},p.encodePayloadAsBlob=function(e,n){_(e,function(e,a){p.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);e=n.buffer,t[0]=0}for(var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(o.length+1),r=0;r<o.length;r++)i[r]=parseInt(o[r]);i[o.length]=255,m&&(t=new m([t.buffer,i.buffer,e]),a(null,t))})},function(e,t){return n(new m(t))})},p.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var t=e,o=[];0<t.byteLength;){for(var i=new Uint8Array(t),a=0===i[0],s="",c=1;255!==i[c];c++){if(310<s.length)return r(h,0,1);s+=i[c]}t=f(t,2+s.length),s=parseInt(s);var u=f(t,0,s);if(a)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){for(var l=new Uint8Array(u),u="",c=0;c<l.length;c++)u+=String.fromCharCode(l[c])}o.push(u),t=f(t,s)}var d=o.length;o.forEach(function(e,t){r(p.decodePacket(e,n,!0),t,d)})}},function(e,t,n){e.exports=n(133)},function(e,t,n){"use strict";var o=n(0),r=n(14),i=n(10),a=n(1),s=n(6),c=n(18),u=n(20),l=n(9),d=n(3);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=(g=h,_=[{key:"registerEvents",value:function(e){h.onClick(e),h.trustUser(e)}},{key:"onClick",value:function(n){$(".notification").unbind("click").on("click",function(e){var t=$(this).closest(".notification").data("user-id");u.a.show(t,n)})}},{key:"trustUser",value:function(n){$(".notification__message__body__trust_user").unbind("click").on("click",function(e){var t=this;e.stopPropagation(),n.getState().socket.emit("req",Object(o.f)({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),function(e){return e=Object(o.d)(e),$(t).closest(".popup").click(),"string"==typeof e?alert(e):(e&&e.message&&alert(e.message),void(e.error||(e=$(t).data("user-id"),n.dispatch(Object(d.c)(e)),$("button[data-user-id='"+e+"']").remove())))})})}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+c.a.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='notification__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='notification__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"photo_like":return;default:return"<span>"+l.a.render(e.message,t)+"</span>"}}},{key:"render",value:function(e,t){var n=e.user?e.user.id:"",r=e.id,n="<div data-id='"+e.id+"' data-user-id='"+n+"' class='notification'>";return n+="<p class='notification__title label label-primary'>"+e.title+"</p>",e.user&&(n+="<div class='notification__sender'>",n+="<img src='"+e.user.avatar+"' width='24' height='24' class='notification__sender__avatar' />",n+="<p class='notification__sender__name'>"+s.a.render(e.user)+"</p>",n+="</div>"),n+="<div class='notification__message'>",n+=h.renderMessage(e,t),n+="</div>",(n+="<span class='notification__time fr time' data-time='"+r+"'>"+Object(o.q)(r)+"</span>")+"</div>"}}],(n=null)&&p(g.prototype,n),p(g,_),h);function h(){!function(e){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function")}(this)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _,g,g=(n=v,g=[{key:"registerEvents",value:function(e){v.close(e)}},{key:"close",value:function(t){$(".chat__body__notifications-pane__back button").unbind("click").on("click",function(e){t.dispatch(Object(i.a)("settings")),a.a.togglePane(t)})}},{key:"setNotifications",value:function(t){var n=$("#chat__body__notifications-pane .chat_pane__container");n.html(""),t.getState().popups.forEach(function(e){n.prepend(f.render(e,t))}),f.registerEvents(t)}},{key:"render",value:function(e){e="<div id='chat__body__notifications-pane' class='chat_pane' style='background: "+Object(o.n)(e.getState().settings,!0)+"'>";return e+=r.a.render("الإشعارات"),e+="<p class='chat__body__notifications-pane__back'>",e+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",e+="</p>",(e+="<div class='chat_pane__container border'></div>")+"</div>"}}],(_=null)&&m(n.prototype,_),m(n,g),v);function v(){!function(e){if(!(e instanceof v))throw new TypeError("Cannot call a class as a function")}(this)}t.a=g},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"SET_CURRENT_CALL",currentCall:0<arguments.length&&void 0!==arguments[0]?arguments[0]:null}}},function(e,t,n){"use strict";var r=n(29),o=n(0),i=n(17);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s,c,c=(s=u,c=[{key:"registerEvents",value:function(e){u.onHide(e),u.onCancel(e),u.onAccept(e),window.peer.on("call",function(e){window.incomingCall=e,window.incomingCall.on("close",function(){window.incomingCall=null})})}},{key:"close",value:function(){$("#call_container").html("");try{window.incomingCall&&(window.incomingCall.close(),window.incomingCall=null)}catch(e){}try{window.outgoinCall&&(window.outgoinCall.close(),window.outgoinCall=null)}catch(e){}window.outgoinStream=null,window.callsAudio.src=null,window.callsAudio.srcObject=null}},{key:"onHide",value:function(t){$("#call-dialog-footer__hide").unbind("click").on("click",function(e){t.dispatch(Object(r.a)(!1)),$("#call-dialog").hide()})}},{key:"onAccept",value:function(t){$("#call-dialog-footer__accept").unbind("click").on("click",function(e){t.getState().socket.emit("req",Object(o.f)({type:"CALL_REQUEST_ACCEPT",data:{id:t.getState().currentCall.user.id}}),function(e){u.acceptCall(t,t.getState().currentCall.user),$("#call-dialog-footer__accept, #call-dialog__status").hide(),$("#call-dialog__status_start_call").show()})})}},{key:"onCallAccepted",value:function(){$("#call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}},{key:"onCancel",value:function(t){$("#call-dialog-footer__cancel").unbind("click").on("click",function(e){t.getState().socket.emit("req",Object(o.f)({type:"CALL_REQUEST_CANCEL",data:{id:t.getState().currentCall.user.id}}),function(e){u.cancelCall(t),u.close(),t.dispatch(Object(r.a)(!1))})})}},{key:"acceptCall",value:function(e,t){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){window.incomingCall.answer(e),window.incomingCall.on("stream",function(e){i.a.playStream(e)})},function(e){alert(e.stack),console.log("Failed to get local stream",e)})}},{key:"cancelCall",value:function(e){e.getState().webrtc&&(e.getState().webrtc.leaveRoom(),e.getState().webrtc.stopLocalVideo(),u.close())}},{key:"render",value:function(e,t){var n="<div id='call-dialog' style='display: "+(e.getState().isCallDialogOpen?"block":"none")+"'>";n+="<p class='target-user-name'>"+t.user.username+"</p>",n+="<img class='target-user-avatar' src='"+t.user.avatar+"' alt='' />",n+="<p id='call-dialog__status_start_call' class='call-status success'>بدأ المكالمة</p>",n+="<p id='call-dialog__status' class='call-status "+t.statusClass+"'>"+t.status+"</p>",n+="<p class='call-dialog-footer'>",n+="<button id='call-dialog-footer__cancel' class='btn btn-danger call-cancel'><i class='fa fa-phone'></i>إلغاء</button>","call-received"==t.dialogType&&(n+="<button id='call-dialog-footer__accept' class='btn btn-success call-accept'><i class='fa fa-phone'></i>قبول</button>"),n+="<button id='call-dialog-footer__hide' class='btn btn-warning pull-right call-dialog-hide'><i class='fa fa-minus'></i>إخفاء</button>",n+="</p>",n+="</div>",$("#call_container").append(n),u.registerEvents(e)}}],(n=null)&&a(s.prototype,n),a(s,c),u);function u(){!function(e){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this)}t.a=c},function(e,t,n){"use strict";var r=n(26),o=n(22),i=n(56),a=n(0),s=n(6),c=n(9);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d,p,p=(d=f,p=[{key:"registerEvents",value:function(e){f.sendComment(e),f.openFacePicker(e),f.onRemove(e),f.onLike(e)}},{key:"openFacePicker",value:function(t){$("#wall_comments__attach__face").unbind("click").on("click",function(e){t.dispatch(Object(i.a)(!0)),o.a.onSelect()})}},{key:"onRemove",value:function(n){$("#wall_comments .wall_comments__comment__remove").unbind("click").on("click",function(e){var t=e.target.dataset.id,e=e.target.dataset.postId;n.getState().socket.emit("req",Object(a.f)({type:"WALL_POST_COMMENT_REMOVE",data:{id:t,postId:e}}),function(e){if("string"==typeof(e=Object(a.d)(e)))return alert(e)})})}},{key:"onLike",value:function(n){$("#wall_comments .wall_comments__comment__like").unbind("click").on("click",function(e){var t=e.target.dataset.id;n.getState().socket.emit("req",Object(a.f)({type:"WALL_POST_COMMENT_LIKE",data:{id:t}}),function(e){return"string"==typeof(e=Object(a.d)(e))?alert(e):void("object"==u(e)&&!1===e.error&&f.incCommentLikes(t))})})}},{key:"incCommentLikes",value:function(e){var t=$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text(),t=parseInt(t)+1;$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text(t)}},{key:"scrollToBottom",value:function(){var e=document.getElementById("wall_comments__scroll_area");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"setComments",value:function(e,t){var n=$("#wall_comments .wall_comments__body");n.html(""),e.forEach(function(e){n.append(f.renderPostComment(e,t))}),setTimeout(function(){f.scrollToBottom(),f.registerEvents(t)},500)}},{key:"renderPostComment",value:function(t,e){var n=e.getState().posts.filter(function(e){return e.id==t.postId})[0],r="<div class='wall_comments__comment' data-id='"+t.id+"' >";return r+="<p class='wall_comments__comment__avatar'>",r+="<img class='radius border border-color' width='30' height='30' src='"+t.user.avatar+"' />",r+="</p>",r+="<div>",r+="<h5 class='wall_comments__comment__title'>",r+=s.a.render(t.user),r+="</h5>",r+="<h5 class='wall_comments__comment__content'>",r+=c.a.render(t.comment,e),r+="</h5>",r+="</div>",r+="<button data-id='"+t.id+"' class='wall_comments__comment__like fl btn btn-danger fa fa-heart'>"+t.likes+"</button>",n.user.reg_id!=e.getState().mUser.reg_id&&t.user.reg_id!=e.getState().mUser.reg_id||(r+="<button data-id='"+t.id+"' data-post-id='"+t.postId+"' class='wall_comments__comment__remove fl btn btn-danger fa fa-remove'></button>"),r+="<span class='wall_comments__comment__time fr time' data-time='"+t.time+"'>"+Object(a.q)(t.time)+"</span>",(r+="<div class='clear'></div>")+"</div>"}},{key:"sendComment",value:function(r){$("#wall_comments form").unbind("submit").on("submit",function(e){e.preventDefault();var t=$(this).data("post-id"),n=e.target.comment,e=n.value.trim();e&&"disabled"!=$("#wall_comments__form__submit").attr("disabled")&&($("#wall_comments__form__submit").attr("disabled","disabled"),r.getState().socket.emit("req",Object(a.f)({type:"ADD_WALL_POST_COMMENT",data:{post_id:t,text:e}}),function(e){if($("#wall_comments__form__submit").removeAttr("disabled"),n&&(n.value=""),"string"==typeof(e=Object(a.d)(e)))return alert(e)}))})}},{key:"getPostComments",value:function(e,t){t.getState().socket.emit("req",Object(a.f)({type:"WALL_GET_POST_COMMENTS",data:{post_id:e.id}}),function(e){f.setComments(Object(a.d)(e),t)})}},{key:"add",value:function(e,t){var n=$("#wall_comments");n&&n.hasClass("show")&&t.getState().wallCommentsPost&&t.getState().wallCommentsPost.id==e.postId&&($("#wall_comments .wall_comments__body").append(f.renderPostComment(e,t)),f.scrollToBottom(),f.registerEvents(t))}},{key:"remove",value:function(e){$("#wall_comments").hasClass("show")&&$("#wall_comments .wall_comments__comment[data-id='"+e+"']").remove()}},{key:"render",value:function(e,t){var n="<div class='modal fade' id='wall_comments' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document' style='max-width: 345px'>",n+="<div class='modal-content'>",n+="<div class='wall_comments__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<img class='wall_comments__header__avatar' width='25' height='25' src='"+e.user.avatar+"' alt=''/>",n+="<p class='wall_comments__header__name ellipsis'>",n+=e.user.icon?"<img src='"+e.user.icon+"' class='username__icon fl' style='max-height: 16px' />":"",n+="<span style='vertical-align: middle; font-size: 0.7rem; display: inline-block; margin-left: 2px'>"+e.user.name+"</span>",n+="</p>",n+="<button data-dismiss='modal' class='btn btn-danger wall_comments__header__close'>&times;</button>",n+="</div><div class='clear'></div>",n+="</div>",n+="<div class='wall_comments__post_body_area'>",n+="<h5 style='color: "+e.user.fontColor+"' class='wall_post__body'>",n+=r.a.renderPostBody(e,t),n+="</h5>",n+="</div>",n+="<div class='wall_comments__scroll_area' id='wall_comments__scroll_area'>",n+="<div class='wall_comments__body modal-body'></div>",n+="</div>",n+="<form class='wall_comments__form' data-post-id='"+e.id+"'>",n+="<img class='wall_comments__form__face' src='/images/smile.gif' alt='smile' id='wall_comments__attach__face' width='22' height='22'/>",n+="<input type='text' id='wall_comments__form__input' class='border-color wall_comments__form__input' name='comment' placeholder='أكتب تعليقك هنا' autoComplete='off' dir='rtl'/>",n+="<button id='wall_comments__form__submit' class='border-color fa fa-send btn btn-primary wall_comments__form__send'>إرسال</button>",n+=o.a.render("wall-comments","#wall_comments__form__input",t),n+="</form>",n+="</div>",n+="</div>",n+="</div>",$("#wall_comments_container").html(n),f.getPostComments(e,t),f.registerEvents(t)}}],(n=null)&&l(d.prototype,n),l(d,p),f);function f(){!function(e){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this)}t.a=p},function(n,o,r){(function(t){function e(){var e;try{e=o.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(o=n.exports=r(155)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},o.formatArgs=function(e){var t,n,r=this.useColors;e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+o.humanize(this.diff),r&&(r="color: "+this.color,e.splice(1,0,r,"color: inherit"),e[n=t=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e&&(n=t))}),e.splice(n,0,r))},o.save=function(e){try{null==e?o.storage.removeItem("debug"):o.storage.debug=e}catch(e){}},o.load=e,o.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},o.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},o.enable(e())}).call(this,r(62))},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}(e.exports=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var o,i;e.exports=(n=(e=n(5)).lib,o=n.Base,i=n.WordArray,(n=e.x64={}).Word=o.extend({init:function(e,t){this.high=e,this.low=t}}),n.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=o.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),e)},function(e,t,n){"use strict";var o,r,i,a=n(125),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function c(){i=!1}function u(e){if(e){if(e!==o){if(e.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter(function(e,t,n){return t!==n.lastIndexOf(e)});if(t.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+t.join(", "));o=e,c()}}else o!==s&&(o=s,c())}function l(){return i=i||function(){o||u(s);for(var e,t=o.split(""),n=[],r=a.nextValue();0<t.length;)r=a.nextValue(),e=Math.floor(r*t.length),n.push(t.splice(e,1)[0]);return n.join("")}()}e.exports={get:function(){return o||s},characters:function(e){return u(e),o},seed:function(e){a.seed(e),r!==e&&(c(),r=e)},lookup:function(e){return l()[e]},shuffled:l}},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){t.encode=function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n.length&&(n+="&"),n+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(n,o,r){(function(t){function e(){var e;try{e=o.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(o=n.exports=r(172)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},o.formatArgs=function(e){var t,n,r=this.useColors;e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+o.humanize(this.diff),r&&(r="color: "+this.color,e.splice(1,0,r,"color: inherit"),e[n=t=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e&&(n=t))}),e.splice(n,0,r))},o.save=function(e){try{null==e?o.storage.removeItem("debug"):o.storage.debug=e}catch(e){}},o.load=e,o.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},o.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},o.enable(e())}).call(this,r(62))},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER",isPublicMessagesFacePickerOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER",isPrivateMessagesFacePickerOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"TOGGLE_WALL_COMMENTS_FACE_PICKER",isWallCommentsFacePickerOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{type:"TOGGLE_WALL_FACE_PICKER",isWallFacePickerOpen:0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}},function(e,t,n){"use strict";var i=n(0),r=n(14);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,s,s=(a=c,s=[{key:"registerEvents",value:function(e){}},{key:"fetchPosts",value:function(e){e.getState().socket.emit("req",Object(i.f)({type:"WALL_CREATOR_GET_POSTS",data:{}}),function(e){e=Object(i.d)(e);var n=$(".chat_pane__container__podium-users"),r=$(".chat_pane__container__podium-grades"),o=$("#chat__body__wall_creator_pane .chat_pane__container__posts"),t=e.slice(0,3),e=e.slice(3);t.forEach(function(e,t){e.avatar&&n.find(".chat_pane__container__podium-user.grade-"+(t+1)+" .avatar").attr("src","/uploads/avatars/sm/"+e.avatar),e.decoration=e.decoration||e.name,n.find(".chat_pane__container__podium-user.grade-"+(t+1)+" .name").text(e.decoration),r.find(".chat_pane__container__podium-grade.grade-"+(t+1)+" .rank").text(e["count( wall.user_id )"])}),o.html(""),e.forEach(function(e,t){e.decoration=e.decoration||e.name;var n="/images/none.png";e.avatar&&(n="/uploads/avatars/sm/"+e.avatar),o.append("<div class='chat_pane__container__post'><span class='grade'>"+(t+4)+"</span><img class='avatar' width='40' height='40' src='"+n+"' /><span class='name'>"+e.decoration+"</span><span class='rank'>"+e["count( wall.user_id )"]+"</span></div>")})})}},{key:"setPosts",value:function(e){c.fetchPosts(e)}},{key:"render",value:function(e){e="<div id='chat__body__wall_creator_pane' class='chat_pane' style='background: "+Object(i.n)(e.getState().settings,!0)+"'>";return e+=r.a.render("مبدع الحائط",!0),e+="<div class='chat_pane__container border'>",e+="<div class='chat_pane__container__podium'>",e+="<div class='chat_pane__container__podium-users'>",e+="<span class='chat_pane__container__podium-user grade-2'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/silver_grade.png' /><span class='name'></span></span>",e+="<span class='chat_pane__container__podium-user grade-1'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/gold_grade.png' /><img class='crown' width='40' height='40' src='/images/crown.png' /><span class='name'></span></span>",e+="<span class='chat_pane__container__podium-user grade-3'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/bronz_grade.png' /><span class='name'></span></span>",e+="</div>",e+="<div class='chat_pane__container__podium-grades'>",e+="<span class='chat_pane__container__podium-grade  grade-2'><span class='grade'>2</span><span class='rank'>0</span></span>",e+="<span class='chat_pane__container__podium-grade  grade-1'><span class='grade'>1</span><span class='rank'>0</span></span>",e+="<span class='chat_pane__container__podium-grade  grade-3'><span class='grade'>3</span><span class='rank'>0</span></span>",e+="</div>",e+="</div>",e+="<div class='chat_pane__container__posts'></div>",(e+="</div>")+"</div>"}}],(n=null)&&o(a.prototype,n),o(a,s),c);function c(){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this)}t.a=s},function(e,t,n){var r,o,l,i;e.exports=(n=(e=i=n(5)).lib,r=n.WordArray,o=n.Hasher,n=e.algo,l=[],n=n.SHA1=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],c=0;c<80;c++){c<16?l[c]=0|e[t+c]:(u=l[c-3]^l[c-8]^l[c-14]^l[c-16],l[c]=u<<1|u>>>31);var u=(r<<5|r>>>27)+s+l[c];u+=c<20?1518500249+(o&i|~o&a):c<40?1859775393+(o^i^a):c<60?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,s=a,a=i,i=o<<30|o>>>2,o=r,r=u}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),t[15+(64+r>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=o._createHelper(n),e.HmacSHA1=o._createHmacHelper(n),i.SHA1)},function(e,t,n){var s;e.exports=(n=(e=n(5)).lib.Base,s=e.enc.Utf8,void(e.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var e=this._oKey=t.clone(),t=this._iKey=t.clone(),o=e.words,i=t.words,a=0;a<n;a++)o[a]^=1549556828,i[a]^=909522486;e.sigBytes=t.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,e=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(e))}})))},function(s,e,c){"use strict";(function(e){var n=c(24),r=c(136),t={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i,a={adapter:("undefined"==typeof XMLHttpRequest&&void 0===e||(i=c(72)),i),transformRequest:[function(e,t){return r(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(e){a.headers[e]={}}),n.forEach(["post","put","patch"],function(e){a.headers[e]=n.merge(t)}),s.exports=a}).call(this,c(62))},function(e,t){var n,r,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var s,c=[],u=!1,l=-1;function d(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&p())}function p(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function h(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=h,e.addListener=h,e.once=h,e.off=h,e.removeListener=h,e.removeAllListeners=h,e.emit=h,e.prependListener=h,e.prependOnceListener=h,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,a,t){var s=t(46)("socket.io-parser"),n=t(156),r=t(157),c=t(80),o=t(81);function i(){}a.protocol=4,a.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],a.CONNECT=0,a.DISCONNECT=1,a.EVENT=2,a.ACK=3,a.ERROR=4,a.BINARY_EVENT=5,a.BINARY_ACK=6,a.Encoder=i,a.Decoder=d;var u=a.ERROR+'"encode error"';function l(e){var t=""+e.type;if(a.BINARY_EVENT!==e.type&&a.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===n)return u;t+=n}return s("encoded %j as %s",e,t),t}function d(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:a.ERROR,data:"parser error: "+e}}i.prototype.encode=function(e,t){var n;s("encoding packet %j",e),a.BINARY_EVENT===e.type||a.BINARY_ACK===e.type?(n=t,r.removeBlobs(e,function(e){var t=r.deconstructPacket(e),e=l(t.packet),t=t.buffers;t.unshift(e),n(t)})):t([l(e)])},n(d.prototype),d.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t=0,n={type:Number(e.charAt(0))};if(null==a.types[n.type])return f("unknown packet type "+n.type);if(a.BINARY_EVENT===n.type||a.BINARY_ACK===n.type){for(var r="";"-"!==e.charAt(++t)&&(r+=e.charAt(t),t!=e.length););if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1))for(n.nsp="";++t&&","!==(o=e.charAt(t))&&(n.nsp+=o,t!==e.length););else n.nsp="/";var o,i=e.charAt(t+1);if(""!==i&&Number(i)==i){for(n.id="";++t;){if(null==(o=e.charAt(t))||Number(o)!=o){--t;break}if(n.id+=e.charAt(t),t===e.length)break}n.id=Number(n.id)}if(e.charAt(++t)){i=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!1===i||n.type!==a.ERROR&&!c(i))return f("invalid payload");n.data=i}return s("decoded %s as %j",e,n),n}(e),a.BINARY_EVENT===t.type||a.BINARY_ACK===t.type?(this.reconstructor=new p(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!o(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length!==this.reconPack.attachments)return null;e=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,R,x){"use strict";(function(e){var s=x(158),i=x(159),a=x(160);function n(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,n){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,n);if("number"!=typeof e)return r(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}function r(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=l(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!d.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),n=(e=o(e,r)).write(t,n);return n!==r&&(e=e.slice(0,n)),e}(e,t,n):function(e,t){if(d.isBuffer(t)){var n=0|p(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?o(e,0):l(e,t);if("Buffer"===t.type&&a(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(c(t),e=o(e,t<0?0:0|p(t)),!d.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function l(e,t){var n=t.length<0?0:0|p(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(e).length;default:if(r)return O(e).length;t=(""+t).toLowerCase(),r=!0}}function t(e,t,n){var r,o,i,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var o="",i=t;i<n;++i)o+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[i]);return o}(this,t,n);case"utf8":case"utf-8":return v(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}(this,t,n);case"base64":return r=this,i=n,0===(o=t)&&i===r.length?s.fromByteArray(r):s.fromByteArray(r.slice(o,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:_(e,t,n,r,o);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):_(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,r,o){var i=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a/=i=2,s/=2,n/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o)for(var u=-1,l=n;l<a;l++)if(c(e,l)===c(t,-1===u?0:l-u)){if(-1===u&&(u=l),l-u+1===s)return u*i}else-1!==u&&(l-=l-u),u=-1;else for(a<n+s&&(n=a-s),l=n;0<=l;l--){for(var d=!0,p=0;p<s;p++)if(c(e,l+p)!==c(t,p)){d=!1;break}if(d)return l}return-1}function g(e,t,n,r){return A(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function v(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,c,u=e[o],l=null,d=239<u?4:223<u?3:191<u?2:1;if(o+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&127<(c=(31&u)<<6|63&i)&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&2047<(c=(15&u)<<12|(63&i)<<6|63&a)&&(c<55296||57343<c)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&65535<(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)&&c<1114112&&(l=c)}null===l?(l=65533,d=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function y(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function b(e,t,n,r,o,i){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function w(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function S(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function k(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function C(e,t,n,r,o){return o||k(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function E(e,t,n,r,o){return o||k(e,0,n,8),i.write(e,t,n,r,52,8),n+8}R.Buffer=d,R.SlowBuffer=function(e){return+e!=e&&(e=0),d.alloc(+e)},R.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),R.kMaxLength=n(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,n){return r(null,e,t,n)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,n){return r=null,t=t,n=n,c(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?o(r,e).fill(t,n):o(r,e).fill(t):o(r,e);var r},d.allocUnsafe=function(e){return u(null,e)},d.allocUnsafeSlow=function(e){return u(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(o=t=0;o<e.length;++o)t+=e[o].length;for(var n=d.allocUnsafe(t),r=0,o=0;o<e.length;++o){var i=e[o];if(!d.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,r),r+=i.length}return n},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?v(this,0,e):t.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=R.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,n,r,o){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(o<=r&&n<=t)return 0;if(o<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(r,o),u=e.slice(t,n),l=0;l<s;++l)if(c[l]!==u[l]){i=c[l],a=u[l];break}return i<a?-1:a<i?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||o<n)&&(n=o),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var i,a,s,c,u,l,d=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var o=e.length-n;if((!r||(r=Number(r))>o)&&(r=o),(o=t.length)%2!=0)throw new TypeError("Invalid hex string");o/2<r&&(r=o/2);for(var i=0;i<r;++i){var a=parseInt(t.substr(2*i,2),16);if(isNaN(a))return i;e[n+i]=a}return i}(this,e,t,n);case"utf8":case"utf-8":return u=t,l=n,A(O(e,(c=this).length-u),c,u,l);case"ascii":return g(this,e,t,n);case"latin1":case"binary":return g(this,e,t,n);case"base64":return i=this,a=t,s=n,A(P(e),i,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i=t,a=n,A(function(e,t){for(var n,r,o=[],i=0;i<e.length&&!((t-=2)<0);++i)n=(r=e.charCodeAt(i))>>8,r=r%256,o.push(r),o.push(n);return o}(e,(s=this).length-i),s,i,a);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(e,t){var n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=d.prototype;else for(var r=t-e,o=new d(r,void 0),i=0;i<r;++i)o[i]=this[i+e];return o},d.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||y(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},d.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||y(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},d.prototype.readUInt8=function(e,t){return t||y(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||y(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||y(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||y(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||y(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||y(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||y(e,t,this.length);for(var r=t,o=1,i=this[e+--r];0<r&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},d.prototype.readInt8=function(e,t){return t||y(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||y(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt16BE=function(e,t){t||y(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt32LE=function(e,t){return t||y(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||y(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||y(e,4,this.length),i.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||y(e,4,this.length),i.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||y(e,8,this.length),i.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||y(e,8,this.length),i.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||b(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||b(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):w(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):w(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):S(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):S(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,n,r){e=+e,t|=0,r||b(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=0,i=1,a=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/i>>0)-a&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){e=+e,t|=0,r||b(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=n-1,i=1,a=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/i>>0)-a&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):w(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):w(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):S(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||b(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):S(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,n){return C(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return C(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return E(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return E(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;0<=o;--o)e[o+t]=this[o+n];else if(i<1e3||!d.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){var o;if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length&&(o=e.charCodeAt(0))<256&&(e=o),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else for(var i=d.isBuffer(e)?e:O(new d(e,r).toString()),a=i.length,s=0;s<n-t;++s)this[s+t]=i[s%a];return this};var T=/[^+\/0-9A-Za-z-_]/g;function O(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&i.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&i.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&i.push(239,191,189);if(o=null,n<128){if(--t<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function P(e){return s.toByteArray(function(e){if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(T,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,x(50))},function(e,t,n){var o=n(163);e.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||o))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new self[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,n){var r=n(40);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}n(47)((e.exports=o).prototype),o.prototype.onError=function(e,t){e=new Error(e);return e.type="TransportError",e.description=t,this.emit("error",e),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){e=r.decodePacket(e,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){e.exports=n(150)},function(e,r,o){"use strict";(function(e,t){var n=o(97),t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:t,t=Object(n.a)(t);r.a=t}).call(this,o(50),o(178)(e))},function(e,t,n){var a;e.exports=(a=n(5),function(o){var e=a,t=e.lib,n=t.WordArray,r=t.Hasher,t=e.algo,i=[],m=[];!function(){function e(e){return 4294967296*(e-(0|e))|0}for(var t=2,n=0;n<64;)!function(e){for(var t=o.sqrt(e),n=2;n<=t;n++)if(!(e%n))return;return 1}(t)||(n<8&&(i[n]=e(o.pow(t,.5))),m[n]=e(o.pow(t,1/3)),n++),t++}();var _=[],t=t.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],d=0;d<64;d++){d<16?_[d]=0|e[t+d]:(f=((h=_[d-15])<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,h=((p=_[d-2])<<15|p>>>17)^(p<<13|p>>>19)^p>>>10,_[d]=f+_[d-7]+h+_[d-16]);var p=r&o^r&i^o&i,f=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),h=l+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&u)+m[d]+_[d],l=u,u=c,c=s,s=a+h|0,a=i,i=o,o=r,r=h+(f+p)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+c|0,n[6]=n[6]+u|0,n[7]=n[7]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=o.floor(n/4294967296),t[15+(64+r>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=r._createHelper(t),e.HmacSHA256=r._createHmacHelper(t)}(Math),a.SHA256)},function(e,t,n){var a;e.exports=(a=n(5),n(48),function(){var e=a,t=e.lib.Hasher,n=e.x64,r=n.Word,o=n.WordArray,n=e.algo;function i(){return r.create.apply(r,arguments)}var te=[i(1116352408,3609767458),i(1899447441,602891725),i(3049323471,3964484399),i(3921009573,2173295548),i(961987163,4081628472),i(1508970993,3053834265),i(2453635748,2937671579),i(2870763221,3664609560),i(3624381080,2734883394),i(310598401,1164996542),i(607225278,1323610764),i(1426881987,3590304994),i(1925078388,4068182383),i(2162078206,991336113),i(2614888103,633803317),i(3248222580,3479774868),i(3835390401,2666613458),i(4022224774,944711139),i(264347078,2341262773),i(604807628,2007800933),i(770255983,1495990901),i(1249150122,1856431235),i(1555081692,3175218132),i(1996064986,2198950837),i(2554220882,3999719339),i(2821834349,766784016),i(2952996808,2566594879),i(3210313671,3203337956),i(3336571891,1034457026),i(3584528711,2466948901),i(113926993,3758326383),i(338241895,168717936),i(666307205,1188179964),i(773529912,1546045734),i(1294757372,1522805485),i(1396182291,2643833823),i(1695183700,2343527390),i(1986661051,1014477480),i(2177026350,1206759142),i(2456956037,344077627),i(2730485921,1290863460),i(2820302411,3158454273),i(3259730800,3505952657),i(3345764771,106217008),i(3516065817,3606008344),i(3600352804,1432725776),i(4094571909,1467031594),i(275423344,851169720),i(430227734,3100823752),i(506948616,1363258195),i(659060556,3750685593),i(883997877,3785050280),i(958139571,3318307427),i(1322822218,3812723403),i(1537002063,2003034995),i(1747873779,3602036899),i(1955562222,1575990012),i(2024104815,1125592928),i(2227730452,2716904306),i(2361852424,442776044),i(2428436474,593698344),i(2756734187,3733110249),i(3204031479,2999351573),i(3329325298,3815920427),i(3391569614,3928383900),i(3515267271,566280711),i(3940187606,3454069534),i(4118630271,4000239992),i(116418474,1914138554),i(174292421,2731055270),i(289380356,3203993006),i(460393269,320620315),i(685471733,587496836),i(852142971,1086792851),i(1017036298,365543100),i(1126000580,2618297676),i(1288033470,3409855158),i(1501505948,4234509866),i(1607167915,987167468),i(1816402316,1246189591)],ne=[];!function(){for(var e=0;e<80;e++)ne[e]=i()}();n=n.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],d=r.high,p=r.low,f=o.high,h=o.low,m=i.high,_=i.low,g=a.high,v=a.low,y=s.high,b=s.low,w=c.high,S=c.low,k=u.high,C=u.low,E=l.high,n=l.low,T=d,O=p,P=f,A=h,R=m,x=_,M=g,j=v,D=y,I=b,U=w,L=S,B=k,F=C,N=E,$=n,q=0;q<80;q++){var G,W,V=ne[q];q<16?(W=V.high=0|e[t+2*q],G=V.low=0|e[t+2*q+1]):(J=((Z=(Q=ne[q-15]).high)>>>1|(Y=Q.low)<<31)^(Z>>>8|Y<<24)^Z>>>7,X=(Y>>>1|Z<<31)^(Y>>>8|Z<<24)^(Y>>>7|Z<<25),K=((z=(ee=ne[q-2]).high)>>>19|(H=ee.low)<<13)^(z<<3|H>>>29)^z>>>6,Q=(H>>>19|z<<13)^(H<<3|z>>>29)^(H>>>6|z<<26),W=(W=(W=J+(Y=ne[q-7]).high+((G=X+Y.low)>>>0<X>>>0?1:0))+K+((G+=Q)>>>0<Q>>>0?1:0))+(Z=ne[q-16]).high+((G+=ee=Z.low)>>>0<ee>>>0?1:0),V.high=W,V.low=G);var H=D&U^~D&B,z=I&L^~I&F,J=T&P^T&R^P&R,Y=O&A^O&x^A&x,X=(T>>>28|O<<4)^(T<<30|O>>>2)^(T<<25|O>>>7),K=(O>>>28|T<<4)^(O<<30|T>>>2)^(O<<25|T>>>7),Q=(D>>>14|I<<18)^(D>>>18|I<<14)^(D<<23|I>>>9),Z=(I>>>14|D<<18)^(I>>>18|D<<14)^(I<<23|D>>>9),ee=te[q],V=ee.high,ee=ee.low,Z=N+Q+((Q=$+Z)>>>0<$>>>0?1:0),Y=K+Y,N=B,$=F,B=U,F=L,U=D,L=I,D=M+(Z=(Z=(Z=Z+H+((Q+=z)>>>0<z>>>0?1:0))+V+((Q+=ee)>>>0<ee>>>0?1:0))+W+((Q+=G)>>>0<G>>>0?1:0))+((I=j+Q|0)>>>0<j>>>0?1:0)|0,M=R,j=x,R=P,x=A,P=T,A=O,T=Z+(X+J+(Y>>>0<K>>>0?1:0))+((O=Q+Y|0)>>>0<Q>>>0?1:0)|0}p=r.low=p+O,r.high=d+T+(p>>>0<O>>>0?1:0),h=o.low=h+A,o.high=f+P+(h>>>0<A>>>0?1:0),_=i.low=_+x,i.high=m+R+(_>>>0<x>>>0?1:0),v=a.low=v+j,a.high=g+M+(v>>>0<j>>>0?1:0),b=s.low=b+I,s.high=y+D+(b>>>0<I>>>0?1:0),S=c.low=S+L,c.high=w+U+(S>>>0<L>>>0?1:0),C=u.low=C+F,u.high=k+B+(C>>>0<F>>>0?1:0),n=l.low=n+$,l.high=E+N+(n>>>0<$>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(128+r>>>10<<5)]=Math.floor(n/4294967296),t[31+(128+r>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(n),e.HmacSHA512=t._createHmacHelper(n)}(),a.SHA512)},function(e,t,n){"use strict";e.exports=function(n,r){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];return n.apply(r,e)}}},function(e,t,c){"use strict";var u=c(24),l=c(137),d=c(139),p=c(140),f=c(141),h=c(73);e.exports=function(s){return new Promise(function(t,n){var r=s.data,o=s.headers;u.isFormData(r)&&delete o["Content-Type"];var e,i,a=new XMLHttpRequest;if(s.auth&&(e=s.auth.username||"",i=s.auth.password||"",o.Authorization="Basic "+btoa(e+":"+i)),a.open(s.method.toUpperCase(),d(s.url,s.params,s.paramsSerializer),!0),a.timeout=s.timeout,a.onreadystatechange=function(){var e;a&&4===a.readyState&&(0!==a.status||a.responseURL&&0===a.responseURL.indexOf("file:"))&&(e="getAllResponseHeaders"in a?p(a.getAllResponseHeaders()):null,e={data:s.responseType&&"text"!==s.responseType?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:e,config:s,request:a},l(t,n,e),a=null)},a.onerror=function(){n(h("Network Error",s,null,a)),a=null},a.ontimeout=function(){n(h("timeout of "+s.timeout+"ms exceeded",s,"ECONNABORTED",a)),a=null},u.isStandardBrowserEnv()&&(i=c(142),(i=(s.withCredentials||f(s.url))&&s.xsrfCookieName?i.read(s.xsrfCookieName):void 0)&&(o[s.xsrfHeaderName]=i)),"setRequestHeader"in a&&u.forEach(o,function(e,t){void 0===r&&"content-type"===t.toLowerCase()?delete o[t]:a.setRequestHeader(t,e)}),s.withCredentials&&(a.withCredentials=!0),s.responseType)try{a.responseType=s.responseType}catch(t){if("json"!==s.responseType)throw t}"function"==typeof s.onDownloadProgress&&a.addEventListener("progress",s.onDownloadProgress),"function"==typeof s.onUploadProgress&&a.upload&&a.upload.addEventListener("progress",s.onUploadProgress),s.cancelToken&&s.cancelToken.promise.then(function(e){a&&(a.abort(),n(e),a=null)}),void 0===r&&(r=null),a.send(r)})}},function(e,t,n){"use strict";var i=n(138);e.exports=function(e,t,n,r,o){e=new Error(e);return i(e,t,n,r,o)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){var n,r,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(n=new Uint8Array(16),e.exports=function(){return o(n),n}):(r=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r})},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){t=t||0;return[n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]]].join("")}},function(e,t){var s=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=s.exec(e||""),i={},a=14;a--;)i[c[a]]=o[a]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i}},function(e,t){function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var n,r=typeof e;if("string"==r&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(e){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"days":case"day":case"d":return 864e5*t;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(e);if("number"==r&&!1===isNaN(e))return t.long?o(n=e,864e5,"day")||o(n,36e5,"hour")||o(n,6e4,"minute")||o(n,1e3,"second")||n+" ms":864e5<=(n=e)?Math.round(n/864e5)+"d":36e5<=n?Math.round(n/36e5)+"h":6e4<=n?Math.round(n/6e4)+"m":1e3<=n?Math.round(n/1e3)+"s":n+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||(e=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(64).Buffer)},function(e,t,n){var c=n(161),i=n(88),r=n(47),o=n(63),u=n(89),a=n(90),l=n(46)("socket.io-client:manager"),s=n(87),d=n(177),p=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];e=t.parser||o;this.encoder=new e.Encoder,this.decoder=new e.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}(e.exports=f).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},r(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(n,e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=c(this.uri,this.opts);var t=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o,i,a=u(t,"open",function(){r.onopen(),n&&n()}),s=u(t,"error",function(e){var t;l("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),n?((t=new Error("Connection error")).data=e,n(t)):r.maybeReconnectOnOpen()});return!1!==this._timeout&&(o=this._timeout,l("connect attempt will timeout after %d",o),i=setTimeout(function(){l("connect attempt timed out after %d",o),a.destroy(),t.close(),t.emit("error","timeout"),r.emitAll("connect_timeout",o)},o),this.subs.push({destroy:function(){clearTimeout(i)}})),this.subs.push(a),this.subs.push(s),this},f.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",a(this,"ondata"))),this.subs.push(u(e,"ping",a(this,"onping"))),this.subs.push(u(e,"pong",a(this,"onpong"))),this.subs.push(u(e,"error",a(this,"onerror"))),this.subs.push(u(e,"close",a(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",a(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n,r=this.nsps[e];function o(){~s(n.connecting,r)||n.connecting.push(r)}return r||(r=new i(this,e,t),this.nsps[e]=r,n=this,r.on("connecting",o),r.on("connect",function(){r.id=n.generateId(e)}),this.autoConnect&&o()),r},f.prototype.destroy=function(e){e=s(this.connecting,e);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},f.prototype.packet=function(n){l("writing packet %j",n);var r=this;n.query&&0===n.type&&(n.nsp+="?"+n.query),r.encoding?r.packetBuffer.push(n):(r.encoding=!0,this.encoder.encode(n,function(e){for(var t=0;t<e.length;t++)r.engine.write(e[t],n.options);r.encoding=!1,r.processPacketQueue()}))},f.prototype.processPacketQueue=function(){var e;0<this.packetBuffer.length&&!this.encoding&&(e=this.packetBuffer.shift(),this.packet(e))},f.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e,t,n=this;this.backoff.attempts>=this._reconnectionAttempts?(l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1):(e=this.backoff.duration(),l("will wait %dms before reconnect attempt",e),this.reconnecting=!0,t=setTimeout(function(){n.skipReconnect||(l("attempting reconnect"),n.emitAll("reconnect_attempt",n.backoff.attempts),n.emitAll("reconnecting",n.backoff.attempts),n.skipReconnect||n.open(function(e){e?(l("reconnect attempt error"),n.reconnecting=!1,n.reconnect(),n.emitAll("reconnect_error",e.data)):(l("reconnect success"),n.onreconnect())}))},e),this.subs.push({destroy:function(){clearTimeout(t)}}))},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){var a=n(65),s=n(164),c=n(173),n=n(174);t.polling=function(e){var t,n,r=!1,o=!1,i=!1!==e.jsonp;if("undefined"!=typeof location&&(t="https:"===location.protocol,n=(n=location.port)||(t?443:80),r=e.hostname!==location.hostname||n!==e.port,o=e.secure!==t),e.xdomain=r,e.xscheme=o,"open"in new a(e)&&!e.forceJSONP)return new s(e);if(!i)throw new Error("JSONP disabled");return new c(e)},t.websocket=n},function(e,t,n){var r=n(66),o=n(51),i=n(40),a=n(52),s=n(86),c=n(53)("engine.io-client:polling");e.exports=l;var u=null!=new(n(65))({xdomain:!1}).responseType;function l(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),r.call(this,e)}a(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(e){var t,n=this;function r(){c("paused"),n.readyState="paused",e()}this.readyState="pausing",this.polling||!this.writable?(t=0,this.polling&&(c("we are currently polling - waiting to pause"),t++,this.once("pollComplete",function(){c("pre-pause polling complete"),--t||r()})),this.writable||(c("we are currently writing - waiting to pause"),t++,this.once("drain",function(){c("pre-pause writing complete"),--t||r()}))):r()},l.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(e){var r=this;c("polling got data %s",e),i.decodePayload(e,this.socket.binaryType,function(e,t,n){return"opening"===r.readyState&&r.onOpen(),"close"===e.type?(r.onClose(),!1):void r.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},l.prototype.write=function(e){var t=this;this.writable=!1;function n(){t.writable=!0,t.emit("drain")}i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!==Number(this.port)||"http"==t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(t,e,n){(function(i){var a=n(166),e=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===e.call(Blob),c="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===e.call(File);t.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(a(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if("function"==typeof i&&i.isBuffer&&i.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||c&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0;return!1}}).call(this,n(64).Buffer)},function(e,t,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={},a=0,s=0;function c(e){for(var t="";t=o[e%64]+t,e=Math.floor(e/64),0<e;);return t}function u(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)}for(;s<64;s++)i[o[s]]=s;u.encode=c,u.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=64*t+i[e.charAt(s)];return t},e.exports=u},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,n){var o=n(63),r=n(47),i=n(176),a=n(89),s=n(90),c=n(46)("socket.io-client:socket"),u=n(51),l=n(85);e.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=r.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}r(f.prototype),f.prototype.subEvents=function(){var e;this.subs||(e=this.io,this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))])},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(t))?o.BINARY_EVENT:o.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){var e;c("transport is open - connecting"),"/"!==this.nsp&&(this.query?(e="object"==typeof this.query?u.encode(this.query):this.query,c("sending connect packet with query %s",e),this.packet({type:o.CONNECT,query:e})):this.packet({type:o.CONNECT}))},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===o.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(t){var n=this,r=!1;return function(){var e;r||(r=!0,e=i(arguments),c("sending ack %j",e),n.packet({type:l(e)?o.BINARY_ACK:o.ACK,id:t,data:e}))}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){for(var e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t,n){"use strict";e.exports=n(124)},function(S,k,e){(function(e){function l(r){if(!r)throw"MediaStream is mandatory.";var o;this.start=function(e){var t;"undefined"!=typeof MediaRecorder?t=p:(c||a||i)&&(-1!==this.mimeType.indexOf("video")?t=m:-1!==this.mimeType.indexOf("audio")&&(t=h)),"image/gif"===this.mimeType&&(t=g),"audio/wav"!==this.mimeType&&"audio/pcm"!==this.mimeType||(t=h),this.recorderType&&(t=this.recorderType),(o=new t(r)).blobs=[];var n=this;o.ondataavailable=function(e){o.blobs.push(e),n.ondataavailable(e)},o.onstop=this.onstop,o.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(o=function(e,t){for(var n in t)"function"!=typeof t[n]&&(e[n]=t[n]);return e}(o,this)).start(e)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){o&&o.clearOldRecordedFrames()},this.stop=function(){o&&o.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.save=function(e,t){e?s(e,t):o&&ConcatenateBlobs(o.blobs,o.blobs[0].type,function(e){s(e)})},this.pause=function(){o&&(o.pause(),console.log("Paused recording.",this.mimeType||o.mimeType))},this.resume=function(){o&&(o.resume(),console.log("Resumed recording.",this.mimeType||o.mimeType))},this.recorderType=null,this.mimeType="video/webm",this.disableLogs=!1}l.MultiStreamRecorder=function(r){if(!r)throw"MediaStream is mandatory.";var o,i,a=this,s=d();this.stream=r,this.start=function(e){for(var t in o=new l(r),i=new l(r),o.mimeType="audio/ogg",i.mimeType="video/webm",this)"function"!=typeof this[t]&&(o[t]=i[t]=this[t]);function n(e){u++,a.ondataavailable(e)}o.ondataavailable=function(e){c[u]||(c[u]={}),c[u].audio=e,c[u].video&&!c[u].onDataAvailableEventFired&&(c[u].onDataAvailableEventFired=!0,n(c[u]))},i.ondataavailable=function(e){if(s)return a.ondataavailable({video:e,audio:e});c[u]||(c[u]={}),c[u].video=e,c[u].audio&&!c[u].onDataAvailableEventFired&&(c[u].onDataAvailableEventFired=!0,n(c[u]))},i.onstop=o.onstop=function(e){a.onstop(e)},s||(i.onStartedDrawingNonBlankFrames=function(){i.clearOldRecordedFrames(),o.start(e)}),i.start(e)},this.stop=function(){o&&o.stop(),i&&i.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.pause=function(){o&&o.pause(),i&&i.pause()},this.resume=function(){o&&o.resume(),i&&i.resume()};var c={},u=0};var t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",n=void 0!==e?e:window;"undefined"==typeof window&&("undefined"==typeof window&&void 0!==e&&(e.navigator={userAgent:t,getUserMedia:function(){}},n.window=e),"undefined"==typeof document&&(n.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(n.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(n.screen={width:0,height:0})),void 0===(n=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(n=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(n=mozAudioContext)),"undefined"==typeof window&&(window={}),void 0===(n=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(n=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(n=mozAudioContext));var f=window.URL;void 0===f&&"undefined"!=typeof webkitURL&&(f=webkitURL),"undefined"!=typeof navigator?(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:t};var i=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),a=!1;"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")&&(a=!0);var c=!i&&!i&&!!navigator.webkitGetUserMedia,u=window.MediaStream;function s(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var n,r=(e.type||"video/webm").split("/")[1];t&&-1!==t.indexOf(".")&&(t=(n=t.split("."))[0],r=n[1]);r=(t||Math.round(9999999999*Math.random())+888888888)+"."+r;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,r);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,r);var o=document.createElement("a");o.href=f.createObjectURL(e),o.target="_blank",o.download=r,navigator.mozGetUserMedia&&(o.onclick=function(){(document.body||document.documentElement).removeChild(o)},(document.body||document.documentElement).appendChild(o));r=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(r),navigator.mozGetUserMedia||f.revokeObjectURL(o.href)}function b(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}void 0===u&&"undefined"!=typeof webkitMediaStream&&(u=webkitMediaStream),void 0!==u&&("getVideoTracks"in u.prototype||(u.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var t=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("video")&&t.push(e)}),t},u.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var t=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("audio")&&t.push(e)}),t}),"stop"in u.prototype||(u.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()})})),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var w={AudioContext:n};function d(){var e=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;if(!t)return!1;navigator.appVersion;var n,r=navigator.userAgent,o=""+parseFloat(navigator.appVersion),e=parseInt(navigator.appVersion,10);return t&&(n=r.indexOf("Chrome"),o=r.substring(n+7)),-1!==(n=o.indexOf(";"))&&(o=o.substring(0,n)),-1!==(n=o.indexOf(" "))&&(o=o.substring(0,n)),e=parseInt(""+o,10),isNaN(e)&&(o=""+parseFloat(navigator.appVersion),e=parseInt(navigator.appVersion,10)),49<=e}function p(i){var a,s=this;this.start=function(t,e){var n;s.mimeType||(s.mimeType="video/webm"),-1!==s.mimeType.indexOf("audio")&&i.getVideoTracks().length&&i.getAudioTracks().length&&(navigator.mozGetUserMedia?(n=new u).addTrack(i.getAudioTracks()[0]):n=new u(i.getAudioTracks()),i=n),-1!==s.mimeType.indexOf("audio")&&(s.mimeType=c?"audio/webm":"audio/ogg"),s.dontFireOnDataAvailableEvent=!1;var r={mimeType:s.mimeType};s.disableLogs||e||console.log("Passing following params over MediaRecorder API.",r),a=a&&null,c&&!d()&&(r="video/vp8");try{a=new MediaRecorder(i,r)}catch(e){a=new MediaRecorder(i)}"canRecordMimeType"in a&&!1===a.canRecordMimeType(s.mimeType)&&(s.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",s.mimeType)),a.ignoreMutedMedia=s.ignoreMutedMedia||!1;var o=!1;a.ondataavailable=function(e){s.dontFireOnDataAvailableEvent||!e.data||!e.data.size||e.data.size<26800||o||(o=!0,e=s.getNativeBlob?e.data:new Blob([e.data],{type:s.mimeType||"video/webm"}),s.ondataavailable(e),s.dontFireOnDataAvailableEvent=!0,a&&(a.stop(),a=null),s.start(t,"__disableLogs"))},a.onerror=function(e){s.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),a&&"inactive"!==a.state&&"stopped"!==a.state&&a.stop()};try{a.start(36e5)}catch(e){a=null}setTimeout(function(){a&&"recording"===a.state&&a.requestData()},t)},this.stop=function(e){a&&"recording"===a.state&&(a.requestData(),setTimeout(function(){s.dontFireOnDataAvailableEvent=!0,a&&"recording"===a.state&&a.stop(),a=null},2e3))},this.pause=function(){a&&"recording"===a.state&&a.pause()},this.ondataavailable=function(e){console.log("recorded-blob",e)},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=s.disableLogs;return s.disableLogs=!0,this.record(),void(s.disableLogs=e)}a&&"paused"===a.state&&a.resume()},this.clearRecordedData=function(){a&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())},function e(){a&&(!1!==function(){if("active"in i){if(!i.active)return!1}else if("ended"in i&&i.ended)return!1;return!0}()?setTimeout(e,1e3):s.stop())}()}function h(t){var n,r;this.start=function(e){e=e||1e3,(n=new o(t,this)).record(),r=setInterval(function(){n.requestData()},e)},this.stop=function(){n&&(n.stop(),clearTimeout(r))},this.pause=function(){n&&n.pause()},this.resume=function(){n&&n.resume()},this.ondataavailable=function(){}}function o(e,u){w.AudioContextConstructor||(w.AudioContextConstructor=new w.AudioContext),i=w.AudioContextConstructor.sampleRate;var t,l=[],d=[],n=!1,p=0,f=u.sampleRate||i,h=-1<(u.mimeType||"audio/wav").indexOf("audio/pcm"),m=u.audioChannels||2;function _(e,t){for(var n=new Float32Array(t),r=0,o=e.length,i=0;i<o;i++){var a=e[i];n.set(a,r),r+=a.length}return n}function g(e,t,n){for(var r=n.length,o=0;o<r;o++)e.setUint8(t+o,n.charCodeAt(o))}this.record=function(){n=!0,l.length=d.length=0,p=0},this.requestData=function(){if(!y)if(0!==p){v=!0;var e=l.slice(0),t=d.slice(0),n=p;l.length=d.length=[],p=0,v=!1;var e=_(e,n),r=e;if(2===m&&(r=function(e,t){for(var n=e.length+t.length,r=new Float32Array(n),o=0,i=0;i<n;)r[i++]=e[o],r[i++]=t[o],o++;return r}(e,_(t,n))),h){var o=new Blob([function(e){for(var t=e.length,n=new Int16Array(t);t--;)n[t]=65535*e[t];return n.buffer}(r)],{type:"audio/pcm"});return console.debug("audio recorded blob size:",b(o.size)),void u.ondataavailable(o)}var n=new ArrayBuffer(44+2*r.length),i=new DataView(n);g(i,0,"RIFF"),i.setUint32(4,44+2*r.length-8,!0),g(i,8,"WAVE"),g(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,m,!0),i.setUint32(24,f,!0),i.setUint32(28,f*m*2,!0),i.setUint16(32,2*m,!0),i.setUint16(34,16,!0),g(i,36,"data"),i.setUint32(40,2*r.length,!0);for(var a=r.length,s=44,c=0;c<a;c++)i.setInt16(s,32767*r[c],!0),s+=2;o=new Blob([i],{type:"audio/wav"}),console.debug("audio recorded blob size:",b(o.size)),u.ondataavailable(o)}else v=!1},this.stop=function(){n=!1,this.requestData(),o.disconnect()};var r=w.AudioContextConstructor;w.VolumeGainNode=r.createGain();var o,i=w.VolumeGainNode;w.AudioInput=r.createMediaStreamSource(e),(o=w.AudioInput).connect(i);var a=u.bufferSize||2048;if(0===u.bufferSize&&(a=0),r.createJavaScriptNode)t=r.createJavaScriptNode(a,m,m);else{if(!r.createScriptProcessor)throw"WebAudio API has no support on this browser.";t=r.createScriptProcessor(a,m,m)}a=t.bufferSize,console.debug("using audio buffer-size:",a);var v=!1;window.scriptprocessornode=t,1===m&&console.debug("All right-channels are skipped.");var y=!1;this.pause=function(){y=!0},this.resume=function(){y=!1},t.onaudioprocess=function(e){var t;!n||v||y||(t=e.inputBuffer.getChannelData(0),l.push(new Float32Array(t)),2===m&&(e=e.inputBuffer.getChannelData(1),d.push(new Float32Array(e))),p+=a)},i.connect(t),t.connect(r.destination)}function m(n){var r,o;this.start=function(e){for(var t in e=e||1e3,r=new _(n,this),this)"function"!=typeof this[t]&&(r[t]=this[t]);r.record(),o=setInterval(function(){r.requestData()},e)},this.stop=function(){r&&(r.stop(),clearTimeout(o))},this.clearOldRecordedFrames=function(){r&&r.clearOldRecordedFrames()},this.pause=function(){r&&r.pause()},this.resume=function(){r&&r.resume()},this.ondataavailable=function(){}}function _(t,n){this.record=function(e){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=s.videoWidth||s.clientWidth||320),this.height||(this.height=s.videoHeight||s.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),y.width=this.canvas.width,y.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?(this.isHTMLObject=!0,s=this.video.cloneNode()):((s=document.createElement("video")).src=f.createObjectURL(t),s.width=this.video.width,s.height=this.video.height),s.muted=!0,s.play(),c=(new Date).getTime(),u=new v.Video(n.speed,n.quality),console.log("canvas resolutions",y.width,"*",y.height),console.log("video width/height",s.width||y.width,"*",s.height||y.height),i()};var r=!(this.clearOldRecordedFrames=function(){u.frames=[]}),o=!(this.requestData=function(){var e;p||(r=(u.frames.length&&(r=!0,e=u.frames.slice(0),u.frames=function(e){var t=document.createElement("canvas");t.width=y.width,t.height=y.height;for(var n=t.getContext("2d"),r=[],o=e.length,i=0,a=0,s=0,c=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),u=!1,l=0;l<o;l++){if(!u){var d=new Image;d.src=e[l].image,n.drawImage(d,0,0,y.width,y.height);for(var p=n.getImageData(0,0,y.width,y.height),f=0,h=p.data.length,d=p.data.length/4,m=0;m<h;m+=4){var _=p.data[m],g=p.data[m+1],v=p.data[m+2];Math.sqrt(Math.pow(_-i,2)+Math.pow(g-a,2)+Math.pow(v-s,2))<=0*c&&f++}}!u&&d-f<=0*d||(u=!0,r.push(e[l]))}return(r=r.concat(e.slice(o))).length<=0&&r.push(e[e.length-1]),r}(e),u.compile(function(e){n.ondataavailable(e),console.debug("video recorded blob size:",b(e.size))}),u.frames=[]),!1))});function i(){if(p)return c=(new Date).getTime(),void setTimeout(i,500);if(!a){if(r)return setTimeout(i,100);var e=(new Date).getTime()-c;if(!e)return i();c=(new Date).getTime(),!d.isHTMLObject&&s.paused&&s.play(),l.drawImage(s,0,0,y.width,y.height),a||u.frames.push({duration:e,image:y.toDataURL("image/webp")}),o||function(e){var t=document.createElement("canvas");t.width=y.width,t.height=y.height;var n=t.getContext("2d"),r=0,o=0,i=0,a=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),t=new Image;t.src=e.image,n.drawImage(t,0,0,y.width,y.height);for(var s=n.getImageData(0,0,y.width,y.height),c=0,u=s.data.length,n=s.data.length/4,l=0;l<u;l+=4){var d=s.data[l],p=s.data[l+1],f=s.data[l+2];Math.sqrt(Math.pow(d-r,2)+Math.pow(p-o,2)+Math.pow(f-i,2))<=0*a&&c++}return!(n-c<=0*n)}(u.frames[u.frames.length-1])||(o=!0,n.onStartedDrawingNonBlankFrames()),setTimeout(i,10)}}var a=!1;this.stop=function(){a=!0,this.requestData()};var s,c,u,y=document.createElement("canvas"),l=y.getContext("2d"),d=this,p=!1;this.pause=function(){p=!0},this.resume=function(){p=!1}}function g(e){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";function t(){Date.now();var e=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"});n.ondataavailable(e),u.stream().bin=[]}this.start=function(e){e=e||1e3;var n=this.videoWidth||320,r=this.videoHeight||240;i.width=s.width=n,i.height=s.height=r,(u=new GIFEncoder).setRepeat(0),u.setDelay(this.frameRate||this.speed||200),u.setQuality(this.quality||1),u.start(),Date.now(),d=requestAnimationFrame(function e(t){o?setTimeout(e,500,t):(d=requestAnimationFrame(e),t-c<90||(s.paused&&s.play(),a.drawImage(s,0,0,n,r),u.addFrame(a),c=t))}),l=setTimeout(t,e)};var o=!(this.stop=function(){d&&(cancelAnimationFrame(d),clearTimeout(l),t())});this.pause=function(){o=!0},this.resume=function(){o=!1},this.ondataavailable=function(){},this.onstop=function(){};var n=this,i=document.createElement("canvas"),a=i.getContext("2d"),s=document.createElement("video");s.muted=!0,s.autoplay=!0,s.src=f.createObjectURL(e),s.play();var c,u,l,d=null}w={AudioContext:window.AudioContext||window.webkitAudioContext},l.MediaRecorderWrapper=p,l.StereoAudioRecorder=h,l.StereoAudioRecorderHelper=o,l.WhammyRecorder=m,l.WhammyRecorderHelper=_,l.GifRecorder=g;var v=(r.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},r.prototype.compile=function(t){var e,n=(n=y,e=f.createObjectURL(new Blob([n.toString(),"this.onmessage =  function (e) {"+n.name+"(e.data);}"],{type:"application/javascript"})),n=new Worker(e),f.revokeObjectURL(e),n);n.onmessage=function(e){e.data.error?console.error(e.data.error):t(e.data)},n.postMessage(this.frames)},{Video:r});function r(e,t){this.frames=[],e=e||1,this.duration=1e3/e,this.quality=t||.8}function y(e){function u(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}e=new function(e){var t=function(e){if(e[0]){for(var t=e[0].width,n=e[0].height,r=e[0].duration,o=1;o<e.length;o++)r+=e[o].duration;return{duration:r,width:t,height:n}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!t)return[];for(var n,r=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(n=t.duration,[].slice.call(new Uint8Array(new Float64Array([n]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],o=0,i=0;o<e.length;){for(var a=[],s=0;a.push(e[o]),s+=e[o].duration,o++,o<e.length&&s<3e4;);var c={id:524531317,data:function(e,n,t){return[{data:e,id:231}].concat(t.map(function(e){var t=function(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),127<e.trackNum)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(n)});return n+=e.duration,{data:t,id:163}}))}(i,0,a)};r[1].data.push(c),i+=s}return function e(t){for(var n=[],r=0;r<t.length;r++){var o=t[r].data;"object"==typeof o&&(o=e(o)),"number"==typeof o&&(o=u(o.toString(2))),"string"==typeof o&&(o=new Uint8Array(o.split("").map(function(e){return e.charCodeAt(0)})));var i=o.size||o.byteLength||o.length,a=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),i=i.toString(2),i=new Array(7*a+7+1-i.length).join("0")+i,i=new Array(a).join("0")+"1"+i;n.push(function(e){for(var t=[];0<e;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}(t[r].id)),n.push(u(i)),n.push(o)}return new Blob(n,{type:"video/webm"})}(r)}(e.map(function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],n=t.indexOf("*"),r=0,o=[];r<4;r++)o[r]=t.charCodeAt(n+3+r);return{width:16383&(o[1]<<8|o[0]),height:16383&(o[3]<<8|o[2]),data:t,riff:e}}(function e(t){for(var n=0,r={};n<t.length;){var o=t.substr(n,4),i=(a=n,parseInt(t.substr(a+4,4).split("").map(function(e){e=e.charCodeAt(0).toString(2);return new Array(8-e.length+1).join("0")+e}).join(""),2)),a=t.substr(n+4+4,i);n+=8+i,r[o]=r[o]||[],"RIFF"===o||"LIST"===o?r[o].push(e(a)):r[o].push(a)}return r}(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(e)}l.Whammy=v,window.ConcatenateBlobs=function(n,o,i){var a=[],r=0;!function t(){if(!n[r])return function(){var t=0;a.forEach(function(e){t+=e.byteLength});var n=new Uint16Array(t),r=0;a.forEach(function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),n.set(new Uint16Array(e),r),r+=t});var e=new Blob([n.buffer],{type:o});i(e)}(),0;var e=new FileReader;e.onload=function(e){a.push(e.target.result),r++,t()},e.readAsArrayBuffer(n[r])}()},S.exports=l,void 0===(n=function(){return l}.apply(k,[]))||(S.exports=n)}).call(this,e(50))},function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o={options:{disableScrolling:!1,hostedStyles:!0,animations:!0,keyboardControl:!0,minResolution:0,autoInit:!0,wrapAround:!1,showImageCount:!0},version:"1.4.11"};function i(e,t){var n=this;this.root=t,this.index=e,this.imgPaths=[],this.subTexts=[],this.altTexts=[],this.options={};e=document.getElementsByClassName("hes-gallery")[this.index];this.options.wrapAround=e.hasAttribute("data-wrap")?"true"==e.dataset.wrap:this.root.options.wrapAround,this.options.showImageCount=e.hasAttribute("data-img-count")?"true"==e.dataset.imgCount:this.root.options.showImageCount;var r=0;e.querySelectorAll("img").forEach(function(e,t){e.hasAttribute("data-disabled")?r++:(e.hasAttribute("data-fullsize")?n.imgPaths.push(e.dataset.fullsize||""):n.imgPaths.push(e.src||""),n.subTexts.push(e.dataset.subtext||""),n.altTexts.push(e.alt||""),e.onclick=function(){n.root.show(n.index,t-r)})}),this.count=this.imgPaths.length}o.setOptions=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(e in t)this.options[e]=t[e]},o.init=function(e){var t=this;this.setOptions(e),this.executed||this.createDOM(),this.options.animations?this.elements.pic_cont.classList="hg-transition":this.elements.pic_cont.classList="",this.count=document.querySelectorAll(".hes-gallery").length,this.galleries=[];for(var n=0;n<this.count;n++)this.galleries[n]=new i(n,this);return this.options.keyboardControl&&!this.keydownEventListener&&(addEventListener("keydown",function(e){e=e.keyCode;39==e&&t.open&&t.options.keyboardControl&&t.next(),37==e&&t.open&&t.options.keyboardControl&&t.prev(),27==e&&t.open&&t.options.keyboardControl&&t.hide()}),this.keydownEventListener=!0),"HesGallery initiated!"},o.createDOM=function(){var e=this;this.elements={},this.options.hostedStyles&&(document.head.innerHTML+="<link rel='stylesheet' href='https://unpkg.com/hes-gallery/dist/hes-gallery.min.css'>");var t=document.createElement("div");t.id="hgallery",t.setAttribute("style","visibility:hidden;"),this.elements.galery=t,this.elements.galery.innerHTML+="\n    <div id='hg-bg'></div>\n    <div id='hg-pic-cont'>\n      <img id='hg-pic' />\n      <div id='hg-prev-onpic'></div>\n      <div id='hg-next-onpic'></div>\n      <div id='hg-subtext'></div>\n      <div id='hg-howmany'></div>\n    </div>\n    <button id='hg-prev'></button>\n    <button id='hg-next'></button>\n  ",document.body.appendChild(t),this.elements.b_prev=document.getElementById("hg-prev"),this.elements.b_next=document.getElementById("hg-next"),this.elements.pic_cont=document.getElementById("hg-pic-cont"),this.elements.b_next_onpic=document.getElementById("hg-next-onpic"),this.elements.b_prev_onpic=document.getElementById("hg-prev-onpic"),this.elements.b_prev.onclick=this.elements.b_prev_onpic.onclick=function(){e.prev()},this.elements.b_next.onclick=this.elements.b_next_onpic.onclick=function(){e.next()},document.getElementById("hg-bg").onclick=function(){e.hide()},this.executed=!0},o.show=function(e,t){if(innerWidth<this.options.minResolution)return!1;this.currentImg=t,this.currentGal=e,this.open=!0,!this.options.animations&&"hg-transition"!=this.elements.pic_cont.classList||this.elements.pic_cont.classList.remove("hg-transition"),document.getElementById("hg-pic").setAttribute("src",this.galleries[e].imgPaths[t]),document.getElementById("hg-pic").alt=this.galleries[e].altTexts[t],this.elements.galery.classList.add("open"),document.getElementById("hg-subtext").innerHTML=this.galleries[e].subTexts[t],this.galleries[this.currentGal].options.showImageCount&&1!=this.galleries[this.currentGal].imgPaths.length?document.getElementById("hg-howmany").innerHTML=this.currentImg+1+"/"+this.galleries[e].count:document.getElementById("hg-howmany").innerHTML="",1==this.galleries[this.currentGal].imgPaths.length?(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"):this.currentImg+1!=1||this.galleries[this.currentGal].options.wrapAround?(this.currentImg+1!=this.galleries[this.currentGal].count||this.galleries[this.currentGal].options.wrapAround?(this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""):(this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"),this.elements.b_prev.classList="",this.elements.b_prev_onpic.classList=""):(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""),this.options.disableScrolling&&(document.body.classList+=" hg-disable-scrolling")},o.hide=function(){this.options.animations&&this.elements.pic_cont.classList.add("hg-transition"),this.elements.galery.classList.remove("open"),this.open=!1,this.options.disableScrolling&&document.body.classList.remove("hg-disable-scrolling")},o.next=function(){this.galleries[this.currentGal].options.wrapAround&&this.currentImg==this.galleries[this.currentGal].count-1?this.show(this.currentGal,0):this.currentImg+1<this.galleries[this.currentGal].count&&this.show(this.currentGal,this.currentImg+1)},o.prev=function(){this.galleries[this.currentGal].options.wrapAround&&0==this.currentImg?this.show(this.currentGal,this.galleries[this.currentGal].count-1):1<this.currentImg+1&&this.show(this.currentGal,this.currentImg-1)},document.addEventListener("DOMContentLoaded",function(){o.options.autoInit&&o.init()}),"object"==r(t)&&void 0!==e&&(e.exports=o),"undefined"!=typeof NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)},function(c,e,u){parcelRequire=function(o,i,e){var t,a="function"==typeof parcelRequire&&parcelRequire;function s(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof parcelRequire&&parcelRequire;if(!e&&n)return n(t,!0);if(a)return a(t,!0);if("string"==typeof t)return u(153)(t);n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}r.resolve=function(e){return o[t][1][e]||e},r.cache={};n=i[t]=new s.Module(t);o[t][0].call(n.exports,r,n,n.exports,this)}return i[t].exports;function r(e){return s(r.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=o,s.cache=i,s.parent=a,s.register=function(e,n){o[e]=[function(e,t){t.exports=n},{}]};for(var n,r=0;r<e.length;r++)try{s(e[r])}catch(o){t=t||o}if(e.length&&(n=s(e[e.length-1]),c.exports=n),parcelRequire=s,t)throw t;return s}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var o=t.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(o=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){var e;0<this._pieces.length&&(e=new Uint8Array(this._pieces),r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[])},i.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new o,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=i},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,o=e("./bufferbuilder").binaryFeatures,e={unpack:function(e){return new i(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function i(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new r}function s(e){e=e.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}t.exports=e,i.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},i.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},i.prototype.unpack_uint16=function(){var e=this.read(2),e=256*(255&e[0])+(255&e[1]);return this.index+=2,e},i.prototype.unpack_uint32=function(){var e=this.read(4),e=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,e},i.prototype.unpack_uint64=function(){var e=this.read(8),e=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,e},i.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},i.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},i.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},i.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},i.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},i.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),o=0,i="";o<e;)(t=r[o])<128?(i+=String.fromCharCode(t),o++):(192^t)<32?(n=(192^t)<<6|63&r[o+1],i+=String.fromCharCode(n),o+=2):(n=(15&t)<<12|(63&r[o+1])<<6|63&r[o+2],i+=String.fromCharCode(n),o+=3);return this.index+=e,i},i.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},i.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),o=this.unpack();t[r]=o}return t},i.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},i.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},i.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{t=e.constructor;if(t==Array)this.pack_array(e);else if(t==Blob||t==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(t==ArrayBuffer)o.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)o.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(t==Object||t.toString().startsWith("class"))this.pack_object(e);else if(t==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+t.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t,t=600<(t=e).length?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,s).length;if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(255&e);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-0x8000000000000000<=e&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(0<=e&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,e=Math.floor(r*Math.pow(2,52)),r=Math.pow(2,32),n=t<<31|n+1023<<20|e/r&1048575,r=e%r;this.bufferBuilder.append(203),this.pack_int32(n),this.pack_int32(r)},a.prototype.pack_object=function(e){var t,n=Object.keys(e).length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this.bufferBuilder.append(222),this.pack_uint16(n);else{if(!(n<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(n)}for(t in e)e.hasOwnProperty(t)&&(this.pack(t),this.pack(e[t]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){e&=4294967295;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),e=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),e=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,r,o){var i,a;e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,i=e.addEventListener,e.addEventListener=function(e,t){if(e!==r)return i.apply(this,arguments);function n(e){(e=o(e))&&t(e)}return this._eventMap=this._eventMap||{},this._eventMap[t]=n,i.apply(this,[e,n])},a=e.removeEventListener,e.removeEventListener=function(e,t){if(e!==r||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);var n=this._eventMap[t];return delete this._eventMap[t],a.apply(this,[e,n])},Object.defineProperty(e,"on"+r,{get:function(){return this["_on"+r]},set:function(e){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),e&&this.addEventListener(r,this["_on"+r]=e)},enumerable:!0,configurable:!0}))},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=e)?"adapter.js logging disabled":"adapter.js logging enabled"},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){"object"===("undefined"==typeof window?"undefined":r(window))&&(o||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments))},n.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function o(i){return s(i)?Object.keys(i).reduce(function(e,t){var n=s(i[t]),r=n?o(i[t]):i[t],n=n&&!Object.keys(r).length;return void 0===r||n?e:Object.assign(e,(e=r,(r=t)in(t={})?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t))},{}):i},n.walkStats=c,n.filterStats=function(n,t,e){var r=e?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return n.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)}),i.forEach(function(t){n.forEach(function(e){e.type===r&&e.trackId===t.id&&c(n,e,o)})}),o};var o=!0,i=!0;function a(e,t,n){t=e.match(t);return t&&t.length>=n&&parseInt(t[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(function(e){e.endsWith("Id")?c(t,t.get(n[e]),r):e.endsWith("Ids")&&n[e].forEach(function(e){c(t,t.get(e),r)})}))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t,a,r,o,n,s=e&&e.navigator;s.mediaDevices&&(t=i.detectBrowser(e),a=function(o){if("object"!==c(o)||o.mandatory||o.optional)return o;var i={};return Object.keys(o).forEach(function(t){var n,r,e;"require"!==t&&"advanced"!==t&&"mediaSource"!==t&&(void 0!==(n="object"===c(o[t])?o[t]:{ideal:o[t]}).exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact),r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t},void 0!==n.ideal&&(i.optional=i.optional||[],e={},"number"==typeof n.ideal?(e[r("min",t)]=n.ideal,i.optional.push(e),(e={})[r("max",t)]=n.ideal):e[r("",t)]=n.ideal,i.optional.push(e)),void 0!==n.exact&&"number"!=typeof n.exact?(i.mandatory=i.mandatory||{},i.mandatory[r("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(i.mandatory=i.mandatory||{},i.mandatory[r(e,t)]=n[e])}))}),o.advanced&&(i.optional=(i.optional||[]).concat(o.advanced)),i},r=function(n,r){if(61<=t.version)return r(n);if((n=JSON.parse(JSON.stringify(n)))&&"object"===c(n.audio)&&((e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=a(n.audio)),n&&"object"===c(n.video)){var o,i=(i=n.video.facingMode)&&("object"===c(i)?i:{ideal:i}),e=t.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||e)&&(delete n.video.facingMode,"environment"===i.exact||"environment"===i.ideal?o=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(o=["front"]),o))return s.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return o.some(function(e){return t.label.toLowerCase().includes(e)})});return!t&&e.length&&o.includes("back")&&(t=e[e.length-1]),t&&(n.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=a(n.video),u("chrome: "+JSON.stringify(n)),r(n)});n.video=a(n.video)}return u("chrome: "+JSON.stringify(n)),r(n)},o=function(e){return 64<=t.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},s.getUserMedia=function(e,t,n){r(e,function(e){s.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})}.bind(s),s.mediaDevices.getUserMedia&&(n=s.mediaDevices.getUserMedia.bind(s.mediaDevices),s.mediaDevices.getUserMedia=function(e){return r(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(o(e))})})}))};var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils.js"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=i.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&("function"==typeof e?i.navigator.mediaDevices.getDisplayMedia=function(o){return e(o).then(function(e){var t=o.video&&o.video.width,n=o.video&&o.video.height,r=o.video&&o.video.frameRate;return o.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:r||3}},t&&(o.video.mandatory.maxWidth=t),n&&(o.video.mandatory.maxHeight=n),i.navigator.mediaDevices.getUserMedia(o)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(i){var e;"object"!==s(i)||!i.RTCPeerConnection||"ontrack"in i.RTCPeerConnection.prototype?c.wrapPeerConnectionEvent(i,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}):(Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0}),e=i.RTCPeerConnection.prototype.setRemoteDescription,i.RTCPeerConnection.prototype.setRemoteDescription=function(){var o=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track},n=new Event("track");n.track=t.track,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)}),r.stream.getTracks().forEach(function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t},n=new Event("track");n.track=t,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)})},n.shimGetSendersWithDtmf=function(e){var r,o,t,n,i,a;"object"===s(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype?(r=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}},e.RTCPeerConnection.prototype.getSenders||(e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()},o=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=o.apply(this,arguments);return n||(n=r(this,e),this._senders.push(n)),n},t=e.RTCPeerConnection.prototype.removeTrack,e.RTCPeerConnection.prototype.removeTrack=function(e){t.apply(this,arguments);e=this._senders.indexOf(e);-1!==e&&this._senders.splice(e,1)}),n=e.RTCPeerConnection.prototype.addStream,e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(r(t,e))})},i=e.RTCPeerConnection.prototype.removeStream,e.RTCPeerConnection.prototype.removeStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(t){var e=n._senders.find(function(e){return e.track===t});e&&n._senders.splice(n._senders.indexOf(e),1)})}):"object"===s(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&(a=e.RTCPeerConnection.prototype.getSenders,e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=a.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}}))},n.shimGetStats=function(e){var a;e.RTCPeerConnection&&(a=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var n=this,[e,t,r]=arguments;if(0<arguments.length&&"function"==typeof e)return a.apply(this,arguments);if(0===a.length&&(0===arguments.length||"function"!=typeof e))return a.apply(this,[]);function o(e){var r={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),r[n.id]=n}),r}function i(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}return 2<=arguments.length?a.apply(this,[function(e){t(i(o(e)))},e]):new Promise(function(t,e){a.apply(n,[function(e){t(i(o(e)))},e])}).then(t,r)})},n.shimSenderReceiverGetStats=function(e){var n,t,r,i;"object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver&&("getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}),"getStats"in e.RTCRtpReceiver.prototype||((r=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}),"getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype&&(i=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o=arguments[0];return this.getSenders().forEach(function(e){e.track===o&&(t?r=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===o&&(n?r=!0:n=e),e.track===o}),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}))},n.shimAddTrackRemoveTrackWithNative=l,n.shimAddTrackRemoveTrack=function(o){if(o.RTCPeerConnection){var e=c.detectBrowser(o);if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return l(o);var n=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var r=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(e){var t,n=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this._reverseStreams[e.id]||(t=new o.MediaStream(e.getTracks()),this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t),r.apply(this,[e])};var t=o.RTCPeerConnection.prototype.removeStream;o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[(this._streams[e.id]||e).id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};r=this._streams[e.id];return r?(r.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(r=new o.MediaStream([t]),this._streams[e.id]=r,this._reverseStreams[r.id]=e,this.addStream(r)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var r=o.RTCPeerConnection.prototype[e],t=u({},e,function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(e){e=s(t,e);n[0].apply(null,[e])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(e){return s(t,e)})});o.RTCPeerConnection.prototype[e]=t[e]});var i=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=(n=this,r=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],e=n._streams[t.id];r=r.replace(new RegExp(t.id,"g"),e.id)}),new RTCSessionDescription({type:e.type,sdp:r}))),i.apply(this,arguments);var n,e,r};var a=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:s(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var n,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(n,e){var r=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],e=n._streams[t.id];r=r.replace(new RegExp(e.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:r})}},n.shimPeerConnection=function(r){var e,t=c.detectBrowser(r);!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&(t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e],n=u({},e,function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});r.RTCPeerConnection.prototype[e]=n[e]}),e=r.RTCPeerConnection.prototype.addIceCandidate,r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})},n.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var c=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils.js")),r=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=r.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(n)&&this._shimmedLocalStreams[t.id].push(n):this._shimmedLocalStreams[t.id]=[t,n],n};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();o.apply(this,arguments);var r=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(r)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(n){var r=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=r._shimmedLocalStreams[e].indexOf(n);-1!==t&&r._shimmedLocalStreams[e].splice(t,1),1===r._shimmedLocalStreams[e].length&&delete r._shimmedLocalStreams[e]}),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&o.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;e=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return e&&!r&&(r=!0)}),delete e.url,e.urls=n?t[0]:t,!!t.length}})};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var u={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};u.localCName=u.generateIdentifier(),u.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},u.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},u.getDescription=function(e){e=u.splitSections(e);return e&&e[0]},u.getMediaSections=function(e){e=u.splitSections(e);return e.shift(),e},u.matchPrefix=function(e,t){return u.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},u.parseCandidate=function(e){for(var t,n={foundation:(t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},u.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},u.parseIceOptions=function(e){return e.substr(14).split(" ")},u.parseRtpMap=function(e){var t=e.substr(9).split(" "),e={payloadType:parseInt(t.shift(),10)},t=t[0].split("/");return e.name=t[0],e.clockRate=parseInt(t[1],10),e.channels=3===t.length?parseInt(t[2],10):1,e.numChannels=e.channels,e},u.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},u.parseExtmap=function(e){e=e.substr(9).split(" ");return{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},u.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},u.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<r.length;o++)n[(t=r[o].trim().split("="))[0].trim()]=t[1];return n},u.writeFmtp=function(t){var n,e="",r=t.payloadType;return void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length&&(n=[],Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"),e},u.parseRtcpFb=function(e){e=e.substr(e.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},u.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},u.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return-1<r?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},u.parseSsrcGroup=function(e){e=e.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},u.getMid=function(e){e=u.matchPrefix(e,"a=mid:")[0];if(e)return e.substr(6)},u.parseFingerprint=function(e){e=e.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},u.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:u.matchPrefix(e+t,"a=fingerprint:").map(u.parseFingerprint)}},u.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},u.getIceParameters=function(e,t){e=u.splitLines(e);return{usernameFragment:(e=e.concat(u.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:e.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},u.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},u.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=u.splitLines(e)[0].split(" "),r=3;r<n.length;r++){var o=n[r],i=u.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(i){var a=u.parseRtpMap(i),i=u.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=i.length?u.parseFmtp(i[0]):{},a.rtcpFeedback=u.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(u.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return u.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(u.parseExtmap(e))}),t},u.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=0<t.codecs.length?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=u.writeRtpMap(e),n+=u.writeFmtp(e),n+=u.writeRtcpFb(e)});var r=0;return t.codecs.forEach(function(e){e.maxptime>r&&(r=e.maxptime)}),0<r&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=u.writeExtmap(e)}),n},u.parseRtpEncodingParameters=function(e){var t,n=[],r=u.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),i=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<a.length&&a[0].ssrc,a=u.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<a.length&&1<a[0].length&&a[0][0]===s&&(t=a[0][1]),r.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)},s&&t&&(e.rtx={ssrc:t}),n.push(e),o&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:s,mechanism:i?"red+ulpfec":"red"},n.push(e)))}),0===n.length&&s&&n.push({ssrc:s});var c=u.matchPrefix(e,"b=");return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=c})),n},u.parseRtcpParameters=function(e){var t={},n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);n=u.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;e=u.matchPrefix(e,"a=rtcp-mux");return t.mux=0<e.length,t},u.parseMsid=function(e){var t,n=u.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};e=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<e.length?{stream:(t=e[0].value.split(" "))[0],track:t[1]}:void 0},u.parseSctpDescription=function(e){var t,n=u.parseMLine(e),r=u.matchPrefix(e,"a=max-message-size:");0<r.length&&(t=parseInt(r[0].substr(19),10)),isNaN(t)&&(t=65536);r=u.matchPrefix(e,"a=sctp-port:");if(0<r.length)return{port:parseInt(r[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(0<u.matchPrefix(e,"a=sctpmap:").length){e=u.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:t}}},u.writeSctpDescription=function(e,t){var n=[],n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"];return void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},u.generateSessionId=function(){return Math.random().toString().substr(2,21)},u.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||u.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},u.writeMediaSection=function(e,t,n,r){t=u.writeRtpDescription(e.kind,t);return t+=u.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=u.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),t+="a=mid:"+e.mid+"\r\n",e.direction?t+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(t+="a="+(r="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n"),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+u.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+u.localCName+"\r\n"),t},u.getDirection=function(e,t){for(var n=u.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return t?u.getDirection(t):"sendrecv"},u.getKind=function(e){return u.splitLines(e)[0].split(" ")[0].substr(2)},u.isRejected=function(e){return"0"===e.split(" ",2)[1]},u.parseMLine=function(e){e=u.splitLines(e)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},u.parseOLine=function(e){e=u.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},u.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=u.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=u)},{}],NJ2u:[function(e,t,n){"use strict";var x=e("sdp");function a(e,t,n,r,o){t=x.writeRtpDescription(e.kind,t);return t+=x.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=x.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),t+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(o=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=o,t+="a="+(o="msid:"+(r?r.id:"-")+" "+o+"\r\n"),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+x.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+x.localCName+"\r\n"),t}function M(r,o){function i(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]}var a={codecs:[],headerExtensions:[],fecMechanisms:[]};return r.codecs.forEach(function(n){for(var e=0;e<o.codecs.length;e++){var t=o.codecs[e];if(n.name.toLowerCase()===t.name.toLowerCase()&&n.clockRate===t.clockRate&&("rtx"!==n.name.toLowerCase()||!n.parameters||!t.parameters.apt||function(e,t,n,r){n=i(e.parameters.apt,n),r=i(t.parameters.apt,r);return n&&r&&n.name.toLowerCase()===r.name.toLowerCase()}(n,t,r.codecs,o.codecs))){(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(n.numChannels,t.numChannels),a.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),r.headerExtensions.forEach(function(e){for(var t=0;t<o.headerExtensions.length;t++){var n=o.headerExtensions[t];if(e.uri===n.uri){a.headerExtensions.push(n);break}}}),a}function i(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function j(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function p(e,t){t=new Error(t);return t.name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}t.exports=function(P,A){function R(e,t){t.addTrack(e),t.dispatchEvent(new P.MediaStreamTrackEvent("addtrack",{track:e}))}function o(e,t,n,r){var o=new Event("track");o.track=t,o.receiver=n,o.transceiver={receiver:n},o.streams=r,P.setTimeout(function(){e._dispatchEvent("track",o)})}function r(e){var t,r,o,n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw p("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=(t=e.iceServers||[],r=A,o=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var n="string"==typeof t;return n&&(t=[t]),t=t.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||o?0===e.indexOf("stun:")&&14393<=r&&-1===e.indexOf("?transport=udp"):o=!0}),delete e.url,e.urls=n?t[0]:t,!!t.length}})),this._iceGatherers=[],e.iceCandidatePoolSize)for(var a=e.iceCandidatePoolSize;0<a;a--)this._iceGatherers.push(new P.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=x.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}return Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),r.prototype.onicecandidate=null,r.prototype.onaddstream=null,r.prototype.ontrack=null,r.prototype.onremovestream=null,r.prototype.onsignalingstatechange=null,r.prototype.oniceconnectionstatechange=null,r.prototype.onconnectionstatechange=null,r.prototype.onicegatheringstatechange=null,r.prototype.onnegotiationneeded=null,r.prototype.ondatachannel=null,r.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},r.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},r.prototype.getConfiguration=function(){return this._config},r.prototype.getLocalStreams=function(){return this.localStreams},r.prototype.getRemoteStreams=function(){return this.remoteStreams},r.prototype._createTransceiver=function(e,t){var n=0<this.transceivers.length,e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};return this.usingBundle&&n?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(n=this._createIceAndDtlsTransports(),e.iceTransport=n.iceTransport,e.dtlsTransport=n.dtlsTransport),t||this.transceivers.push(e),e},r.prototype.addTrack=function(t,e){if(this._isClosed)throw p("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw p("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==t.kind||(n=this.transceivers[r]);return n=n||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),n.track=t,n.stream=e,n.rtpSender=new P.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},r.prototype.addStream=function(t){var r,n=this;15025<=A?t.getTracks().forEach(function(e){n.addTrack(e,t)}):(r=t.clone(),t.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)}))},r.prototype.removeTrack=function(t){if(this._isClosed)throw p("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof P.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw p("InvalidAccessError","Sender was not created by this connection.");var n=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&-1<this.localStreams.indexOf(n)&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},r.prototype.removeStream=function(e){var n=this;e.getTracks().forEach(function(t){var e=n.getSenders().find(function(e){return e.track===t});e&&n.removeTrack(e)})},r.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},r.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},r.prototype._createIceGatherer=function(n,e){var r=this;if(e&&0<n)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new P.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[n].bufferedCandidateEvents=[],this.transceivers[n].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;o.state=t?"completed":"gathering",null!==r.transceivers[n].bufferedCandidateEvents&&r.transceivers[n].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[n].bufferCandidates),o},r.prototype._gather=function(o,i){var e,a=this,s=this.transceivers[i].iceGatherer;s.onlocalcandidate||(e=this.transceivers[i].bufferedCandidateEvents,this.transceivers[i].bufferedCandidateEvents=null,s.removeEventListener("localcandidate",this.transceivers[i].bufferCandidates),s.onlocalcandidate=function(e){var t,n,r;a.usingBundle&&0<i||((t=new Event("icecandidate")).candidate={sdpMid:o,sdpMLineIndex:i},(e=!(n=e.candidate)||0===Object.keys(n).length)?"new"!==s.state&&"gathering"!==s.state||(s.state="completed"):("new"===s.state&&(s.state="gathering"),n.component=1,n.ufrag=s.getLocalParameters().usernameFragment,r=x.writeCandidate(n),t.candidate=Object.assign(t.candidate,x.parseCandidate(r)),t.candidate.candidate=r,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}),(r=x.getMediaSections(a._localDescription.sdp))[t.candidate.sdpMLineIndex]+=e?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",a._localDescription.sdp=x.getDescription(a._localDescription.sdp)+r.join(""),r=a.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}),"gathering"!==a.iceGatheringState&&(a.iceGatheringState="gathering",a._emitGatheringStateChange()),e||a._dispatchEvent("icecandidate",t),r&&(a._dispatchEvent("icecandidate",new Event("icecandidate")),a.iceGatheringState="complete",a._emitGatheringStateChange()))},P.setTimeout(function(){e.forEach(function(e){s.onlocalcandidate(e)})},0))},r.prototype._createIceAndDtlsTransports=function(){var e=this,t=new P.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var n=new P.RTCDtlsTransport(t);return n.ondtlsstatechange=function(){e._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:n}},r.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);t=this.transceivers[e].iceTransport;t&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport);t=this.transceivers[e].dtlsTransport;t&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},r.prototype._transceive=function(e,t,n){var r=M(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:x.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),n&&e.rtpReceiver&&0<r.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&A<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?r.encodings=e.recvEncodingParameters:r.encodings=[{}],r.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(r.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},r.prototype.setLocalDescription=function(e){var t,u,l,d=this;return-1===["offer","answer"].indexOf(e.type)?Promise.reject(p("TypeError",'Unsupported type "'+e.type+'"')):!i("setLocalDescription",e.type,d.signalingState)||d._isClosed?Promise.reject(p("InvalidStateError","Can not set local "+e.type+" in state "+d.signalingState)):("offer"===e.type?(t=x.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){e=x.parseRtpParameters(e);d.transceivers[t].localCapabilities=e}),d.transceivers.forEach(function(e,t){d._gather(e.mid,t)})):"answer"===e.type&&(t=x.splitSections(d._remoteDescription.sdp),u=t.shift(),l=0<x.matchPrefix(u,"a=ice-lite").length,t.forEach(function(e,t){var n,r=d.transceivers[t],o=r.iceGatherer,i=r.iceTransport,a=r.dtlsTransport,s=r.localCapabilities,c=r.remoteCapabilities;x.isRejected(e)&&0===x.matchPrefix(e,"a=bundle-only").length||r.rejected||(n=x.getIceParameters(e,u),e=x.getDtlsParameters(e,u),l&&(e.role="server"),d.usingBundle&&0!==t||(d._gather(r.mid,t),"new"===i.state&&i.start(o,n,l?"controlling":"controlled"),"new"===a.state&&a.start(e)),c=M(s,c),d._transceive(r,0<c.codecs.length,!1))})),d._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?d._updateSignalingState("have-local-offer"):d._updateSignalingState("stable"),Promise.resolve())},r.prototype.setRemoteDescription=function(w){var S=this;if(-1===["offer","answer"].indexOf(w.type))return Promise.reject(p("TypeError",'Unsupported type "'+w.type+'"'));if(!i("setRemoteDescription",w.type,S.signalingState)||S._isClosed)return Promise.reject(p("InvalidStateError","Can not set remote "+w.type+" in state "+S.signalingState));var k={};S.remoteStreams.forEach(function(e){k[e.id]=e});var C=[],e=x.splitSections(w.sdp),E=e.shift(),T=0<x.matchPrefix(E,"a=ice-lite").length,O=0<x.matchPrefix(E,"a=group:BUNDLE ").length;S.usingBundle=O;var t=x.matchPrefix(E,"a=ice-options:")[0];return S.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var n,r,o,i,a,s,c,u,l,d,p,f,h=x.splitLines(e),m=x.getKind(e),_=x.isRejected(e)&&0===x.matchPrefix(e,"a=bundle-only").length,g=h[0].substr(2).split(" ")[2],v=x.getDirection(e,E),y=x.parseMsid(e),b=x.getMid(e)||x.generateIdentifier();_||"application"===m&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g)?S.transceivers[t]={mid:b,kind:m,protocol:g,rejected:!0}:(!_&&S.transceivers[t]&&S.transceivers[t].rejected&&(S.transceivers[t]=S._createTransceiver(m,!0)),l=x.parseRtpParameters(e),_||(c=x.getIceParameters(e,E),(u=x.getDtlsParameters(e,E)).role="client"),i=x.parseRtpEncodingParameters(e),d=x.parseRtcpParameters(e),p=0<x.matchPrefix(e,"a=end-of-candidates",E).length,h=x.matchPrefix(e,"a=candidate:").map(function(e){return x.parseCandidate(e)}).filter(function(e){return 1===e.component}),("offer"===w.type||"answer"===w.type)&&!_&&O&&0<t&&S.transceivers[t]&&(S._disposeIceAndDtlsTransports(t),S.transceivers[t].iceGatherer=S.transceivers[0].iceGatherer,S.transceivers[t].iceTransport=S.transceivers[0].iceTransport,S.transceivers[t].dtlsTransport=S.transceivers[0].dtlsTransport,S.transceivers[t].rtpSender&&S.transceivers[t].rtpSender.setTransport(S.transceivers[0].dtlsTransport),S.transceivers[t].rtpReceiver&&S.transceivers[t].rtpReceiver.setTransport(S.transceivers[0].dtlsTransport)),"offer"!==w.type||_?"answer"!==w.type||_||(g=(n=S.transceivers[t]).iceGatherer,e=n.iceTransport,_=n.dtlsTransport,r=n.rtpReceiver,o=n.sendEncodingParameters,a=n.localCapabilities,S.transceivers[t].recvEncodingParameters=i,S.transceivers[t].remoteCapabilities=l,S.transceivers[t].rtcpParameters=d,h.length&&"new"===e.state&&(!T&&!p||O&&0!==t?h.forEach(function(e){j(n.iceTransport,e)}):e.setRemoteCandidates(h)),O&&0!==t||("new"===e.state&&e.start(g,c,"controlling"),"new"===_.state&&_.start(u)),!M(n.localCapabilities,n.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,S._transceive(n,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!r||"sendrecv"!==v&&"sendonly"!==v?delete n.rtpReceiver:(s=r.track,y?(k[y.stream]||(k[y.stream]=new P.MediaStream),R(s,k[y.stream]),C.push([s,r,k[y.stream]])):(k.default||(k.default=new P.MediaStream),R(s,k.default),C.push([s,r,k.default])))):((n=S.transceivers[t]||S._createTransceiver(m)).mid=b,n.iceGatherer||(n.iceGatherer=S._createIceGatherer(t,O)),h.length&&"new"===n.iceTransport.state&&(!p||O&&0!==t?h.forEach(function(e){j(n.iceTransport,e)}):n.iceTransport.setRemoteCandidates(h)),a=P.RTCRtpReceiver.getCapabilities(m),A<15019&&(a.codecs=a.codecs.filter(function(e){return"rtx"!==e.name})),o=n.sendEncodingParameters||[{ssrc:1001*(2*t+2)}],h=!1,"sendrecv"===v||"sendonly"===v?(h=!n.rtpReceiver,r=n.rtpReceiver||new P.RTCRtpReceiver(n.dtlsTransport,m),h&&(s=r.track,y&&"-"===y.stream||(f=y?(k[y.stream]||(k[y.stream]=new P.MediaStream,Object.defineProperty(k[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(s,"id",{get:function(){return y.track}}),k[y.stream]):(k.default||(k.default=new P.MediaStream),k.default)),f&&(R(s,f),n.associatedRemoteMediaStreams.push(f)),C.push([s,r,f]))):n.rtpReceiver&&n.rtpReceiver.track&&(n.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===n.rtpReceiver.track.id});t&&(t=t,(e=e).removeTrack(t),e.dispatchEvent(new P.MediaStreamTrackEvent("removetrack",{track:t})))}),n.associatedRemoteMediaStreams=[]),n.localCapabilities=a,n.remoteCapabilities=l,n.rtpReceiver=r,n.rtcpParameters=d,n.sendEncodingParameters=o,n.recvEncodingParameters=i,S._transceive(S.transceivers[t],!1,h)))}),void 0===S._dtlsRole&&(S._dtlsRole="offer"===w.type?"active":"passive"),S._remoteDescription={type:w.type,sdp:w.sdp},"offer"===w.type?S._updateSignalingState("have-remote-offer"):S._updateSignalingState("stable"),Object.keys(k).forEach(function(e){var t,r=k[e];r.getTracks().length&&(-1===S.remoteStreams.indexOf(r)&&(S.remoteStreams.push(r),(t=new Event("addstream")).stream=r,P.setTimeout(function(){S._dispatchEvent("addstream",t)})),C.forEach(function(e){var t=e[0],n=e[1];r.id===e[2].id&&o(S,t,n,[r])}))}),C.forEach(function(e){e[2]||o(S,e[0],e[1],[])}),P.setTimeout(function(){S&&S.transceivers&&S.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},r.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},r.prototype._updateSignalingState=function(e){this.signalingState=e;e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},r.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,P.setTimeout(function(){var e;t.needNegotiation&&(t.needNegotiation=!1,e=new Event("negotiationneeded"),t._dispatchEvent("negotiationneeded",e))},0))},r.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState&&(this.iceConnectionState=e,e=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",e))},r.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected&&(e="connected"),e!==this.connectionState&&(this.connectionState=e,e=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",e))},r.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject(p("InvalidStateError","Can not call createOffer after close"));var t=i.transceivers.filter(function(e){return"audio"===e.kind}).length,n=i.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(n=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(i.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--n<0&&(e.wantReceive=!1)});0<t||0<n;)0<t&&(i._createTransceiver("audio"),t--),0<n&&(i._createTransceiver("video"),n--);var r=x.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach(function(e,t){var n=e.track,r=e.kind,o=e.mid||x.generateIdentifier();e.mid=o,e.iceGatherer||(e.iceGatherer=i._createIceGatherer(t,i.usingBundle));o=P.RTCRtpSender.getCapabilities(r);A<15019&&(o.codecs=o.codecs.filter(function(e){return"rtx"!==e.name})),o.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),o.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});t=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];n&&15019<=A&&"video"===r&&!t[0].rtx&&(t[0].rtx={ssrc:t[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new P.RTCRtpReceiver(e.dtlsTransport,r)),e.localCapabilities=o,e.sendEncodingParameters=t}),"max-compat"!==i._config.bundlePolicy&&(r+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n",i.transceivers.forEach(function(e,t){r+=a(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),r+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,r+="a="+x.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(r+="a=end-of-candidates\r\n"))});e=new P.RTCSessionDescription({type:"offer",sdp:r});return Promise.resolve(e)},r.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(p("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(p("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var o=x.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(o+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var i=x.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,t){if(!(i<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?o+="m=application 0 DTLS/SCTP 5000\r\n":o+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");e.stream&&("audio"===e.kind?n=e.stream.getAudioTracks()[0]:"video"===e.kind&&(n=e.stream.getVideoTracks()[0]),n&&15019<=A&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n=M(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=a(e,n,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}});var e=new P.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(e)},r.prototype.addIceCandidate=function(s){var c,u=this;return s&&void 0===s.sdpMLineIndex&&!s.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!u._remoteDescription)return t(p("InvalidStateError","Can not add ICE candidate without a remote description"));if(s&&""!==s.candidate){var n=s.sdpMLineIndex;if(s.sdpMid)for(var r=0;r<u.transceivers.length;r++)if(u.transceivers[r].mid===s.sdpMid){n=r;break}var o=u.transceivers[n];if(!o)return t(p("OperationError","Can not add ICE candidate"));if(o.rejected)return e();var i=0<Object.keys(s.candidate).length?x.parseCandidate(s.candidate):{};if("tcp"===i.protocol&&(0===i.port||9===i.port))return e();if(i.component&&1!==i.component)return e();if((0===n||0<n&&o.iceTransport!==u.transceivers[0].iceTransport)&&!j(o.iceTransport,i))return t(p("OperationError","Can not add ICE candidate"));t=s.candidate.trim();0===t.indexOf("a=")&&(t=t.substr(2)),(c=x.getMediaSections(u._remoteDescription.sdp))[n]+="a="+(i.type?t:"end-of-candidates")+"\r\n",u._remoteDescription.sdp=x.getDescription(u._remoteDescription.sdp)+c.join("")}else for(var a=0;a<u.transceivers.length&&(u.transceivers[a].rejected||(u.transceivers[a].iceTransport.addRemoteCandidate({}),(c=x.getMediaSections(u._remoteDescription.sdp))[a]+="a=end-of-candidates\r\n",u._remoteDescription.sdp=x.getDescription(u._remoteDescription.sdp)+c.join(""),!u.usingBundle));a++);e()})},r.prototype.getStats=function(t){if(t&&t instanceof P.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw p("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&r.push(t[e].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t,e=P[e];e&&e.prototype&&e.prototype.getStats&&(t=e.prototype.getStats,e.prototype.getStats=function(){return t.apply(this).then(function(n){var r=new Map;return Object.keys(n).forEach(function(e){var t;n[e].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(t=n[e]).type]||t.type,r.set(e,n[e])}),r})})}),["createOffer","createAnswer"].forEach(function(e){var n=r.prototype[e];r.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?n.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=r.prototype[e];r.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?n.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):n.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=r.prototype[e];r.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),r}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var e=e&&e.navigator,t=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject({name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}})})}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var n,t=o.detectBrowser(e);e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)&&(n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled"),Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})),!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var r=(0,a.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils")),i=e("./filtericeservers"),a=(n=e("rtcpeerconnection-shim"))&&n.__esModule?n:{default:n},r=e("./getusermedia"),s=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t,n,r,o,i=s.detectBrowser(e),a=e&&e.navigator,e=e&&e.MediaStreamTrack;a.getUserMedia=function(e,t,n){s.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),a.mediaDevices.getUserMedia(e).then(t,n)},55<i.version&&"autoGainControl"in a.mediaDevices.getSupportedConstraints()||(t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},n=a.mediaDevices.getUserMedia.bind(a.mediaDevices),a.mediaDevices.getUserMedia=function(e){return"object"===c(e)&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),t(e.audio,"autoGainControl","mozAutoGainControl"),t(e.audio,"noiseSuppression","mozNoiseSuppression")),n(e)},e&&e.prototype.getSettings&&(r=e.prototype.getSettings,e.prototype.getSettings=function(){var e=r.apply(this,arguments);return t(e,"mozAutoGainControl","autoGainControl"),t(e,"mozNoiseSuppression","noiseSuppression"),e}),e&&e.prototype.applyConstraints&&(o=e.prototype.applyConstraints,e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===c(e)&&(e=JSON.parse(JSON.stringify(e)),t(e,"autoGainControl","mozAutoGainControl"),t(e,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[e])}))};var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e);e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(i){var e,r,o,a=s.detectBrowser(i);"object"===c(i)&&(i.RTCPeerConnection||i.mozRTCPeerConnection)&&(!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t,n,r,o=i.RTCPeerConnection.prototype[e],t=(r=function(){return arguments[0]=new("addIceCandidate"===e?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)},(n=e)in(t={})?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t);i.RTCPeerConnection.prototype[e]=t[e]}),a.version<68&&(e=i.RTCPeerConnection.prototype.addIceCandidate,i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}),r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=i.RTCPeerConnection.prototype.getStats,i.RTCPeerConnection.prototype.getStats=function(){var[e,t,n]=arguments;return o.apply(this,[e||null]).then(function(n){if(a.version<53&&!t)try{n.forEach(function(e){e.type=r[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:r[e.type]||e.type}))})}return n}).then(t,n)})},n.shimSenderGetStats=function(e){var n,t;"object"!==c(e)||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)})},n.shimReceiverGetStats=function(e){var n;"object"!==c(e)||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype||((n=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)})},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){var n=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){var o;"object"!==c(e)||!e.RTCPeerConnection||(o=e.RTCPeerConnection.prototype.addTransceiver)&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],t=e&&"sendEncodings"in e;t&&e.sendEncodings.forEach(function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")});var n,r=o.apply(this,arguments);return t&&({sender:n}=r,"encodings"in(t=n.getParameters())||(t.encodings=e.sendEncodings,this.setParametersPromises.push(n.setParameters(t).catch(function(){})))),r})},n.shimCreateOffer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createOffer,e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},n.shimCreateAnswer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createAnswer,e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils")),r=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){var r;"object"===c(e)&&e.RTCPeerConnection&&("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"addStream"in e.RTCPeerConnection.prototype||(r=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return r.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return r.call(n,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e){var t=arguments[1];return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),r.apply(this,arguments)}),"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n,r=this._localStreams.indexOf(e);-1!==r&&(this._localStreams.splice(r,1),n=e.getTracks(),this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)}))}))},n.shimRemoteStreamsAPI=function(e){var t;"object"!==c(e)||!e.RTCPeerConnection||("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams||[]}),"onaddstream"in e.RTCPeerConnection.prototype)||(Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var n=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.includes(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})})}}),t=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),0<=n._remoteStreams.indexOf(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})}),t.apply(n,arguments)})},n.shimCallbacksAPI=function(e){var t,r,o,i,a,s;"object"===c(e)&&e.RTCPeerConnection&&(t=e.RTCPeerConnection.prototype,r=t.createOffer,o=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate,t.createOffer=function(e,t){var n=2<=arguments.length?arguments[2]:e,n=r.apply(this,[n]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var n=2<=arguments.length?arguments[2]:e,n=o.apply(this,[n]);return t?(n.then(e,t),Promise.resolve()):n},e=function(e,t,n){e=i.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.setLocalDescription=e,e=function(e,t,n){e=a.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.setRemoteDescription=e,e=function(e,t,n){e=s.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.addIceCandidate=e)},n.shimGetUserMedia=function(e){var t,r=e&&e.navigator;r.mediaDevices&&r.mediaDevices.getUserMedia&&(e=r.mediaDevices,t=e.getUserMedia.bind(e),r.mediaDevices.getUserMedia=function(e){return t(o(e))}),!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(e,t,n){r.mediaDevices.getUserMedia(e).then(t,n)}.bind(r))},n.shimConstraints=o,n.shimRTCIceServerUrls=function(e){var i=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(a.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[r])}e.iceServers=n}return new i(e,t)},e.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return i.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t;return e&&(void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio),t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind}),!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),t=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveVideo||t||this.addTransceiver("video")),n.apply(this,arguments)}};var a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("../utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:a.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(t){var o;!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype||(o=t.RTCIceCandidate,t.RTCIceCandidate=function(e){if("object"===c(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new o(e),n=i.default.parseCandidate(e.candidate),r=Object.assign(t,n);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new o(e)},t.RTCIceCandidate.prototype=o.prototype,a.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))},n.shimMaxMessageSize=function(e){var r,o;e.RTCPeerConnection&&(r=a.detectBrowser(e),"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}}),o=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,t,n;return this._sctp=null,"chrome"===r.browser&&76<=r.version&&({sdpSemantics:n}=this.getConfiguration(),"plan-b"===n&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})),function(e){if(e&&e.sdp){e=i.default.splitSections(e.sdp);return e.shift(),e.some(function(e){e=i.default.parseMLine(e);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")})}}(arguments[0])&&(t=function(e){e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;e=parseInt(e[1],10);return e!=e?-1:e}(arguments[0]),n=65536,"firefox"===r.browser&&(n=r.version<57?-1===t?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),n=n,t=function(e,t){var n=65536;"firefox"===r.browser&&57===r.version&&(n=65535);e=i.default.matchPrefix(e.sdp,"a=max-message-size:");return 0<e.length?n=parseInt(e[0].substr(19),10):"firefox"===r.browser&&-1!==t&&(n=2147483637),n}(arguments[0],t),e=0===n&&0===t?Number.POSITIVE_INFINITY:0===n||0===t?Math.max(n,t):Math.min(n,t),t={},Object.defineProperty(t,"maxMessageSize",{get:function(){return e}}),this._sctp=t),o.apply(this,arguments)})},n.shimSendThrowTypeError=function(e){var t;function n(t,n){var r=t.send;t.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===t.readyState&&n.sctp&&e>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return r.apply(t,arguments)}}e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype&&(t=e.RTCPeerConnection.prototype.createDataChannel,e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},a.wrapPeerConnectionEvent(e,"datachannel",function(e){return n(e.channel,e.target),e}))},n.shimConnectionState=function(e){var n;!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype||(n=e.RTCPeerConnection.prototype,Object.defineProperty(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t,n=e.target;return n._lastConnectionState!==n.connectionState&&(n._lastConnectionState=n.connectionState,t=new Event("connectionstatechange",e),n.dispatchEvent(t)),e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))},n.removeAllowExtmapMixed=function(e){var t,n;e.RTCPeerConnection&&("chrome"===(t=a.detectBrowser(e)).browser&&71<=t.version||(n=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),n.apply(this,arguments)}))};var i=(n=e("sdp"))&&n.__esModule?n:{default:n},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}(e("./utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=i.log,r=i.detectBrowser(e),o={browserDetails:r,commonShim:l,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(r.browser){case"chrome":if(!a||!a.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;n("adapter.js shimming chrome."),(o.browserShim=a).shimGetUserMedia(e),a.shimMediaStream(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimAddTrackRemoveTrack(e),a.shimGetSendersWithDtmf(e),a.shimGetStats(e),a.shimSenderReceiverGetStats(e),a.fixNegotiationNeeded(e),l.shimRTCIceCandidate(e),l.shimConnectionState(e),l.shimMaxMessageSize(e),l.shimSendThrowTypeError(e),l.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),(o.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),c.shimAddTransceiver(e),c.shimCreateOffer(e),c.shimCreateAnswer(e),l.shimRTCIceCandidate(e),l.shimConnectionState(e),l.shimMaxMessageSize(e),l.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),o;n("adapter.js shimming edge."),(o.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),l.shimMaxMessageSize(e),l.shimSendThrowTypeError(e);break;case"safari":if(!u||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),(o.browserShim=u).shimRTCIceServerUrls(e),u.shimCreateOfferLegacy(e),u.shimCallbacksAPI(e),u.shimLocalStreamsAPI(e),u.shimRemoteStreamsAPI(e),u.shimTrackEventTransceiver(e),u.shimGetUserMedia(e),l.shimRTCIceCandidate(e),l.shimMaxMessageSize(e),l.shimSendThrowTypeError(e),l.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return o};var i=r(e("./utils")),a=r(e("./chrome/chrome_shim")),s=r(e("./edge/edge_shim")),c=r(e("./firefox/firefox_shim")),u=r(e("./safari/safari_shim")),l=r(e("./common_shim"));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=(n.default=void 0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=e},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});e=r(e("webrtc-adapter"));n.webRTCAdapter=e.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./adapter");function r(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}n.Supports=(r.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},r.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},r.prototype.getBrowser=function(){return o.webRTCAdapter.browserDetails.browser},r.prototype.getVersion=function(){return o.webRTCAdapter.browserDetails.version||0},r.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=o.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&59<=n)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;var r=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),r=!0}catch(e){}finally{e&&e.close()}return r},r.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},new r)},{"./adapter":"sXtV"}],BHXf:[function(e,t,c){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(c,"__esModule",{value:!0});var r=n(e("peerjs-js-binarypack")),o=e("./supports"),i={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};function a(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=i,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(i),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=r.pack,this.unpack=r.unpack,this._dataCount=1}c.util=(a.prototype.noop=function(){},a.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},a.prototype.chunk=function(e){for(var t=[],n=e.size,r=Math.ceil(n/c.util.chunkedMTU),o=0,i=0;i<n;){var a=Math.min(n,i+c.util.chunkedMTU),s=e.slice(i,a),s={__peerData:this._dataCount,n:o,data:s,total:r};t.push(s),i=a,o++}return this._dataCount++,t},a.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},a.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},a.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},a.prototype.isSecure=function(){return"https:"===location.protocol},new a)},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,f="~";function o(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");o=new i(n,r||e,o),t=f?f+t:t;return e._events[t]?e._events[t].fn?e._events[t]=[e._events[t],o]:e._events[t].push(o):(e._events[t]=o,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(f=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(f?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var e=f?f+e:e,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,o=new Array(r);n<r;n++)o[n]=t[n].fn;return o},s.prototype.listenerCount=function(e){e=f?f+e:e,e=this._events[e];return e?e.fn?1:e.length:0},s.prototype.emit=function(e,t,n,r,o,i){var a=f?f+e:e;if(!this._events[a])return!1;var s,c=this._events[a],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,o),!0;case 6:return c.fn.call(c.context,t,n,r,o,i),!0}for(p=1,s=new Array(u-1);p<u;p++)s[p-1]=arguments[p];c.fn.apply(c.context,s)}else for(var l,d=c.length,p=0;p<d;p++)switch(c[p].once&&this.removeListener(e,c[p].fn,void 0,!0),u){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,t);break;case 3:c[p].fn.call(c[p].context,t,n);break;case 4:c[p].fn.call(c[p].context,t,n,r);break;default:if(!s)for(l=1,s=new Array(u-1);l<u;l++)s[l-1]=arguments[l];c[p].fn.apply(c[p].context,s)}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,n,r){e=f?f+e:e;if(!this._events[e])return this;if(!t)return c(this,e),this;var o=this._events[e];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||c(this,e);else{for(var i=0,a=[],s=o.length;i<s;i++)(o[i].fn!==t||r&&!o[i].once||n&&o[i].context!==n)&&a.push(o[i]);a.length?this._events[e]=1===a.length?a[0]:a:c(this,e)}return this},s.prototype.removeAllListeners=function(e){return e?(e=f?f+e:e,this._events[e]&&c(this,e)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=f,s.EventEmitter=s,void 0!==t&&(t.exports=s)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var a;(o=a=n.LogLevel||(n.LogLevel={}))[o.Disabled=0]="Disabled",o[o.Errors=1]="Errors",o[o.Warnings=2]="Warnings",o[o.All=3]="All";var o=(Object.defineProperty(s.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),s.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.All&&this._print.apply(this,i([a.All],e))},s.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.Warnings&&this._print.apply(this,i([a.Warnings],e))},s.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.Errors&&this._print.apply(this,i([a.Errors],e))},s.prototype.setLogFunction=function(e){this._print=e},s.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=i(["PeerJS: "],t);for(r in o)o[r]instanceof Error&&(o[r]="("+o[r].name+") "+o[r].message);a.All<=e?console.log.apply(console,i(o)):a.Warnings<=e?console.warn.apply(console,i(["WARNING"],o)):a.Errors<=e&&console.error.apply(console,i(["ERROR"],o))},s);function s(){this._logLevel=a.Disabled}n.default=new o},{}],ZRYf:[function(e,t,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),(r=n.ConnectionEventType||(n.ConnectionEventType={})).Open="open",r.Stream="stream",r.Data="data",r.Close="close",r.Error="error",r.IceStateChanged="iceStateChanged",(r=n.ConnectionType||(n.ConnectionType={})).Data="data",r.Media="media",(r=n.PeerEventType||(n.PeerEventType={})).Open="open",r.Close="close",r.Connection="connection",r.Call="call",r.Disconnected="disconnected",r.Error="error",(r=n.PeerErrorType||(n.PeerErrorType={})).BrowserIncompatible="browser-incompatible",r.Disconnected="disconnected",r.InvalidID="invalid-id",r.InvalidKey="invalid-key",r.Network="network",r.PeerUnavailable="peer-unavailable",r.SslUnavailable="ssl-unavailable",r.ServerError="server-error",r.SocketError="socket-error",r.SocketClosed="socket-closed",r.UnavailableID="unavailable-id",r.WebRTC="webrtc",(r=n.SerializationType||(n.SerializationType={})).Binary="binary",r.BinaryUTF8="binary-utf8",r.JSON="json",(r=n.SocketEventType||(n.SocketEventType={})).Message="message",r.Disconnected="disconnected",r.Error="error",r.Close="close",(n=n.ServerMessageType||(n.ServerMessageType={})).Heartbeat="HEARTBEAT",n.Candidate="CANDIDATE",n.Offer="OFFER",n.Answer="ANSWER",n.Open="OPEN",n.Error="ERROR",n.IdTaken="ID-TAKEN",n.InvalidKey="INVALID-KEY",n.Leave="LEAVE",n.Expire="EXPIRE"},{}],wJlv:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var u,l=e("eventemitter3"),d=c(e("./logger")),p=e("./enums"),o=(u=l.EventEmitter,o(f,u),f.prototype.start=function(e,t){var n=this;this._id=e;t=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(t),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),d.default.log("Server message received:",t)}catch(t){return void d.default.log("Invalid server message",e.data)}n.emit(p.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(d.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(p.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),d.default.log("Socket open"),n._scheduleHeartbeat())})},f.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout(function(){e._sendHeartbeat()},this.pingInterval)},f.prototype._sendHeartbeat=function(){var e;this._wsOpen()?(e=JSON.stringify({type:p.ServerMessageType.Heartbeat}),this._socket.send(e),this._scheduleHeartbeat()):d.default.log("Cannot send heartbeat, because socket closed")},f.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},f.prototype._sendQueuedMessages=function(){var e,t,n=a(this._messagesQueue);this._messagesQueue=[];try{for(var r=s(n),o=r.next();!o.done;o=r.next()){var i=o.value;this.send(i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},f.prototype.send=function(e){var t;this._disconnected||(this._id?e.type?this._wsOpen()&&(t=JSON.stringify(e),this._socket.send(t)):this.emit(p.SocketEventType.Error,"Invalid message"):this._messagesQueue.push(e))},f.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},f.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},f);function f(e,t,n,r,o,i){void 0===i&&(i=5e3);var a=u.call(this)||this;a.pingInterval=i,a._disconnected=!0,a._messagesQueue=[];e=e?"wss://":"ws://";return a._baseUrl=e+t+":"+n+r+"peerjs?key="+o,a}n.Socket=o},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(n,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),c=o(e("./logger")),u=e("./enums"),e=(l.prototype.startConnection=function(e){var t,n,r=this._startPeerConnection();this.connection.peerConnection=r,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,r),e.originator?(this.connection.type===u.ConnectionType.Data&&(t=this.connection,n={ordered:!!e.reliable},n=r.createDataChannel(t.label,n),t.initialize(n)),this._makeOffer()):this.handleSDP("OFFER",e.sdp)},l.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},l.prototype._setupListeners=function(e){var n=this,r=this.connection.peer,o=this.connection.connectionId,t=this.connection.type,i=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+r+":",e.candidate),i.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:t,connectionId:o},dst:r}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+r),n.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+r+" failed.")),n.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+r),n.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+r+" closed.")),n.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+r);break;case"completed":e.onicecandidate=a.util.noop}n.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");e=e.channel;i.getConnection(r,o).initialize(e)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var t=e.streams[0],e=i.getConnection(r,o);e.type===u.ConnectionType.Media&&n._addStreamToMediaConnection(t,e)}},l.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e,t,n,r=this.connection.peerConnection;r&&(this.connection.peerConnection=null,r.onicecandidate=r.oniceconnectionstatechange=r.ondatachannel=r.ontrack=function(){},e="closed"!==r.signalingState,t=!1,this.connection.type!==u.ConnectionType.Data||(n=this.connection.dataChannel)&&(t=!!n.readyState&&"closed"!==n.readyState),(e||t)&&r.close())},l.prototype._makeOffer=function(){return r(this,void 0,Promise,function(){var t,n,r,o;return s(this,function(e){switch(e.label){case 0:n=this.connection.peerConnection,t=this.connection.provider,e.label=1;case 1:return e.trys.push([1,7,,8]),[4,n.createOffer(this.connection.options.constraints)];case 2:r=e.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,n.setLocalDescription(r)];case 4:return e.sent(),c.default.log("Set localDescription:",r,"for:"+this.connection.peer),n={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:a.util.browser},this.connection.type===u.ConnectionType.Data&&(r=this.connection,n=i(i({},n),{label:r.label,reliable:r.reliable,serialization:r.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:n,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(o=e.sent())&&(t.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to setLocalDescription, ",o)),[3,6];case 6:return[3,8];case 7:return o=e.sent(),t.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to createOffer, ",o),[3,8];case 8:return[2]}})})},l.prototype._makeAnswer=function(){return r(this,void 0,Promise,function(){var t,n,r,o;return s(this,function(e){switch(e.label){case 0:t=this.connection.peerConnection,n=this.connection.provider,e.label=1;case 1:return e.trys.push([1,7,,8]),[4,t.createAnswer()];case 2:r=e.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,t.setLocalDescription(r)];case 4:return e.sent(),c.default.log("Set localDescription:",r,"for:"+this.connection.peer),n.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,browser:a.util.browser},dst:this.connection.peer}),[3,6];case 5:return o=e.sent(),n.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to setLocalDescription, ",o),[3,6];case 6:return[3,8];case 7:return o=e.sent(),n.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to create answer, ",o),[3,8];case 8:return[2]}})})},l.prototype.handleSDP=function(o,i){return r(this,void 0,Promise,function(){var t,n,r;return s(this,function(e){switch(e.label){case 0:i=new RTCSessionDescription(i),t=this.connection.peerConnection,n=this.connection.provider,c.default.log("Setting remote description",i),r=this,e.label=1;case 1:return e.trys.push([1,5,,6]),[4,t.setRemoteDescription(i)];case 2:return e.sent(),c.default.log("Set remoteDescription:"+o+" for:"+this.connection.peer),"OFFER"!==o?[3,4]:[4,r._makeAnswer()];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:return r=e.sent(),n.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setRemoteDescription, ",r),[3,6];case 6:return[2]}})})},l.prototype.handleCandidate=function(a){return r(this,void 0,Promise,function(){var t,n,r,o,i;return s(this,function(e){switch(e.label){case 0:c.default.log("handleCandidate:",a),i=a.candidate,t=a.sdpMLineIndex,n=a.sdpMid,r=this.connection.peerConnection,o=this.connection.provider,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.addIceCandidate(new RTCIceCandidate({sdpMid:n,sdpMLineIndex:t,candidate:i}))];case 2:return e.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return i=e.sent(),o.emitError(u.PeerErrorType.WebRTC,i),c.default.log("Failed to handleCandidate, ",i),[3,4];case 4:return[2]}})})},l.prototype._addTracksToConnection=function(t,n){if(c.default.log("add tracks from stream "+t.id+" to peer connection"),!n.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach(function(e){n.addTrack(e,t)})},l.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},l);function l(e){this.connection=e}n.Negotiator=e},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i,o=(i=e("eventemitter3").EventEmitter,o(a,i),Object.defineProperty(a.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),a);function a(e,t,n){var r=i.call(this)||this;return r.peer=e,r.provider=t,r.options=n,r._open=!1,r.metadata=n.metadata,r}n.BaseConnection=o},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a,s=e("./util"),l=i(e("./logger")),d=e("./negotiator"),p=e("./enums"),o=(a=e("./baseconnection").BaseConnection,o(f,a),Object.defineProperty(f.prototype,"type",{get:function(){return p.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),f.prototype.addStream=function(e){l.default.log("Receiving stream",e),this._remoteStream=e,a.prototype.emit.call(this,p.ConnectionEventType.Stream,e)},f.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case p.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case p.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:l.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},f.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)l.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(c(c({},this.options._payload),{_stream:e}));var o=this.provider._getMessages(this.connectionId);try{for(var i=u(o),a=i.next();!a.done;a=i.next()){var s=a.value;this.handleMessage(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this._open=!0}},f.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,a.prototype.emit.call(this,p.ConnectionEventType.Close))},f.ID_PREFIX="mc_",f);function f(e,t,n){n=a.call(this,e,t,n)||this;return n._localStream=n.options._stream,n.connectionId=n.options.connectionId||f.ID_PREFIX+s.util.randomToken(),n._negotiator=new d.Negotiator(n),n._localStream&&n._negotiator.startConnection({_stream:n._localStream,originator:!0}),n}n.MediaConnection=o},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a,s=e("eventemitter3"),c=i(e("./logger")),o=(a=s.EventEmitter,o(u,a),Object.defineProperty(u.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),u.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},u.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},u.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},u);function u(){var t=a.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){c.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}n.EncodingQueue=o},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a,c=e("./util"),u=i(e("./logger")),l=e("./negotiator"),d=e("./enums"),i=e("./baseconnection"),p=e("./encodingQueue"),o=(a=i.BaseConnection,o(f,a),Object.defineProperty(f.prototype,"type",{get:function(){return d.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),f.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},f.prototype._configureDataChannel=function(){var t=this;c.util.supports.binaryBlob&&!c.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){u.default.log("DC#"+t.connectionId+" dc connection success"),t._open=!0,t.emit(d.ConnectionEventType.Open)},this.dataChannel.onmessage=function(e){u.default.log("DC#"+t.connectionId+" dc onmessage:",e.data),t._handleDataMessage(e)},this.dataChannel.onclose=function(){u.default.log("DC#"+t.connectionId+" dc closed for:",t.peer),t.close()}},f.prototype._handleDataMessage=function(e){var t=this,n=e.data,r=n.constructor,e=n;if(this.serialization===d.SerializationType.Binary||this.serialization===d.SerializationType.BinaryUTF8){if(r===Blob)return void c.util.blobToArrayBuffer(n,function(e){e=c.util.unpack(e);t.emit(d.ConnectionEventType.Data,e)});r===ArrayBuffer?e=c.util.unpack(n):r===String&&(r=c.util.binaryStringToArrayBuffer(n),e=c.util.unpack(r))}else this.serialization===d.SerializationType.JSON&&(e=this.parse(n));e.__peerData?this._handleChunk(e):a.prototype.emit.call(this,d.ConnectionEventType.Data,e)},f.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};n.data[e.n]=e.data,n.count++,(this._chunkedData[t]=n).total===n.count&&(delete this._chunkedData[t],n=new Blob(n.data),this._handleDataMessage({data:n}))},f.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,a.prototype.emit.call(this,d.ConnectionEventType.Close))},f.prototype.send=function(e,t){var n;this.open?this.serialization===d.SerializationType.JSON?this._bufferedSend(this.stringify(e)):this.serialization===d.SerializationType.Binary||this.serialization===d.SerializationType.BinaryUTF8?(n=c.util.pack(e),!t&&n.size>c.util.chunkedMTU?this._sendChunks(n):c.util.supports.binaryBlob?this._bufferedSend(n):this._encodingQueue.enque(n)):this._bufferedSend(e):a.prototype.emit.call(this,d.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},f.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},f.prototype._trySend=function(e){var t=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>f.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){t._buffering=!1,t._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(e){return u.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},f.prototype._tryBuffer=function(){var e;this.open&&0!==this._buffer.length&&(e=this._buffer[0],this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer()))},f.prototype._sendChunks=function(e){var t,n,r=c.util.chunk(e);u.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var o=s(r),i=o.next();!i.done;i=o.next()){var a=i.value;this.send(a,!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},f.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case d.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case d.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:u.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},f.ID_PREFIX="dc_",f.MAX_BUFFERED_AMOUNT=8388608,f);function f(e,t,n){var r=a.call(this,e,t,n)||this;return r.stringify=JSON.stringify,r.parse=JSON.parse,r._buffer=[],r._bufferSize=0,r._buffering=!1,r._chunkedData={},r._encodingQueue=new p.EncodingQueue,r.connectionId=r.options.connectionId||f.ID_PREFIX+c.util.randomToken(),r.label=r.options.label||r.connectionId,r.serialization=r.options.serialization||d.SerializationType.Binary,r.reliable=!!r.options.reliable,r._encodingQueue.on("done",function(e){r._bufferedSend(e)}),r._encodingQueue.on("error",function(){u.default.error("DC#"+r.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),r.close()}),r._negotiator=new l.Negotiator(r),r._negotiator.startConnection(r.options._payload||{originator:!0}),r}n.DataConnection=o},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=i(e("./logger")),e=(c.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},c.prototype.retrieveId=function(){return r(this,void 0,Promise,function(){var t,n;return o(this,function(e){switch(e.label){case 0:t=this._buildUrl("id"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(n=e.sent()).status)throw new Error("Error. Status:"+n.status);return[2,n.text()];case 3:throw n=e.sent(),s.default.error("Error retrieving ID",n),n="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n);case 4:return[2]}})})},c.prototype.listAllPeers=function(){return r(this,void 0,Promise,function(){var t,n;return o(this,function(e){switch(e.label){case 0:t=this._buildUrl("peers"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200===(n=e.sent()).status)return[2,n.json()];if(401===n.status)throw t=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t);throw new Error("Error. Status:"+n.status);case 3:throw n=e.sent(),s.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 4:return[2]}})})},c);function c(e){this._options=e}n.API=e},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c,u=e("eventemitter3"),l=e("./util"),f=a(e("./logger")),d=e("./socket"),h=e("./mediaconnection"),m=e("./dataconnection"),_=e("./enums"),g=e("./api"),o=(c=u.EventEmitter,o(v,c),Object.defineProperty(v.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=p(this._connections),o=r.next();!o.done;o=r.next()){var i=s(o.value,2),a=i[0],i=i[1];n[a]=i}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),v.prototype._createServerConnection=function(){var t=this,e=new d.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(_.SocketEventType.Message,function(e){t._handleMessage(e)}),e.on(_.SocketEventType.Error,function(e){t._abort(_.PeerErrorType.SocketError,e)}),e.on(_.SocketEventType.Disconnected,function(){t.disconnected||(t.emitError(_.PeerErrorType.Network,"Lost connection to server."),t.disconnect())}),e.on(_.SocketEventType.Close,function(){t.disconnected||t._abort(_.PeerErrorType.SocketClosed,"Underlying socket is already closed.")}),e},v.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},v.prototype._handleMessage=function(e){var t,n,r=e.type,o=e.payload,i=e.src;switch(r){case _.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(_.PeerEventType.Open,this.id);break;case _.ServerMessageType.Error:this._abort(_.PeerErrorType.ServerError,o.msg);break;case _.ServerMessageType.IdTaken:this._abort(_.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case _.ServerMessageType.InvalidKey:this._abort(_.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case _.ServerMessageType.Leave:f.default.log("Received leave message from "+i),this._cleanupPeer(i),this._connections.delete(i);break;case _.ServerMessageType.Expire:this.emitError(_.PeerErrorType.PeerUnavailable,"Could not connect to peer "+i);break;case _.ServerMessageType.Offer:var a=o.connectionId;if((d=this.getConnection(i,a))&&(d.close(),f.default.warn("Offer received for existing Connection ID:"+a)),o.type===_.ConnectionType.Media)d=new h.MediaConnection(i,this,{connectionId:a,_payload:o,metadata:o.metadata}),this._addConnection(i,d),this.emit(_.PeerEventType.Call,d);else{if(o.type!==_.ConnectionType.Data)return void f.default.warn("Received malformed connection type:"+o.type);d=new m.DataConnection(i,this,{connectionId:a,_payload:o,metadata:o.metadata,label:o.label,serialization:o.serialization,reliable:o.reliable}),this._addConnection(i,d),this.emit(_.PeerEventType.Connection,d)}var s=this._getMessages(a);try{for(var c=p(s),u=c.next();!u.done;u=c.next()){var l=u.value;d.handleMessage(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}break;default:if(!o)return void f.default.warn("You received a malformed message from "+i+" of type "+r);var d,a=o.connectionId;(d=this.getConnection(i,a))&&d.peerConnection?d.handleMessage(e):a?this._storeMessage(a,e):f.default.warn("You received an unrecognized message:",e)}},v.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},v.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},v.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return f.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(_.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");t=new m.DataConnection(e,this,t);return this._addConnection(e,t),t},v.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return f.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(_.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;n=new h.MediaConnection(e,this,n);return this._addConnection(e,n),n}f.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},v.prototype._addConnection=function(e,t){f.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},v.prototype._removeConnection=function(e){var t,n=this._connections.get(e.peer);!n||-1!==(t=n.indexOf(e))&&n.splice(t,1),this._lostMessages.delete(e.connectionId)},v.prototype.getConnection=function(e,t){var n,r,o=this._connections.get(e);if(!o)return null;try{for(var i=p(o),a=i.next();!a.done;a=i.next()){var s=a.value;if(s.connectionId===t)return s}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null},v.prototype._delayedAbort=function(e,t){var n=this;setTimeout(function(){n._abort(e,t)},0)},v.prototype._abort=function(e,t){f.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},v.prototype.emitError=function(e,t){f.default.error("Error:",t),(t="string"==typeof t?new Error(t):t).type=e,this.emit(_.PeerEventType.Error,t)},v.prototype.destroy=function(){this.destroyed||(f.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(_.PeerEventType.Close))},v.prototype._cleanup=function(){var e,t;try{for(var n=p(this._connections.keys()),r=n.next();!r.done;r=n.next()){var o=r.value;this._cleanupPeer(o),this._connections.delete(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},v.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var o=p(r),i=o.next();!i.done;i=o.next())i.value.close()}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},v.prototype.disconnect=function(){var e;this.disconnected||(e=this.id,f.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(_.PeerEventType.Disconnected,e))},v.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)f.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");f.default.error("In a hurry? We're still trying to make the initial connection!")}},v.prototype.listAllPeers=function(t){var n=this;void 0===t&&(t=function(e){}),this._api.listAllPeers().then(function(e){return t(e)}).catch(function(e){return n._abort(_.PeerErrorType.ServerError,e)})},v.DEFAULT_KEY="peerjs",v);function v(e,t){var n,r=c.call(this)||this;return r._id=null,r._lastServerId=null,r._destroyed=!1,r._disconnected=!1,r._open=!1,r._connections=new Map,r._lostMessages=new Map,e&&e.constructor==Object?t=e:e&&(n=e.toString()),t=i({debug:0,host:l.util.CLOUD_HOST,port:l.util.CLOUD_PORT,path:"/",key:v.DEFAULT_KEY,token:l.util.randomToken(),config:l.util.defaultConfig},t),r._options=t,"/"===r._options.host&&(r._options.host=window.location.hostname),r._options.path&&("/"!==r._options.path[0]&&(r._options.path="/"+r._options.path),"/"!==r._options.path[r._options.path.length-1]&&(r._options.path+="/")),void 0===r._options.secure&&r._options.host!==l.util.CLOUD_HOST?r._options.secure=l.util.isSecure():r._options.host==l.util.CLOUD_HOST&&(r._options.secure=!0),r._options.logFunction&&f.default.setLogFunction(r._options.logFunction),f.default.logLevel=r._options.debug||0,r._api=new g.API(t),r._socket=r._createServerConnection(),l.util.supports.audioVideo||l.util.supports.data?n&&!l.util.validateId(n)?r._delayedAbort(_.PeerErrorType.InvalidID,'ID "'+n+'" is invalid'):n?r._initialize(n):r._api.retrieveId().then(function(e){return r._initialize(e)}).catch(function(e){return r._abort(_.PeerErrorType.ServerError,e)}):r._delayedAbort(_.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),r}n.Peer=o},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),e=e("./peer");n.peerjs={Peer:e.Peer,util:r.util},n.default=e.Peer,window.peerjs=n.peerjs,window.Peer=e.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t,n){var i=n(154),r=n(63),a=n(82),s=n(46)("socket.io-client");e.exports=t=o;var c=t.managers={};function o(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n=i(e),r=n.source,o=n.id,e=n.path,e=c[o]&&e in c[o].nsps,o=t.forceNew||t["force new connection"]||!1===t.multiplex||e?(s("ignoring socket cache for %s",r),a(r,t)):(c[o]||(s("new io instance for %s",r),c[o]=a(r,t)),c[o]);return n.query&&!t.query&&(t.query=n.query),o.socket(n.path,t)}t.protocol=r.protocol,t.connect=o,t.Manager=n(82),t.Socket=n(88)},function(e,t){e.exports=function n(e){var t,r=new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","googlebot","baiduspider","gurujibot","yandexbot","slurp","msnbot","bingbot","facebookexternalhit","linkedinbot","twitterbot","slackbot","telegrambot","applebot","pingdom","tumblr ","Embedly","spbot"].join("|")+").*$"),o={version:!1,language:!1,platform:!0,os:!0,pixelDepth:!0,colorDepth:!0,resolution:!1,isAuthoritative:!0,silkAccelerated:!0,isKindleFire:!0,isDesktop:!0,isMobile:!0,isTablet:!0,isWindows:!0,isLinux:!0,isLinux64:!0,isChromeOS:!0,isMac:!0,isiPad:!0,isiPhone:!0,isiPod:!0,isAndroid:!0,isSamsung:!0,isSmartTV:!0,isRaspberry:!0,isBlackberry:!0,isTouchScreen:!0,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,source:!1,cpuCores:!1};for(t in e=e||{})e.hasOwnProperty(t)&&void 0!==o[t]&&(o[t]=e[t]);return this.options=o,this.version="1.0.0",this._Versions={Edge:/Edge\/([\d\w\.\-]+)/i,Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])|trident\/\d+\.\d+;.*[rv:]+(\d+\.\d)/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Chromium:/(?:chromium|crios)\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Opera:/version\/([\d\w\.\-]+)|OPR\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i,Amaya:/amaya\/([\d\w\.\-]+)/i,SeaMonkey:/seamonkey\/([\d\w\.\-]+)/i,OmniWeb:/omniweb\/v([\d\w\.\-]+)/i,Flock:/flock\/([\d\w\.\-]+)/i,Epiphany:/epiphany\/([\d\w\.\-]+)/i,WinJs:/msapphost\/([\d\w\.\-]+)/i,PhantomJS:/phantomjs\/([\d\w\.\-]+)/i,UC:/UCBrowser\/([\d\w\.]+)/i},this._Browsers={Edge:/edge/i,Amaya:/amaya/i,Konqueror:/konqueror/i,Epiphany:/epiphany/i,SeaMonkey:/seamonkey/i,Flock:/flock/i,OmniWeb:/omniweb/i,Chromium:/chromium|crios/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie|trident/i,Opera:/opera|OPR/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i,WinJs:/msapphost/i,PhantomJS:/phantomjs/i,UC:/UCBrowser/i},this._OS={Windows10:/windows nt 10\.0/i,Windows81:/windows nt 6\.3/i,Windows8:/windows nt 6\.2/i,Windows7:/windows nt 6\.1/i,UnknownWindows:/windows nt 6\.\d+/i,WindowsVista:/windows nt 6\.0/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,WindowsPhone8:/windows phone 8\./,OSXCheetah:/os x 10[._]0/i,OSXPuma:/os x 10[._]1(\D|$)/i,OSXJaguar:/os x 10[._]2/i,OSXPanther:/os x 10[._]3/i,OSXTiger:/os x 10[._]4/i,OSXLeopard:/os x 10[._]5/i,OSXSnowLeopard:/os x 10[._]6/i,OSXLion:/os x 10[._]7/i,OSXMountainLion:/os x 10[._]8/i,OSXMavericks:/os x 10[._]9/i,OSXYosemite:/os x 10[._]10/i,OSXElCapitan:/os x 10[._]11/i,OSXSierra:/os x 10[._]12/i,Mac:/os x/i,Linux:/linux/i,Linux64:/linux x86_64/i,ChromeOS:/cros/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,iPad:/\(iPad.*os (\d+)[._](\d+)/i,iPhone:/\(iPhone.*os (\d+)[._](\d+)/i,Bada:/Bada\/(\d+)\.(\d+)/i,Curl:/curl\/(\d+)\.(\d+)\.(\d+)/i},this._Platform={Windows:/windows nt/i,WindowsPhone:/windows phone/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,iPad:/ipad/i,iPod:/ipod/i,iPhone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i,Samsung:/samsung/i,Curl:/curl/i},this.DefaultAgent={isAuthoritative:!0,isMobile:!1,isTablet:!1,isiPad:!1,isiPod:!1,isiPhone:!1,isAndroid:!1,isBlackberry:!1,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,isDesktop:!1,isWindows:!1,isLinux:!1,isLinux64:!1,isMac:!1,isChromeOS:!1,isBada:!1,isSamsung:!1,isRaspberry:!1,isBot:!1,isCurl:!1,isAndroidTablet:!1,isWinJs:!1,isKindleFire:!1,isSilk:!1,isCaptive:!1,isSmartTV:!1,isUC:!1,isTouchScreen:!1,silkAccelerated:!1,colorDepth:-1,pixelDepth:-1,resolution:[],cpuCores:-1,language:"unknown",browser:"unknown",version:"unknown",os:"unknown",platform:"unknown",geoIp:{},source:"",hashInt:function(e){var t,n,r=0;if(0===e.length)return r;for(t=0,n=e.length;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r},hashMD5:function(e){function s(e,t){return e<<t|e>>>32-t}function c(e,t){var n=2147483648&e,r=2147483648&t,o=(1073741823&e)+(1073741823&t);return(e=1073741824&e)&(t=1073741824&t)?2147483648^o^n^r:e|t?1073741824&o?3221225472^o^n^r:1073741824^o^n^r:o^n^r}function t(e,t,n,r,o,i,a){return e=c(e,c(c(t&n|~t&r,o),a)),c(s(e,i),t)}function n(e,t,n,r,o,i,a){return e=c(e,c(c(t&r|n&~r,o),a)),c(s(e,i),t)}function r(e,t,n,r,o,i,a){return e=c(e,c(c(t^n^r,o),a)),c(s(e,i),t)}function o(e,t,n,r,o,i,a){return e=c(e,c(c(n^(t|~r),o),a)),c(s(e,i),t)}function i(e){for(var t="",n="",r=0;r<=3;r++)t+=(n="0"+(e>>>8*r&255).toString(16)).substr(n.length-2,2);return t}for(var a,u,l,d,p=function(e){for(var t,n=e.length,r=n+8,r=16*((r-r%64)/64+1),o=new Array(r-1),i=0,a=0;a<n;)i=a%4*8,o[t=(a-a%4)/4]=o[t]|e.charCodeAt(a)<<i,a++;return i=a%4*8,o[t=(a-a%4)/4]=o[t]|128<<i,o[r-2]=n<<3,o[r-1]=n>>>29,o}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t}(e)),f=1732584193,h=4023233417,m=2562383102,_=271733878,g=0;g<p.length;g+=16)f=t(a=f,u=h,l=m,d=_,p[g+0],7,3614090360),_=t(_,f,h,m,p[g+1],12,3905402710),m=t(m,_,f,h,p[g+2],17,606105819),h=t(h,m,_,f,p[g+3],22,3250441966),f=t(f,h,m,_,p[g+4],7,4118548399),_=t(_,f,h,m,p[g+5],12,1200080426),m=t(m,_,f,h,p[g+6],17,2821735955),h=t(h,m,_,f,p[g+7],22,4249261313),f=t(f,h,m,_,p[g+8],7,1770035416),_=t(_,f,h,m,p[g+9],12,2336552879),m=t(m,_,f,h,p[g+10],17,4294925233),h=t(h,m,_,f,p[g+11],22,2304563134),f=t(f,h,m,_,p[g+12],7,1804603682),_=t(_,f,h,m,p[g+13],12,4254626195),m=t(m,_,f,h,p[g+14],17,2792965006),f=n(f,h=t(h,m,_,f,p[g+15],22,1236535329),m,_,p[g+1],5,4129170786),_=n(_,f,h,m,p[g+6],9,3225465664),m=n(m,_,f,h,p[g+11],14,643717713),h=n(h,m,_,f,p[g+0],20,3921069994),f=n(f,h,m,_,p[g+5],5,3593408605),_=n(_,f,h,m,p[g+10],9,38016083),m=n(m,_,f,h,p[g+15],14,3634488961),h=n(h,m,_,f,p[g+4],20,3889429448),f=n(f,h,m,_,p[g+9],5,568446438),_=n(_,f,h,m,p[g+14],9,3275163606),m=n(m,_,f,h,p[g+3],14,4107603335),h=n(h,m,_,f,p[g+8],20,1163531501),f=n(f,h,m,_,p[g+13],5,2850285829),_=n(_,f,h,m,p[g+2],9,4243563512),m=n(m,_,f,h,p[g+7],14,1735328473),f=r(f,h=n(h,m,_,f,p[g+12],20,2368359562),m,_,p[g+5],4,4294588738),_=r(_,f,h,m,p[g+8],11,2272392833),m=r(m,_,f,h,p[g+11],16,1839030562),h=r(h,m,_,f,p[g+14],23,4259657740),f=r(f,h,m,_,p[g+1],4,2763975236),_=r(_,f,h,m,p[g+4],11,1272893353),m=r(m,_,f,h,p[g+7],16,4139469664),h=r(h,m,_,f,p[g+10],23,3200236656),f=r(f,h,m,_,p[g+13],4,681279174),_=r(_,f,h,m,p[g+0],11,3936430074),m=r(m,_,f,h,p[g+3],16,3572445317),h=r(h,m,_,f,p[g+6],23,76029189),f=r(f,h,m,_,p[g+9],4,3654602809),_=r(_,f,h,m,p[g+12],11,3873151461),m=r(m,_,f,h,p[g+15],16,530742520),f=o(f,h=r(h,m,_,f,p[g+2],23,3299628645),m,_,p[g+0],6,4096336452),_=o(_,f,h,m,p[g+7],10,1126891415),m=o(m,_,f,h,p[g+14],15,2878612391),h=o(h,m,_,f,p[g+5],21,4237533241),f=o(f,h,m,_,p[g+12],6,1700485571),_=o(_,f,h,m,p[g+3],10,2399980690),m=o(m,_,f,h,p[g+10],15,4293915773),h=o(h,m,_,f,p[g+1],21,2240044497),f=o(f,h,m,_,p[g+8],6,1873313359),_=o(_,f,h,m,p[g+15],10,4264355552),m=o(m,_,f,h,p[g+6],15,2734768916),h=o(h,m,_,f,p[g+13],21,1309151649),f=o(f,h,m,_,p[g+4],6,4149444226),_=o(_,f,h,m,p[g+11],10,3174756917),m=o(m,_,f,h,p[g+2],15,718787259),h=o(h,m,_,f,p[g+9],21,3951481745),f=c(f,a),h=c(h,u),m=c(m,l),_=c(_,d);return(i(f)+i(h)+i(m)+i(_)).toLowerCase()}},this.Agent={},this.getBrowser=function(e){switch(!0){case this._Browsers.Edge.test(e):return this.Agent.isEdge=!0,"Edge";case this._Browsers.PhantomJS.test(e):return this.Agent.isPhantomJS=!0,"PhantomJS";case this._Browsers.Konqueror.test(e):return this.Agent.isKonqueror=!0,"Konqueror";case this._Browsers.Amaya.test(e):return this.Agent.isAmaya=!0,"Amaya";case this._Browsers.Epiphany.test(e):return this.Agent.isEpiphany=!0,"Epiphany";case this._Browsers.SeaMonkey.test(e):return this.Agent.isSeaMonkey=!0,"SeaMonkey";case this._Browsers.Flock.test(e):return this.Agent.isFlock=!0,"Flock";case this._Browsers.OmniWeb.test(e):return this.Agent.isOmniWeb=!0,"OmniWeb";case this._Browsers.Opera.test(e):return this.Agent.isOpera=!0,"Opera";case this._Browsers.Chromium.test(e):return this.Agent.isChrome=!0,"Chromium";case this._Browsers.Chrome.test(e):return this.Agent.isChrome=!0,"Chrome";case this._Browsers.Safari.test(e):return this.Agent.isSafari=!0,"Safari";case this._Browsers.WinJs.test(e):return this.Agent.isWinJs=!0,"WinJs";case this._Browsers.IE.test(e):return this.Agent.isIE=!0,"IE";case this._Browsers.PS3.test(e):return"ps3";case this._Browsers.PSP.test(e):return"psp";case this._Browsers.Firefox.test(e):return this.Agent.isFirefox=!0,"Firefox";case this._Browsers.UC.test(e):return this.Agent.isUC=!0,"UCBrowser";default:return 0!==e.indexOf("Mozilla")&&/^([\d\w\-\.]+)\/[\d\w\.\-]+/i.test(e)?(this.Agent.isAuthoritative=!1,RegExp.$1):"unknown"}},this.getBrowserVersion=function(e){switch(this.Agent.browser){case"Edge":if(this._Versions.Edge.test(e))return RegExp.$1;break;case"PhantomJS":if(this._Versions.PhantomJS.test(e))return RegExp.$1;break;case"Chrome":if(this._Versions.Chrome.test(e))return RegExp.$1;break;case"Chromium":if(this._Versions.Chromium.test(e))return RegExp.$1;break;case"Safari":if(this._Versions.Safari.test(e))return RegExp.$1;break;case"Opera":if(this._Versions.Opera.test(e))return RegExp.$1||RegExp.$2;break;case"Firefox":if(this._Versions.Firefox.test(e))return RegExp.$1;break;case"WinJs":if(this._Versions.WinJs.test(e))return RegExp.$1;break;case"IE":if(this._Versions.IE.test(e))return RegExp.$2||RegExp.$1;break;case"ps3":if(this._Versions.Ps3.test(e))return RegExp.$1;break;case"psp":if(this._Versions.Psp.test(e))return RegExp.$1;break;case"Amaya":if(this._Versions.Amaya.test(e))return RegExp.$1;break;case"Epiphany":if(this._Versions.Epiphany.test(e))return RegExp.$1;break;case"SeaMonkey":if(this._Versions.SeaMonkey.test(e))return RegExp.$1;break;case"Flock":if(this._Versions.Flock.test(e))return RegExp.$1;break;case"OmniWeb":if(this._Versions.OmniWeb.test(e))return RegExp.$1;break;case"UCBrowser":if(this._Versions.UC.test(e))return RegExp.$1;break;default:if("unknown"!==this.Agent.browser&&new RegExp(this.Agent.browser+"[\\/ ]([\\d\\w\\.\\-]+)","i").test(e))return RegExp.$1}},this.getOS=function(e){switch(!0){case this._OS.WindowsVista.test(e):return this.Agent.isWindows=!0,"Windows Vista";case this._OS.Windows7.test(e):return this.Agent.isWindows=!0,"Windows 7";case this._OS.Windows8.test(e):return this.Agent.isWindows=!0,"Windows 8";case this._OS.Windows81.test(e):return this.Agent.isWindows=!0,"Windows 8.1";case this._OS.Windows10.test(e):return this.Agent.isWindows=!0,"Windows 10.0";case this._OS.Windows2003.test(e):return this.Agent.isWindows=!0,"Windows 2003";case this._OS.WindowsXP.test(e):return this.Agent.isWindows=!0,"Windows XP";case this._OS.Windows2000.test(e):return this.Agent.isWindows=!0,"Windows 2000";case this._OS.WindowsPhone8.test(e):return"Windows Phone 8";case this._OS.Linux64.test(e):return this.Agent.isLinux=!0,this.Agent.isLinux64=!0,"Linux 64";case this._OS.Linux.test(e):return this.Agent.isLinux=!0,"Linux";case this._OS.ChromeOS.test(e):return this.Agent.isChromeOS=!0,"Chrome OS";case this._OS.Wii.test(e):return"Wii";case this._OS.PS3.test(e):case this._OS.PSP.test(e):return"Playstation";case this._OS.OSXCheetah.test(e):return this.Agent.isMac=!0,"OS X Cheetah";case this._OS.OSXPuma.test(e):return this.Agent.isMac=!0,"OS X Puma";case this._OS.OSXJaguar.test(e):return this.Agent.isMac=!0,"OS X Jaguar";case this._OS.OSXPanther.test(e):return this.Agent.isMac=!0,"OS X Panther";case this._OS.OSXTiger.test(e):return this.Agent.isMac=!0,"OS X Tiger";case this._OS.OSXLeopard.test(e):return this.Agent.isMac=!0,"OS X Leopard";case this._OS.OSXSnowLeopard.test(e):return this.Agent.isMac=!0,"OS X Snow Leopard";case this._OS.OSXLion.test(e):return this.Agent.isMac=!0,"OS X Lion";case this._OS.OSXMountainLion.test(e):return this.Agent.isMac=!0,"OS X Mountain Lion";case this._OS.OSXMavericks.test(e):return this.Agent.isMac=!0,"OS X Mavericks";case this._OS.OSXYosemite.test(e):return this.Agent.isMac=!0,"OS X Yosemite";case this._OS.OSXElCapitan.test(e):return this.Agent.isMac=!0,"OS X El Capitan";case this._OS.OSXSierra.test(e):return this.Agent.isMac=!0,"macOS Sierra";case this._OS.Mac.test(e):return this.Agent.isMac=!0,"OS X";case this._OS.iPad.test(e):return this.Agent.isiPad=!0,e.match(this._OS.iPad)[0].replace("_",".");case this._OS.iPhone.test(e):return this.Agent.isiPhone=!0,e.match(this._OS.iPhone)[0].replace("_",".");case this._OS.Bada.test(e):return this.Agent.isBada=!0,"Bada";case this._OS.Curl.test(e):return this.Agent.isCurl=!0,"Curl";default:return"unknown"}},this.getPlatform=function(e){switch(!0){case this._Platform.Windows.test(e):return"Microsoft Windows";case this._Platform.WindowsPhone.test(e):return this.Agent.isWindowsPhone=!0,"Microsoft Windows Phone";case this._Platform.Mac.test(e):return"Apple Mac";case this._Platform.Curl.test(e):return"Curl";case this._Platform.Android.test(e):return this.Agent.isAndroid=!0,"Android";case this._Platform.Blackberry.test(e):return this.Agent.isBlackberry=!0,"Blackberry";case this._Platform.Linux.test(e):return"Linux";case this._Platform.Wii.test(e):return"Wii";case this._Platform.Playstation.test(e):return"Playstation";case this._Platform.iPad.test(e):return this.Agent.isiPad=!0,"iPad";case this._Platform.iPod.test(e):return this.Agent.isiPod=!0,"iPod";case this._Platform.iPhone.test(e):return this.Agent.isiPhone=!0,"iPhone";case this._Platform.Samsung.test(e):return this.Agent.isiSamsung=!0,"Samsung";default:return"unknown"}},this.testCompatibilityMode=function(){var e,t,n=this;this.Agent.isIE&&/Trident\/(\d)\.0/i.test(n.Agent.source)&&(e=parseInt(RegExp.$1,10),7===(t=parseInt(n.Agent.version,10))&&7===e&&(n.Agent.isIECompatibilityMode=!0,n.Agent.version=11),7===t&&6===e&&(n.Agent.isIECompatibilityMode=!0,n.Agent.version=10),7===t&&5===e&&(n.Agent.isIECompatibilityMode=!0,n.Agent.version=9),7===t&&4===e&&(n.Agent.isIECompatibilityMode=!0,n.Agent.version=8))},this.testSilk=function(){return!0===new RegExp("silk","gi").test(this.Agent.source)&&(this.Agent.isSilk=!0),/Silk-Accelerated=true/gi.test(this.Agent.source)&&(this.Agent.SilkAccelerated=!0),!!this.Agent.isSilk&&"Silk"},this.testKindleFire=function(){switch(!0){case/KFOT/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire";case/KFTT/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD";case/KFJWI/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9";case/KFJWA/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9 4G";case/KFSOWI/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 7";case/KFTHWI/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7";case/KFTHWA/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7 4G";case/KFAPWI/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9";case/KFAPWA/gi.test(this.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9 4G";default:return!1}},this.testCaptiveNetwork=function(){return!0===/CaptiveNetwork/gi.test(this.Agent.source)&&(this.Agent.isCaptive=!0,this.Agent.isMac=!0,this.Agent.platform="Apple Mac","CaptiveNetwork")},this.testMobile=function(){var e=this;switch(!0){case e.Agent.isWindows:case e.Agent.isLinux:case e.Agent.isMac:case e.Agent.isChromeOS:e.Agent.isDesktop=!0;break;case e.Agent.isAndroid:case e.Agent.isSamsung:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}switch(!0){case e.Agent.isiPad:case e.Agent.isiPod:case e.Agent.isiPhone:case e.Agent.isBada:case e.Agent.isBlackberry:case e.Agent.isAndroid:case e.Agent.isWindowsPhone:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}/mobile/i.test(e.Agent.source)&&(e.Agent.isMobile=!0,e.Agent.isDesktop=!1)},this.testTablet=function(){switch(!0){case this.Agent.isiPad:case this.Agent.isAndroidTablet:case this.Agent.isKindleFire:this.Agent.isTablet=!0}/tablet/i.test(this.Agent.source)&&(this.Agent.isTablet=!0)},this.testNginxGeoIP=function(t){var n=this;Object.keys(t).forEach(function(e){/^GEOIP/i.test(e)&&(n.Agent.geoIp[e]=t[e])})},this.testBot=function(){var e=r.exec(this.Agent.source.toLowerCase());e?this.Agent.isBot=e[1]:this.Agent.isAuthoritative||(this.Agent.isBot=/bot/i.test(this.Agent.source))},this.testSmartTV=function(){var e=new RegExp("smart-tv|smarttv|googletv|appletv|hbbtv|pov_tv|netcast.tv","gi").exec(this.Agent.source.toLowerCase());e&&(this.Agent.isSmartTV=e[1])},this.testAndroidTablet=function(){this.Agent.isAndroid&&!/mobile/i.test(this.Agent.source)&&(this.Agent.isAndroidTablet=!0)},this.testTouchSupport=function(){this.Agent.isTouchScreen="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints},this.getLaguage=function(){this.Agent.language=(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase()},this.getColorDepth=function(){this.Agent.colorDepth=screen.colorDepth||-1},this.getScreenResolution=function(){this.Agent.resolution=[screen.availWidth,screen.availHeight]},this.getPixelDepth=function(){this.Agent.pixelDepth=screen.pixelDepth||-1},this.getCPU=function(){this.Agent.cpuCores=navigator.hardwareConcurrency||-1},this.reset=function(){for(var e in this.DefaultAgent)this.DefaultAgent.hasOwnProperty(e)&&(this.Agent[e]=this.DefaultAgent[e]);return this},this.parse=function(e){e=e||navigator.userAgent;var t=new n;return t.Agent.source=e.replace(/^\s*/,"").replace(/\s*$/,""),t.Agent.os=t.getOS(t.Agent.source),t.Agent.platform=t.getPlatform(t.Agent.source),t.Agent.browser=t.getBrowser(t.Agent.source),t.Agent.version=t.getBrowserVersion(t.Agent.source),t.testBot(),t.testSmartTV(),t.testMobile(),t.testAndroidTablet(),t.testTablet(),t.testCompatibilityMode(),t.testSilk(),t.testKindleFire(),t.testCaptiveNetwork(),t.testTouchSupport(),t.getLaguage(),t.getColorDepth(),t.getPixelDepth(),t.getScreenResolution(),t.getCPU(),t.Agent},this.get=function(e){var t,n=this.parse(),r=[];for(t in this.options)this.options.hasOwnProperty(t)&&!0===this.options[t]&&r.push(n[t]);e&&r.push(e),!this.options.resolution&&n.isMobile&&r.push(n.resolution);e=n.hashMD5(r.join(":"));return[e.slice(0,8),e.slice(8,12),"4"+e.slice(12,15),"b"+e.slice(15,18),e.slice(20)].join("-")},this.Agent=this.DefaultAgent,this}},function(e,t,n){"use strict";function r(e){var t,e=e.Symbol;return"function"==typeof e?e.observable?t=e.observable:(t=e("observable"),e.observable=t):t="@@observable",t}n.d(t,"a",function(){return r})},function(e,t,n){n(180),e.exports=n(181)},function(e,t,n){e.exports=(e=n(5),n(48),n(100),n(101),n(38),n(39),n(59),n(69),n(102),n(70),n(103),n(104),n(105),n(60),n(106),n(36),n(16),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),e)},function(e,t,n){var o;e.exports=(e=n(5),"function"==typeof ArrayBuffer&&(n=e.lib.WordArray,o=n.init,(n.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,n=[],r=0;r<t;r++)n[r>>>2]|=e[r]<<24-r%4*8;o.call(this,n,t)}else o.apply(this,arguments)}).prototype=n),e.lib.WordArray)},function(e,t,n){var o;function a(e){return e<<8&4278255360|e>>>8&16711935}e.exports=(e=n(5),o=e.lib.WordArray,(n=e.enc).Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return o.create(n,2*t)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=a(t[o>>>2]>>>16-o%4*8&65535);r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>1]|=a(e.charCodeAt(r)<<16-r%2*16);return o.create(n,2*t)}},e.enc.Utf16)},function(e,t,n){var r,o,i;e.exports=(i=n(5),n(69),r=(e=i).lib.WordArray,n=e.algo,o=n.SHA256,n=n.SHA224=o.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}}),e.SHA224=o._createHelper(n),e.HmacSHA224=o._createHmacHelper(n),i.SHA224)},function(e,t,n){var r,o,i,a;e.exports=(a=n(5),n(48),n(70),n=(e=a).x64,r=n.Word,o=n.WordArray,n=e.algo,i=n.SHA512,n=n.SHA384=i.extend({_doReset:function(){this._hash=new o.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}}),e.SHA384=i._createHelper(n),e.HmacSHA384=i._createHmacHelper(n),a.SHA384)},function(e,t,n){var o;e.exports=(o=n(5),n(48),function(l){var e=o,t=e.lib,d=t.WordArray,r=t.Hasher,p=e.x64.Word,t=e.algo,T=[],O=[],P=[];!function(){for(var e=1,t=0,n=0;n<24;n++){T[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5,e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)O[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var a,s=0,c=0,u=0;u<7;u++)1&o&&((a=(1<<u)-1)<32?c^=1<<a:s^=1<<a-32),128&o?o=o<<1^113:o<<=1;P[i]=p.create(s,c)}}();var A=[];!function(){for(var e=0;e<25;e++)A[e]=p.create()}();t=t.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new p.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=16711935&((i=e[t+2*o])<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&((a=e[t+2*o+1])<<8|a>>>24)|4278255360&(a<<24|a>>>8);(S=n[o]).high^=a,S.low^=i}for(var s=0;s<24;s++){for(var c=0;c<5;c++){for(var u=0,l=0,d=0;d<5;d++)u^=(S=n[c+5*d]).high,l^=S.low;var p=A[c];p.high=u,p.low=l}for(c=0;c<5;c++)for(var f=A[(c+4)%5],h=A[(c+1)%5],m=h.high,h=h.low,u=f.high^(m<<1|h>>>31),l=f.low^(h<<1|m>>>31),d=0;d<5;d++)(S=n[c+5*d]).high^=u,S.low^=l;for(var _=1;_<25;_++){var g=(S=n[_]).high,v=S.low,y=T[_];l=y<32?(u=g<<y|v>>>32-y,v<<y|g>>>32-y):(u=v<<y-32|g>>>64-y,g<<y-32|v>>>64-y);y=A[O[_]];y.high=u,y.low=l}var b=A[0],w=n[0];for(b.high=w.high,b.low=w.low,c=0;c<5;c++)for(d=0;d<5;d++){var S=n[_=c+5*d],k=A[_],C=A[(c+1)%5+5*d],E=A[(c+2)%5+5*d];S.high=k.high^~C.high&E.high,S.low=k.low^~C.low&E.low}S=n[0];w=P[s];S.high^=w.high,S.low^=w.low}},_doFinalize:function(){var e=this._data,t=e.words,n=(this._nDataBytes,8*e.sigBytes),r=32*this.blockSize;t[n>>>5]|=1<<24-n%32,t[(l.ceil((1+n)/r)*r>>>5)-1]|=128,e.sigBytes=4*t.length,this._process();for(var o=this._state,t=this.cfg.outputLength/8,i=t/8,a=[],s=0;s<i;s++){var c=o[s],u=16711935&((u=c.high)<<8|u>>>24)|4278255360&(u<<24|u>>>8),c=16711935&((c=c.low)<<8|c>>>24)|4278255360&(c<<24|c>>>8);a.push(c),a.push(u)}return new d.init(a,t)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});e.SHA3=r._createHelper(t),e.HmacSHA3=r._createHmacHelper(t)}(Math),o.SHA3)},function(e,t,n){var r,o,i,k,C,E,T,O,P;function A(e,t,n){return e&t|~e&n}function R(e,t,n){return e&n|t&~n}function x(e,t){return e<<t|e>>>32-t}e.exports=(r=n(5),Math,n=(e=r).lib,o=n.WordArray,i=n.Hasher,n=e.algo,k=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),C=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),E=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),O=o.create([0,1518500249,1859775393,2400959708,2840853838]),P=o.create([1352829926,1548603684,1836072691,2053994217,0]),n=n.RIPEMD160=i.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}for(var i,a,s,c,u,l,d=this._hash.words,p=O.words,f=P.words,h=k.words,m=C.words,_=E.words,g=T.words,v=i=d[0],y=a=d[1],b=s=d[2],w=c=d[3],S=u=d[4],n=0;n<80;n+=1)l=i+e[t+h[n]]|0,l+=n<16?(a^s^c)+p[0]:n<32?A(a,s,c)+p[1]:n<48?((a|~s)^c)+p[2]:n<64?R(a,s,c)+p[3]:(a^(s|~c))+p[4],l=(l=x(l|=0,_[n]))+u|0,i=u,u=c,c=x(s,10),s=a,a=l,l=v+e[t+m[n]]|0,l+=n<16?(y^(b|~w))+f[0]:n<32?R(y,b,w)+f[1]:n<48?((y|~b)^w)+f[2]:n<64?A(y,b,w)+f[3]:(y^b^w)+f[4],l=(l=x(l|=0,g[n]))+S|0,v=S,S=w,w=x(b,10),b=y,y=l;l=d[1]+s+w|0,d[1]=d[2]+c+S|0,d[2]=d[3]+u+v|0,d[3]=d[4]+i+y|0,d[4]=d[0]+a+b|0,d[0]=l},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var t=this._hash,o=t.words,i=0;i<5;i++){var a=o[i];o[i]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return t},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),e.RIPEMD160=i._createHelper(n),e.HmacRIPEMD160=i._createHmacHelper(n),r.RIPEMD160)},function(e,t,n){var r,g,o,v,i,a;e.exports=(a=n(5),n(59),n(60),e=(o=(r=a).lib).Base,g=o.WordArray,o=(n=r.algo).SHA1,v=n.HMAC,i=n.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=v.create(n.hasher,e),o=g.create(),i=g.create([1]),a=o.words,s=i.words,c=n.keySize,u=n.iterations;a.length<c;){var l=r.update(t).finalize(i);r.reset();for(var d=l.words,p=d.length,f=l,h=1;h<u;h++){f=r.finalize(f),r.reset();for(var m=f.words,_=0;_<p;_++)d[_]^=m[_]}o.concat(l),s[0]++}return o.sigBytes=4*c,o}}),r.PBKDF2=function(e,t,n){return i.create(n).compute(e,t)},a.PBKDF2)},function(e,t,n){function i(e,t,n,r){var o,i=this._iv;i?(o=i.slice(0),this._iv=void 0):o=this._prevBlock,r.encryptBlock(o,0);for(var a=0;a<n;a++)e[t+a]^=o[a]}e.exports=(e=n(5),n(16),e.mode.CFB=((n=e.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;i.call(this,e,t,r,n),this._prevBlock=e.slice(t,t+r)}}),n.Decryptor=n.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);i.call(this,e,t,r,n),this._prevBlock=o}}),n),e.mode.CFB)},function(e,t,n){var r;e.exports=(r=n(5),n(16),r.mode.CTR=(n=(e=r.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[r-1]=i[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}}),e.Decryptor=n,e),r.mode.CTR)},function(e,t,n){var r;function c(e){var t,n,r;return 255==(e>>24&255)?(n=e>>8&255,r=255&e,255===(t=e>>16&255)?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r):e+=1<<24,e}e.exports=(r=n(5),n(16),r.mode.CTRGladman=(e=r.lib.BlockCipherMode.extend(),n=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0),0===((o=i)[0]=c(o[0]))&&(o[1]=c(o[1]));var a=i.slice(0);n.encryptBlock(a,0);for(var s=0;s<r;s++)e[t+s]^=a[s]}}),e.Decryptor=n,e),r.mode.CTRGladman)},function(e,t,n){var r;e.exports=(r=n(5),n(16),r.mode.OFB=(n=(e=r.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}}),e.Decryptor=n,e),r.mode.OFB)},function(e,t,n){e.exports=(e=n(5),n(16),e.mode.ECB=((n=e.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),n.Decryptor=n.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),n),e.mode.ECB)},function(e,t,n){e.exports=(e=n(5),n(16),e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,t=4*t,t=t-n%t,n=n+t-1;e.clamp(),e.words[n>>>2]|=t<<24-n%4*8,e.sigBytes+=t},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923)},function(e,t,n){var r;e.exports=(r=n(5),n(16),r.pad.Iso10126={pad:function(e,t){t*=4,t-=e.sigBytes%t;e.concat(r.lib.WordArray.random(t-1)).concat(r.lib.WordArray.create([t<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)},function(e,t,n){var r;e.exports=(r=n(5),n(16),r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)},function(e,t,n){e.exports=(e=n(5),n(16),e.pad.ZeroPadding={pad:function(e,t){t*=4;e.clamp(),e.sigBytes+=t-(e.sigBytes%t||t)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},e.pad.ZeroPadding)},function(e,t,n){e.exports=(e=n(5),n(16),e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding)},function(e,t,n){var r,o;e.exports=(e=n(5),n(16),r=e.lib.CipherParams,o=e.enc.Hex,e.format.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){e=o.parse(e);return r.create({ciphertext:e})}},e.format.Hex)},function(e,t,n){var r;e.exports=(r=n(5),n(38),n(39),n(36),n(16),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,u=[],l=[],d=[],p=[],f=[],h=[],m=[],_=[],g=[],v=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=0,r=0,t=0;t<256;t++){var o=(o=r^r<<1^r<<2^r<<3^r<<4)>>>8^255&o^99;u[n]=o;var i=e[l[o]=n],a=e[i],s=e[a],c=257*e[o]^16843008*o;d[n]=c<<24|c>>>8,p[n]=c<<16|c>>>16,f[n]=c<<8|c>>>24,h[n]=c,c=16843009*s^65537*a^257*i^16843008*n,m[o]=c<<24|c>>>8,_[o]=c<<16|c>>>16,g[o]=c<<8|c>>>24,v[o]=c,n?(n=i^e[e[e[s^i]]],r^=e[e[r]]):n=r=1}}();var y=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e,t=this._keyPriorReset=this._key,n=t.words,r=t.sigBytes/4,o=4*(1+(this._nRounds=6+r)),i=this._keySchedule=[],a=0;a<o;a++)a<r?i[a]=n[a]:(e=i[a-1],a%r?6<r&&a%r==4&&(e=u[e>>>24]<<24|u[e>>>16&255]<<16|u[e>>>8&255]<<8|u[255&e]):(e=u[(e=e<<8|e>>>24)>>>24]<<24|u[e>>>16&255]<<16|u[e>>>8&255]<<8|u[255&e],e^=y[a/r|0]<<24),i[a]=i[a-r]^e);for(var s=this._invKeySchedule=[],c=0;c<o;c++)a=o-c,e=c%4?i[a]:i[a-4],s[c]=c<4||a<=4?e:m[u[e>>>24]]^_[u[e>>>16&255]]^g[u[e>>>8&255]]^v[u[255&e]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,d,p,f,h,u)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,m,_,g,v,l),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],f=4,h=1;h<c;h++)var m=r[u>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&p]^n[f++],_=r[l>>>24]^o[d>>>16&255]^i[p>>>8&255]^a[255&u]^n[f++],g=r[d>>>24]^o[p>>>16&255]^i[u>>>8&255]^a[255&l]^n[f++],v=r[p>>>24]^o[u>>>16&255]^i[l>>>8&255]^a[255&d]^n[f++],u=m,l=_,d=g,p=v;m=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[f++],_=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^n[f++],g=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^n[f++],v=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[f++],e[t]=m,e[t+1]=_,e[t+2]=g,e[t+3]=v},keySize:8});e.AES=t._createHelper(n)}(),r.AES)},function(e,t,n){var i;e.exports=(i=n(5),n(38),n(39),n(36),n(16),function(){var e=i,t=e.lib,n=t.WordArray,r=t.BlockCipher,t=e.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],o=t.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=u[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){for(var a=o[i]=[],s=d[i],n=0;n<24;n++)a[n/6|0]|=t[(l[n]-1+s)%28]<<31-n%6,a[4+(n/6|0)]|=t[28+(l[n+24]-1+s)%28]<<31-n%6;for(a[0]=a[0]<<1|a[0]>>>31,n=1;n<7;n++)a[n]=a[n]>>>4*(n-1)+3;a[7]=a[7]<<5|a[7]>>>27}var c=this._invSubKeys=[];for(n=0;n<16;n++)c[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),h.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=n[r],i=this._lBlock,a=this._rBlock,s=0,c=0;c<8;c++)s|=p[c][((a^o[c])&f[c])>>>0];this._lBlock=a,this._rBlock=i^s}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,h.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){t=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=t,this._lBlock^=t<<e}function m(e,t){t=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=t,this._rBlock^=t<<e}e.DES=r._createHelper(o);t=t.TripleDES=r.extend({_doReset:function(){var e=this._key.words;this._des1=o.createEncryptor(n.create(e.slice(0,2))),this._des2=o.createEncryptor(n.create(e.slice(2,4))),this._des3=o.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=r._createHelper(t)}(),i.TripleDES)},function(e,t,n){var i;e.exports=(i=n(5),n(38),n(39),n(36),n(16),function(){var e=i,t=e.lib.StreamCipher,n=e.algo,r=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;o<256;o++)r[o]=o;for(var i=o=0;o<256;o++){var a=o%n,a=t[a>>>2]>>>24-a%4*8&255,i=(i+r[o]+a)%256,a=r[o];r[o]=r[i],r[i]=a}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}e.RC4=t._createHelper(r);n=n.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)o.call(this)}});e.RC4Drop=t._createHelper(n)}(),i.RC4)},function(e,t,n){var r,o,i,a,s;function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,i=r>>>16,i=((o*o>>>17)+o*i>>>15)+i*i,r=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=i^r}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.exports=(r=n(5),n(38),n(39),n(36),n(16),e=(o=r).lib.StreamCipher,n=o.algo,i=[],a=[],s=[],n=n.Rabbit=e.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);for(var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],n=this._b=0;n<4;n++)c.call(this);for(n=0;n<8;n++)o[n]^=r[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],t=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),i=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),a=t>>>16|4294901760&i,s=i<<16|65535&t;for(o[0]^=t,o[1]^=a,o[2]^=i,o[3]^=s,o[4]^=t,o[5]^=a,o[6]^=i,o[7]^=s,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2}),o.Rabbit=e._createHelper(n),r.Rabbit)},function(e,t,n){var r,o,i,a,s;function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,i=r>>>16,i=((o*o>>>17)+o*i>>>15)+i*i,r=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=i^r}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.exports=(r=n(5),n(38),n(39),n(36),n(16),e=(o=r).lib.StreamCipher,n=o.algo,i=[],a=[],s=[],n=n.RabbitLegacy=e.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],o=this._b=0;o<4;o++)c.call(this);for(o=0;o<8;o++)r[o]^=n[o+4&7];if(t){var i=t.words,a=i[0],e=i[1],t=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),i=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8),a=t>>>16|4294901760&i,e=i<<16|65535&t;for(r[0]^=t,r[1]^=a,r[2]^=i,r[3]^=e,r[4]^=t,r[5]^=a,r[6]^=i,r[7]^=e,o=0;o<4;o++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2}),o.RabbitLegacy=e._createHelper(n),r.RabbitLegacy)},function(e,t){e.exports={aes_secret:">|Z2i580Py*4C3r"}},function(t,e,n){"use strict";var r=n(49),o=n(126),i=n(130),a=n(131)||0;function s(){return o(a)}t.exports=s,t.exports.generate=s,t.exports.seed=function(e){return r.seed(e),t.exports},t.exports.worker=function(e){return a=e,t.exports},t.exports.characters=function(e){return void 0!==e&&r.characters(e),r.shuffled()},t.exports.isValid=i},function(e,t,n){"use strict";var r=1;e.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(e){r=e}}},function(e,t,n){"use strict";var r,o,i=n(127);n(49),e.exports=function(e){var t="",n=Math.floor(.001*(Date.now()-1567752802062));return n===o?r++:(r=0,o=n),t+=i(7),t+=i(e),0<r&&(t+=i(r)),t+i(n)}},function(e,t,n){"use strict";var o=n(49),i=n(128),a=n(129);e.exports=function(e){for(var t,n=0,r="";!t;)r+=a(i,o.get(),1),t=e<Math.pow(16,n+1),n++;return r}},function(e,t,n){"use strict";var r="object"==typeof window&&(window.crypto||window.msCrypto),o=r&&r.getRandomValues?function(e){return r.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],n=0;n<e;n++)t.push(Math.floor(256*Math.random()));return t};e.exports=o},function(e,t){e.exports=function(e,t,n){for(var r=(2<<Math.log(t.length-1)/Math.LN2)-1,o=-~(1.6*r*n/t.length),i="";;)for(var a=e(o),s=o;s--;)if((i+=t[a[s]&r]||"").length===+n)return i}},function(e,t,n){"use strict";var r=n(49);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6||new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e))}},function(e,t,n){"use strict";e.exports=0},function(e,t,n){"use strict";var h,r,o,i;function a(e,t,n,r,o,i){this.hShadow=e,this.vShadow=t,this.blur=n,this.spread=r,this.color=o,this.inset=!!i}function s(e){for(var t=0;t<e.length;t+=1)if(e[t]in r.style)return e[t]}window.jscolor||(window.jscolor=((h={register:function(){h.attachDOMReadyEvent(h.init),h.attachEvent(document,"mousedown",h.onDocumentMouseDown),h.attachEvent(document,"touchstart",h.onDocumentTouchStart),h.attachEvent(window,"resize",h.onWindowResize)},init:function(){h.jscolor.lookupClass&&h.jscolor.installByClassName(h.jscolor.lookupClass)},tryInstallOnElements:function(e,t){for(var n,r=new RegExp("(^|\\s)("+t+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),o=0;o<e.length;o+=1)if((void 0===e[o].type||"color"!=e[o].type.toLowerCase()||!h.isColorAttrSupported)&&!e[o].jscolor&&e[o].className&&(n=e[o].className.match(r))){var i=e[o],a=null,s=h.getDataAttr(i,"jscolor");null!==s?a=s:n[4]&&(a=n[4]);var c={};if(a)try{c=new Function("return ("+a+")")()}catch(e){h.warn("Error parsing jscolor options: "+e+":\n"+a)}i.jscolor=new h.jscolor(i,c)}},isColorAttrSupported:!(!(i=document.createElement("input")).setAttribute||(i.setAttribute("type","color"),"color"!=i.type.toLowerCase())),isCanvasSupported:!!(i=document.createElement("canvas")).getContext&&!!i.getContext("2d"),fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},isElementType:function(e,t){return e.nodeName.toLowerCase()===t.toLowerCase()},getDataAttr:function(e,t){t="data-"+t,t=e.getAttribute(t);return null!==t?t:null},attachEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},detachEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},_attachedGroupEvents:{},attachGroupEvent:function(e,t,n,r){h._attachedGroupEvents.hasOwnProperty(e)||(h._attachedGroupEvents[e]=[]),h._attachedGroupEvents[e].push([t,n,r]),h.attachEvent(t,n,r)},detachGroupEvents:function(e){if(h._attachedGroupEvents.hasOwnProperty(e)){for(var t=0;t<h._attachedGroupEvents[e].length;t+=1){var n=h._attachedGroupEvents[e][t];h.detachEvent(n[0],n[1],n[2])}delete h._attachedGroupEvents[e]}},attachDOMReadyEvent:function(e){function n(){t||(t=!0,e())}var t=!1;"complete"!==document.readyState?document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),n())}),window.attachEvent("onload",n),document.documentElement.doScroll&&window==window.top)&&function t(){if(document.body)try{document.documentElement.doScroll("left"),n()}catch(e){setTimeout(t,1)}}():setTimeout(n,1)},warn:function(e){window.console&&window.console.warn&&window.console.warn(e)},preventDefault:function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1},captureTarget:function(e){e.setCapture&&(h._capturedTarget=e,h._capturedTarget.setCapture())},releaseTarget:function(){h._capturedTarget&&(h._capturedTarget.releaseCapture(),h._capturedTarget=null)},fireEvent:function(e,t){var n;e&&(document.createEvent?((n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),e.dispatchEvent(n)):document.createEventObject?(n=document.createEventObject(),e.fireEvent("on"+t,n)):e["on"+t]&&e["on"+t]())},classNameToList:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(e,t){return!!t&&-1!=(" "+e.className.replace(/\s+/g," ")+" ").indexOf(" "+t+" ")},setClass:function(e,t){for(var n=h.classNameToList(t),r=0;r<n.length;r+=1)h.hasClass(e,n[r])||(e.className+=(e.className?" ":"")+n[r])},unsetClass:function(e,t){for(var n=h.classNameToList(t),r=0;r<n.length;r+=1){var o=new RegExp("^\\s*"+n[r]+"\\s*|\\s*"+n[r]+"\\s*$|\\s+"+n[r]+"(\\s+)","g");e.className=e.className.replace(o,"$1")}},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},setStyle:(r=document.createElement("div"),function(e,t,n){var r;"opacity"===t.toLowerCase()?(r=Math.round(100*parseFloat(n)),e.style.opacity=n,e.style.filter="alpha(opacity="+r+")"):e.style[o[t]]=n}),setBorderRadius:function(e,t){h.setStyle(e,"borderRadius",t||"0")},setBoxShadow:function(e,t){h.setStyle(e,"boxShadow",t||"none")},getElementPos:function(e,t){var n=0,r=0,e=e.getBoundingClientRect(),n=e.left,r=e.top;return t||(n+=(t=h.getViewPos())[0],r+=t[1]),[n,r]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getAbsPointerPos:function(e){var t=0,n=0;return void 0!==(e=e||window.event).changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(t=e.clientX,n=e.clientY),{x:t,y:n}},getRelPointerPos:function(e){var t=((e=e||window.event).target||e.srcElement).getBoundingClientRect(),n=0,r=0;return void 0!==e.changedTouches&&e.changedTouches.length?(n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(n=e.clientX,r=e.clientY),{x:n-t.left,y:r-t.top}},getViewPos:function(){var e=document.documentElement;return[(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),(window.pageYOffset||e.scrollTop)-(e.clientTop||0)]},getViewSize:function(){var e=document.documentElement;return[window.innerWidth||e.clientWidth,window.innerHeight||e.clientHeight]},redrawPosition:function(){if(h.picker&&h.picker.owner){var e,t,n,r,o=h.picker.owner,i=o.fixed?(e=h.getElementPos(o.targetElement,!0),[0,0]):(e=h.getElementPos(o.targetElement),h.getViewPos()),a=h.getElementSize(o.targetElement),s=h.getViewSize(),c=h.getPickerOuterDims(o);switch(o.position.toLowerCase()){case"left":n=0,r=-(t=1);break;case"right":n=0,r=t=1;break;case"top":t=0,r=-(n=1);break;default:t=0,r=n=1}var u=(a[n]+c[n])/2,l=o.smartPosition?[-i[t]+e[t]+c[t]>s[t]&&-i[t]+e[t]+a[t]/2>s[t]/2&&0<=e[t]+a[t]-c[t]?e[t]+a[t]-c[t]:e[t],-i[n]+e[n]+a[n]+c[n]-u+u*r>s[n]?-i[n]+e[n]+a[n]/2>s[n]/2&&0<=e[n]+a[n]-u-u*r?e[n]+a[n]-u-u*r:e[n]+a[n]-u+u*r:0<=e[n]+a[n]-u+u*r?e[n]+a[n]-u+u*r:e[n]+a[n]-u-u*r]:[e[t],e[n]+a[n]-u+u*r],i=l[t],s=l[n],u=o.fixed?"fixed":"absolute",a=(l[0]+c[0]>e[0]||l[0]<e[0]+a[0])&&l[1]+c[1]<e[1]+a[1];h._drawPosition(o,i,s,u,a)}},_drawPosition:function(e,t,n,r,o){o=o?0:e.shadowBlur;h.picker.wrap.style.position=r,h.picker.wrap.style.left=t+"px",h.picker.wrap.style.top=n+"px",h.setBoxShadow(h.picker.boxS,e.shadow?new h.BoxShadow(0,o,e.shadowBlur,0,e.shadowColor):null)},getPickerDims:function(e){var t=!!h.getSliderComponent(e);return[2*e.insetWidth+2*e.padding+e.width+(t?2*e.insetWidth+h.getPadToSliderPadding(e)+e.sliderSize:0),2*e.insetWidth+2*e.padding+e.height+(e.closable?2*e.insetWidth+e.padding+e.buttonHeight:0)]},getPickerOuterDims:function(e){var t=h.getPickerDims(e);return[t[0]+2*e.borderWidth,t[1]+2*e.borderWidth]},getPadToSliderPadding:function(e){return Math.max(e.padding,1.5*(2*e.pointerBorderWidth+e.pointerThickness))},getPadYComponent:function(e){return"v"===e.mode.charAt(1).toLowerCase()?"v":"s"},getSliderComponent:function(e){if(2<e.mode.length)switch(e.mode.charAt(2).toLowerCase()){case"s":return"s";case"v":return"v"}return null},onDocumentMouseDown:function(e){var t=(e=e||window.event).target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?h.onControlPointerStart(e,t,t._jscControlName,"mouse"):h.picker&&h.picker.owner&&h.picker.owner.hide()},onDocumentTouchStart:function(e){var t=(e=e||window.event).target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?h.onControlPointerStart(e,t,t._jscControlName,"touch"):h.picker&&h.picker.owner&&h.picker.owner.hide()},onWindowResize:function(e){h.redrawPosition()},onParentScroll:function(e){h.picker&&h.picker.owner&&h.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(n,r,o,i){var e=r._jscInstance;h.preventDefault(n),h.captureTarget(r);var t=function(e,t){h.attachGroupEvent("drag",e,h._pointerMoveEvent[i],h.onDocumentPointerMove(n,r,o,i,t)),h.attachGroupEvent("drag",e,h._pointerEndEvent[i],h.onDocumentPointerEnd(n,r,o,i))};t(document,[0,0]),window.parent&&window.frameElement&&(a=[-(a=window.frameElement.getBoundingClientRect()).left,-a.top],t(window.parent.window.document,a));var t=h.getAbsPointerPos(n),a=h.getRelPointerPos(n);switch(h._pointerOrigin={x:t.x-a.x,y:t.y-a.y},o){case"pad":switch(h.getSliderComponent(e)){case"s":0===e.hsv[1]&&e.fromHSV(null,100,null);break;case"v":0===e.hsv[2]&&e.fromHSV(null,null,100)}h.setPad(e,n,0,0);break;case"sld":h.setSld(e,n,0)}h.dispatchFineChange(e)},onDocumentPointerMove:function(e,n,r,t,o){return function(e){var t=n._jscInstance;switch(r){case"pad":e=e||window.event,h.setPad(t,e,o[0],o[1]),h.dispatchFineChange(t);break;case"sld":e=e||window.event,h.setSld(t,e,o[1]),h.dispatchFineChange(t)}}},onDocumentPointerEnd:function(e,n,t,r){return function(e){var t=n._jscInstance;h.detachGroupEvents("drag"),h.releaseTarget(),h.dispatchChange(t)}},dispatchChange:function(e){e.valueElement&&h.isElementType(e.valueElement,"input")&&h.fireEvent(e.valueElement,"change")},dispatchFineChange:function(e){e.onFineChange&&("string"==typeof e.onFineChange?new Function(e.onFineChange):e.onFineChange).call(e)},setPad:function(e,t,n,r){var t=h.getAbsPointerPos(t),n=n+t.x-h._pointerOrigin.x-e.padding-e.insetWidth,t=r+t.y-h._pointerOrigin.y-e.padding-e.insetWidth,o=n*(360/(e.width-1)),i=100-t*(100/(e.height-1));switch(h.getPadYComponent(e)){case"s":e.fromHSV(o,i,null,h.leaveSld);break;case"v":e.fromHSV(o,null,i,h.leaveSld)}},setSld:function(e,t,n){var r=100-(n+h.getAbsPointerPos(t).y-h._pointerOrigin.y-e.padding-e.insetWidth)*(100/(e.height-1));switch(h.getSliderComponent(e)){case"s":e.fromHSV(null,r,null,h.leavePad);break;case"v":e.fromHSV(null,null,r,h.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!(o={borderRadius:s(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:s(["boxShadow","MozBoxShadow","webkitBoxShadow"])}),initVML:function(){if(!h._vmlReady){var e=document;if(e.namespaces[h._vmlNS]||e.namespaces.add(h._vmlNS,"urn:schemas-microsoft-com:vml"),!e.styleSheets[h._vmlCSS]){var t=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","rect","roundrect","oval","arc","image"],n=e.createStyleSheet();n.owningElement.id=h._vmlCSS;for(var r=0;r<t.length;r+=1)n.addRule(h._vmlNS+"\\:"+t[r],"behavior:url(#default#VML);")}h._vmlReady=!0}},createPalette:function(){var o,i,e,r,a,s,c,u,t={elm:null,draw:null};return h.isCanvasSupported?(o=document.createElement("canvas"),i=o.getContext("2d"),e=function(e,t,n){o.width=e,o.height=t,i.clearRect(0,0,o.width,o.height);t=i.createLinearGradient(0,0,o.width,0);t.addColorStop(0,"#F00"),t.addColorStop(1/6,"#FF0"),t.addColorStop(2/6,"#0F0"),t.addColorStop(.5,"#0FF"),t.addColorStop(4/6,"#00F"),t.addColorStop(5/6,"#F0F"),t.addColorStop(1,"#F00"),i.fillStyle=t,i.fillRect(0,0,o.width,o.height);var r=i.createLinearGradient(0,0,0,o.height);switch(n.toLowerCase()){case"s":r.addColorStop(0,"rgba(255,255,255,0)"),r.addColorStop(1,"rgba(255,255,255,1)");break;case"v":r.addColorStop(0,"rgba(0,0,0,0)"),r.addColorStop(1,"rgba(0,0,0,1)")}i.fillStyle=r,i.fillRect(0,0,o.width,o.height)},t.elm=o):(h.initVML(),(r=document.createElement("div")).style.position="relative",r.style.overflow="hidden",(a=document.createElement(h._vmlNS+":fill")).type="gradient",a.method="linear",a.angle="90",a.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0",(s=document.createElement(h._vmlNS+":rect")).style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),r.appendChild(s),(c=document.createElement(h._vmlNS+":fill")).type="gradient",c.method="linear",c.angle="180",c.opacity="0",(u=document.createElement(h._vmlNS+":rect")).style.position="absolute",u.style.left="-1px",u.style.top="-1px",u.stroked=!1,u.appendChild(c),r.appendChild(u),e=function(e,t,n){switch(r.style.width=e+"px",r.style.height=t+"px",s.style.width=u.style.width=e+1+"px",s.style.height=u.style.height=t+1+"px",a.color="#F00",a.color2="#F00",n.toLowerCase()){case"s":c.color=c.color2="#FFF";break;case"v":c.color=c.color2="#000"}},t.elm=r),t.draw=e,t},createSliderGradient:function(){var o,i,e,a,s,c,t={elm:null,draw:null};return h.isCanvasSupported?(o=document.createElement("canvas"),i=o.getContext("2d"),e=function(e,t,n,r){o.width=e,o.height=t,i.clearRect(0,0,o.width,o.height);t=i.createLinearGradient(0,0,0,o.height);t.addColorStop(0,n),t.addColorStop(1,r),i.fillStyle=t,i.fillRect(0,0,o.width,o.height)},t.elm=o):(h.initVML(),(a=document.createElement("div")).style.position="relative",a.style.overflow="hidden",(s=document.createElement(h._vmlNS+":fill")).type="gradient",s.method="linear",s.angle="180",(c=document.createElement(h._vmlNS+":rect")).style.position="absolute",c.style.left="-1px",c.style.top="-1px",c.stroked=!1,c.appendChild(s),a.appendChild(c),e=function(e,t,n,r){a.style.width=e+"px",a.style.height=t+"px",c.style.width=e+1+"px",c.style.height=t+1+"px",s.color=n,s.color2=r},t.elm=a),t.draw=e,t},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:(a.prototype.toString=function(){var e=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];return this.inset&&e.push("inset"),e.join(" ")},a),jscolor:function(e,t){function s(e,t,n){var r=n/100*255;if(null===e)return[r,r,r];e/=60,t/=100;var n=Math.floor(e),o=r*(1-t),i=r*(1-t*(n%2?e-n:1-(e-n)));switch(n){case 6:case 0:return[r,i,o];case 1:return[i,r,o];case 2:return[o,r,i];case 3:return[o,i,r];case 4:return[i,o,r];case 5:return[r,o,i]}}function n(){l._processParentElementsInDOM(),h.picker||(h.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:h.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:h.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},h.picker.pad.appendChild(h.picker.padPal.elm),h.picker.padB.appendChild(h.picker.pad),h.picker.cross.appendChild(h.picker.crossBY),h.picker.cross.appendChild(h.picker.crossBX),h.picker.cross.appendChild(h.picker.crossLY),h.picker.cross.appendChild(h.picker.crossLX),h.picker.padB.appendChild(h.picker.cross),h.picker.box.appendChild(h.picker.padB),h.picker.box.appendChild(h.picker.padM),h.picker.sld.appendChild(h.picker.sldGrad.elm),h.picker.sldB.appendChild(h.picker.sld),h.picker.sldB.appendChild(h.picker.sldPtrOB),h.picker.sldPtrOB.appendChild(h.picker.sldPtrMB),h.picker.sldPtrMB.appendChild(h.picker.sldPtrIB),h.picker.sldPtrIB.appendChild(h.picker.sldPtrS),h.picker.box.appendChild(h.picker.sldB),h.picker.box.appendChild(h.picker.sldM),h.picker.btn.appendChild(h.picker.btnT),h.picker.box.appendChild(h.picker.btn),h.picker.boxB.appendChild(h.picker.box),h.picker.wrap.appendChild(h.picker.boxS),h.picker.wrap.appendChild(h.picker.boxB));var e=h.picker,t=!!h.getSliderComponent(l),n=h.getPickerDims(l),r=2*l.pointerBorderWidth+l.pointerThickness+2*l.crossSize,o=h.getPadToSliderPadding(l),i=Math.min(l.borderRadius,Math.round(l.padding*Math.PI));e.wrap.style.clear="both",e.wrap.style.width=n[0]+2*l.borderWidth+"px",e.wrap.style.height=n[1]+2*l.borderWidth+"px",e.wrap.style.zIndex=l.zIndex,e.box.style.width=n[0]+"px",e.box.style.height=n[1]+"px",e.boxS.style.position="absolute",e.boxS.style.left="0",e.boxS.style.top="0",e.boxS.style.width="100%",e.boxS.style.height="100%",h.setBorderRadius(e.boxS,i+"px"),e.boxB.style.position="relative",e.boxB.style.border=l.borderWidth+"px solid",e.boxB.style.borderColor=l.borderColor,e.boxB.style.background=l.backgroundColor,h.setBorderRadius(e.boxB,i+"px"),e.padM.style.background=e.sldM.style.background="#FFF",h.setStyle(e.padM,"opacity","0"),h.setStyle(e.sldM,"opacity","0"),e.pad.style.position="relative",e.pad.style.width=l.width+"px",e.pad.style.height=l.height+"px",e.padPal.draw(l.width,l.height,h.getPadYComponent(l)),e.padB.style.position="absolute",e.padB.style.left=l.padding+"px",e.padB.style.top=l.padding+"px",e.padB.style.border=l.insetWidth+"px solid",e.padB.style.borderColor=l.insetColor,e.padM._jscInstance=l,e.padM._jscControlName="pad",e.padM.style.position="absolute",e.padM.style.left="0",e.padM.style.top="0",e.padM.style.width=l.padding+2*l.insetWidth+l.width+o/2+"px",e.padM.style.height=n[1]+"px",e.padM.style.cursor="crosshair",e.cross.style.position="absolute",e.cross.style.left=e.cross.style.top="0",e.cross.style.width=e.cross.style.height=r+"px",e.crossBY.style.position=e.crossBX.style.position="absolute",e.crossBY.style.background=e.crossBX.style.background=l.pointerBorderColor,e.crossBY.style.width=e.crossBX.style.height=2*l.pointerBorderWidth+l.pointerThickness+"px",e.crossBY.style.height=e.crossBX.style.width=r+"px",e.crossBY.style.left=e.crossBX.style.top=Math.floor(r/2)-Math.floor(l.pointerThickness/2)-l.pointerBorderWidth+"px",e.crossBY.style.top=e.crossBX.style.left="0",e.crossLY.style.position=e.crossLX.style.position="absolute",e.crossLY.style.background=e.crossLX.style.background=l.pointerColor,e.crossLY.style.height=e.crossLX.style.width=r-2*l.pointerBorderWidth+"px",e.crossLY.style.width=e.crossLX.style.height=l.pointerThickness+"px",e.crossLY.style.left=e.crossLX.style.top=Math.floor(r/2)-Math.floor(l.pointerThickness/2)+"px",e.crossLY.style.top=e.crossLX.style.left=l.pointerBorderWidth+"px",e.sld.style.overflow="hidden",e.sld.style.width=l.sliderSize+"px",e.sld.style.height=l.height+"px",e.sldGrad.draw(l.sliderSize,l.height,"#000","#000"),e.sldB.style.display=t?"block":"none",e.sldB.style.position="absolute",e.sldB.style.right=l.padding+"px",e.sldB.style.top=l.padding+"px",e.sldB.style.border=l.insetWidth+"px solid",e.sldB.style.borderColor=l.insetColor,e.sldM._jscInstance=l,e.sldM._jscControlName="sld",e.sldM.style.display=t?"block":"none",e.sldM.style.position="absolute",e.sldM.style.right="0",e.sldM.style.top="0",e.sldM.style.width=l.sliderSize+o/2+l.padding+2*l.insetWidth+"px",e.sldM.style.height=n[1]+"px",e.sldM.style.cursor="default",e.sldPtrIB.style.border=e.sldPtrOB.style.border=l.pointerBorderWidth+"px solid "+l.pointerBorderColor,e.sldPtrOB.style.position="absolute",e.sldPtrOB.style.left=-(2*l.pointerBorderWidth+l.pointerThickness)+"px",e.sldPtrOB.style.top="0",e.sldPtrMB.style.border=l.pointerThickness+"px solid "+l.pointerColor,e.sldPtrS.style.width=l.sliderSize+"px",e.sldPtrS.style.height=p+"px",e.btn.style.display=l.closable?"block":"none",e.btn.style.position="absolute",e.btn.style.left=l.padding+"px",e.btn.style.bottom=l.padding+"px",e.btn.style.padding="0 15px",e.btn.style.height=l.buttonHeight+"px",e.btn.style.border=l.insetWidth+"px solid",n=(n=l.insetColor.split(/\s+/)).length<2?n[0]:n[1]+" "+n[0]+" "+n[0]+" "+n[1],e.btn.style.borderColor=n,e.btn.style.color=l.buttonColor,e.btn.style.font="12px sans-serif",e.btn.style.textAlign="center";try{e.btn.style.cursor="pointer"}catch(t){e.btn.style.cursor="hand"}e.btn.onmousedown=function(){l.hide()},e.btnT.style.lineHeight=l.buttonHeight+"px",e.btnT.innerHTML="",e.btnT.appendChild(document.createTextNode(l.closeText)),a(),c(),h.picker.owner&&h.picker.owner!==l&&h.unsetClass(h.picker.owner.targetElement,l.activeClass),h.picker.owner=l,h.isElementType(d,"body")?h.redrawPosition():h._drawPosition(l,0,0,"relative",!1),e.wrap.parentNode!=d&&d.appendChild(e.wrap),h.setClass(l.targetElement,l.activeClass)}function a(){switch(h.getPadYComponent(l)){case"s":var e=1;break;case"v":e=2}var t=Math.round(l.hsv[0]/360*(l.width-1)),n=Math.round((1-l.hsv[e]/100)*(l.height-1)),r=2*l.pointerBorderWidth+l.pointerThickness+2*l.crossSize,r=-Math.floor(r/2);switch(h.picker.cross.style.left=t+r+"px",h.picker.cross.style.top=n+r+"px",h.getSliderComponent(l)){case"s":var o=s(l.hsv[0],100,l.hsv[2]),i=s(l.hsv[0],0,l.hsv[2]),a="rgb("+Math.round(o[0])+","+Math.round(o[1])+","+Math.round(o[2])+")",o="rgb("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+")";h.picker.sldGrad.draw(l.sliderSize,l.height,a,o);break;case"v":i=s(l.hsv[0],l.hsv[1],100),a="rgb("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+")",o="#000";h.picker.sldGrad.draw(l.sliderSize,l.height,a,o)}}function c(){var e=h.getSliderComponent(l);if(e){switch(e){case"s":var t=1;break;case"v":t=2}e=Math.round((1-l.hsv[t]/100)*(l.height-1));h.picker.sldPtrOB.style.top=e-(2*l.pointerBorderWidth+l.pointerThickness)-Math.floor(p/2)+"px"}}function r(){return h.picker&&h.picker.owner===l}for(var o in this.value=null,this.valueElement=e,this.styleElement=e,this.required=!0,this.refine=!0,this.hash=!1,this.uppercase=!0,this.onFineChange=null,this.activeClass="jscolor-active",this.minS=0,this.maxS=100,this.minV=0,this.maxV=100,this.hsv=[0,0,100],this.rgb=[255,255,255],this.width=181,this.height=101,this.showOnClick=!0,this.mode="HSV",this.position="bottom",this.smartPosition=!0,this.sliderSize=16,this.crossSize=8,this.closable=!1,this.closeText="Close",this.buttonColor="#000000",this.buttonHeight=18,this.padding=12,this.backgroundColor="#FFFFFF",this.borderWidth=1,this.borderColor="#BBBBBB",this.borderRadius=8,this.insetWidth=1,this.insetColor="#BBBBBB",this.shadow=!0,this.shadowBlur=15,this.shadowColor="rgba(0,0,0,0.2)",this.pointerColor="#4C4C4C",this.pointerBorderColor="#FFFFFF",this.pointerBorderWidth=1,this.pointerThickness=2,this.zIndex=1e3,this.container=null,t)t.hasOwnProperty(o)&&(this[o]=t[o]);var i,u,l,d,p,f;this.hide=function(){r()&&(h.unsetClass(l.targetElement,l.activeClass),h.picker.wrap.parentNode.removeChild(h.picker.wrap),delete h.picker.owner)},this.show=function(){n()},this.redraw=function(){r()&&n()},this.importColor=function(){this.valueElement&&h.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(h.leaveValue|h.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,h.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(h.leaveValue|h.leaveStyle)):this.exportColor()},this.exportColor=function(e){var t;e&h.leaveValue||!this.valueElement||(t=this.toString(),this.uppercase&&(t=t.toUpperCase()),this.hash&&(t="#"+t),h.isElementType(this.valueElement,"input")?this.valueElement.value=t:this.valueElement.innerHTML=t),e&h.leaveStyle||this.styleElement&&(this.styleElement.style.backgroundImage="none",this.styleElement.style.backgroundColor="#"+this.toString(),this.styleElement.style.color=this.isLight()?"#000":"#FFF"),e&h.leavePad||!r()||a(),e&h.leaveSld||!r()||c()},this.fromHSV=function(e,t,n,r){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(360,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(100,this.maxS,t),this.minS)}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(100,this.maxV,n),this.minV)}this.rgb=s(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===n?this.hsv[2]:this.hsv[2]=n),this.exportColor(r)},this.fromRGB=function(e,t,n,r){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(255,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(255,t))}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(255,n))}n=function(e,t,n){e/=255,t/=255,n/=255;var r=Math.min(Math.min(e,t),n),o=Math.max(Math.max(e,t),n),i=o-r;if(0==i)return[null,0,100*o];e=e===r?3+(n-t)/i:t===r?5+(e-n)/i:1+(t-e)/i;return[60*(6==e?0:e),i/o*100,100*o]}(null===e?this.rgb[0]:e,null===t?this.rgb[1]:t,null===n?this.rgb[2]:n);null!==n[0]&&(this.hsv[0]=Math.max(0,Math.min(360,n[0]))),0!==n[2]&&(this.hsv[1]=null===n[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,n[1]))),this.hsv[2]=null===n[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,n[2]));n=s(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=n[0],this.rgb[1]=n[1],this.rgb[2]=n[2],this.exportColor(r)},this.fromString=function(e,t){if(n=e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16),parseInt(n[1].substr(2,2),16),parseInt(n[1].substr(4,2),16),t):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16),parseInt(n[1].charAt(1)+n[1].charAt(1),16),parseInt(n[1].charAt(2)+n[1].charAt(2),16),t),!0;if(n=e.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){var e=n[1].split(","),n=/^\s*(\d*)(\.\d+)?\s*$/;if(3<=e.length&&(r=e[0].match(n))&&(o=e[1].match(n))&&(i=e[2].match(n))){var r=parseFloat((r[1]||"0")+(r[2]||"")),o=parseFloat((o[1]||"0")+(o[2]||"")),i=parseFloat((i[1]||"0")+(i[2]||""));return this.fromRGB(r,o,i,t),!0}}return!1},this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)},this.toHEXString=function(){return"#"+this.toString().toUpperCase()},this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"},this.isLight=function(){return 127.5<.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]},this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var e=this.targetElement;do{var t=h.getStyle(e)}while(t&&"fixed"===t.position.toLowerCase()&&(this.fixed=!0),e!==this.targetElement&&(e._jscEventsAttached||(h.attachEvent(e,"scroll",h.onParentScroll),e._jscEventsAttached=!0)),(e=e.parentNode)&&!h.isElementType(e,"body"))}},"string"==typeof e?(i=e,(u=document.getElementById(i))?this.targetElement=u:h.warn("Could not find target element with ID '"+i+"'")):e?this.targetElement=e:h.warn("Invalid target element: '"+e+"'"),this.targetElement._jscLinkedInstance?h.warn("Cannot link jscolor twice to the same element. Skipping."):((this.targetElement._jscLinkedInstance=this).valueElement=h.fetchElement(this.valueElement),this.styleElement=h.fetchElement(this.styleElement),d=(l=this).container?h.fetchElement(this.container):document.getElementsByTagName("body")[0],p=3,h.isElementType(this.targetElement,"button")&&(this.targetElement.onclick?(f=this.targetElement.onclick,this.targetElement.onclick=function(e){return f.call(this,e),!1}):this.targetElement.onclick=function(){return!1}),this.valueElement&&h.isElementType(this.valueElement,"input")&&(e=function(){l.fromString(l.valueElement.value,h.leaveValue),h.dispatchFineChange(l)},h.attachEvent(this.valueElement,"keyup",e),h.attachEvent(this.valueElement,"input",e),h.attachEvent(this.valueElement,"blur",function(){l.importColor()}),this.valueElement.setAttribute("autocomplete","off")),this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color}),this.value?this.fromString(this.value)||this.exportColor():this.importColor())}}).jscolor.lookupClass="jscolor",h.jscolor.installByClassName=function(e){var t=document.getElementsByTagName("input"),n=document.getElementsByTagName("button");h.tryInstallOnElements(t,e),h.tryInstallOnElements(n,e)},h.register(),h.jscolor))},function(e,t,n){"use strict";var r=n(24),o=n(71),i=n(135),a=n(61);function s(e){var t=new i(e),e=o(i.prototype.request,t);return r.extend(e,i.prototype,t),r.extend(e,t),e}var c=s(a);c.Axios=i,c.create=function(e){return s(r.merge(a,e))},c.Cancel=n(75),c.CancelToken=n(148),c.isCancel=n(74),c.all=function(e){return Promise.all(e)},c.spread=n(149),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(61),o=n(24),i=n(143),a=n(144);function s(e){this.defaults=e,this.interceptors={request:new i,response:new i}}s.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],function(n){s.prototype[n]=function(e,t){return this.request(o.merge(t||{},{method:n,url:e}))}}),o.forEach(["post","put","patch"],function(r){s.prototype[r]=function(e,t,n){return this.request(o.merge(n||{},{method:r,url:e,data:t}))}}),e.exports=s},function(e,t,n){"use strict";var o=n(24);e.exports=function(n,r){o.forEach(n,function(e,t){t!==r&&t.toUpperCase()===r.toUpperCase()&&(n[r]=e,delete n[t])})}},function(e,t,n){"use strict";var o=n(73);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(o("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";var o=n(24);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var r,t=n?n(t):o.isURLSearchParams(t)?t.toString():(r=[],o.forEach(t,function(e,t){null!=e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),r.push(i(t)+"="+i(e))}))}),r.join("&"));return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},function(e,t,n){"use strict";var o=n(24),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,r={};return e&&o.forEach(e.split("\n"),function(e){n=e.indexOf(":"),t=o.trim(e.substr(0,n)).toLowerCase(),n=o.trim(e.substr(n+1)),t&&(r[t]&&0<=i.indexOf(t)||(r[t]="set-cookie"===t?(r[t]||[]).concat([n]):r[t]?r[t]+", "+n:n))}),r}},function(e,t,n){"use strict";var r,o,i,a=n(24);function s(e){return o&&(i.setAttribute("href",e),e=i.href),i.setAttribute("href",e),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}e.exports=a.isStandardBrowserEnv()?(o=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),r=s(window.location.href),function(e){e=a.isString(e)?s(e):e;return e.protocol===r.protocol&&e.host===r.host}):function(){return!0}},function(e,t,n){"use strict";var s=n(24);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,n,r,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),s.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),s.isString(r)&&a.push("path="+r),s.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(24);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(t){r.forEach(this.handlers,function(e){null!==e&&t(e)})},e.exports=o},function(e,t,n){"use strict";var r=n(24),o=n(145),i=n(74),a=n(61),s=n(146),c=n(147);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(t){return u(t),t.baseURL&&!s(t.url)&&(t.url=c(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return u(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(u(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(e,t,n){"use strict";var r=n(24);e.exports=function(t,n,e){return r.forEach(e,function(e){t=e(t,n)}),t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(75);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o(function(e){t=e}),cancel:t}},e.exports=o},function(e,t,n){"use strict";e.exports=function(t){return function(e){return t.apply(null,e)}}},function(e,t,n){var r=function(a){"use strict";var e=Object.prototype,c=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function i(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(a){i=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o,i,a,s,t=t&&t.prototype instanceof d?t:d,t=Object.create(t.prototype),r=new b(r||[]);return t._invoke=(o=e,i=n,a=r,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){var r=function e(t,n){var r=t.iterator[n.method];if(void 0===r){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method))return l;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}r=u(r,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,l;var r=r.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,l):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,l)}(n,a);if(r){if(r===l)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=u(o,i,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===l)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}}),t}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var l={};function d(){}function p(){}function f(){}var h={};h[r]=function(){return this};t=Object.getPrototypeOf,t=t&&t(t(w([])));t&&t!==e&&c.call(t,r)&&(h=t);var m=f.prototype=d.prototype=Object.create(h);function _(e){["next","throw","return"].forEach(function(t){i(e,t,function(e){return this._invoke(t,e)})})}function g(a,s){var t;this._invoke=function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,o){e=u(a[e],a,n);if("throw"!==e.type){var i=e.arg,n=i.value;return n&&"object"==typeof n&&c.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,o)},function(e){t("throw",e,r,o)}):s.resolve(n).then(function(e){i.value=e,r(i)},function(e){return t("throw",e,r,o)})}o(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function w(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,e=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return e.next=e}}return{next:S}}function S(){return{value:void 0,done:!0}}return((p.prototype=m.constructor=f).constructor=p).displayName=i(f,o,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},a.awrap=function(e){return{__await:e}},_(g.prototype),g.prototype[n]=function(){return this},a.AsyncIterator=g,a.async=function(e,t,n,r,o){void 0===o&&(o=Promise);var i=new g(s(e,t,n,r),o);return a.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},_(m),i(m,o,"Generator"),m[r]=function(){return this},m.toString=function(){return"[object Generator]"},a.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=w,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return i.type="throw",i.arg=n,r.next=e,t&&(r.method="next",r.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=c.call(o,"catchLoc"),s=c.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),y(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r,o=n.completion;return"throw"===o.type&&(r=o.arg,y(n)),r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},a}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var l,d,p=n(76),f=n(77),h=0,m=0;e.exports=function(e,t,n){var r=t&&n||0,o=t||[],i=(e=e||{}).node||l,a=void 0!==e.clockseq?e.clockseq:d;null!=i&&null!=a||(c=p(),null==i&&(i=l=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=d=16383&(c[6]<<8|c[7])));var s=void 0!==e.msecs?e.msecs:(new Date).getTime(),n=void 0!==e.nsecs?e.nsecs:m+1,c=s-h+(n-m)/1e4;if(c<0&&void 0===e.clockseq&&(a=a+1&16383),(c<0||h<s)&&void 0===e.nsecs&&(n=0),1e4<=n)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=s,d=a;n=(1e4*(268435455&(s+=122192928e5))+(m=n))%4294967296;o[r++]=n>>>24&255,o[r++]=n>>>16&255,o[r++]=n>>>8&255,o[r++]=255&n;s=s/4294967296*1e4&268435455;o[r++]=s>>>8&255,o[r++]=255&s,o[r++]=s>>>24&15|16,o[r++]=s>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var u=0;u<6;++u)o[r+u]=i[u];return t||f(o)}},function(e,t,n){var a=n(76),s=n(77);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[r+i]=o[i];return t||s(o)}},function(e,t){function n(e){e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,(e.exports=n).id=153},function(e,t,n){var r=n(78),o=n(46)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";e=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+e+":"+n.port,n.href=n.protocol+"://"+e+(t&&t.port===n.port?"":":"+n.port),n}},function(e,c,t){function n(e){var a;function s(){if(s.enabled){var r=s,e=+new Date,t=e-(a||e);r.diff=t,r.prev=a,r.curr=e,a=e;for(var o=new Array(arguments.length),n=0;n<o.length;n++)o[n]=arguments[n];o[0]=c.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var i=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;i++;var n=c.formatters[t];return"function"==typeof n&&(t=o[i],e=n.call(r,t),o.splice(i,1),i--),e}),c.formatArgs.call(r,o),(s.log||c.log||console.log.bind(console)).apply(r,o)}}return s.namespace=e,s.enabled=c.enabled(e),s.useColors=c.useColors(),s.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return c.colors[Math.abs(n)%c.colors.length]}(e),s.destroy=r,"function"==typeof c.init&&c.init(s),c.instances.push(s),s}function r(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}(c=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){c.enable("")},c.enable=function(e){c.save(e),c.names=[],c.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(r=0;r<c.instances.length;r++){var o=c.instances[r];o.enabled=c.enabled(o.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;for(var t=0,n=c.skips.length;t<n;t++)if(c.skips[t].test(e))return!1;for(t=0,n=c.names.length;t<n;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=t(79),c.instances=[],c.names=[],c.skips=[],c.formatters={}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}(e.exports=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var l=n(80),d=n(81),n=Object.prototype.toString,p="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===n.call(Blob),f="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===n.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,e=e;return e.data=function e(t,n){if(!t)return t;if(d(t)){var r={_placeholder:!0,num:n.length};return n.push(t),r}if(l(t)){for(var o=new Array(t.length),i=0;i<t.length;i++)o[i]=e(t[i],n);return o}if("object"!=typeof t||t instanceof Date)return t;for(var a in o={},t)o[a]=e(t[a],n);return o}(n,t),e.attachments=t.length,{packet:e,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(l(t))for(var r=0;r<t.length;r++)t[r]=e(t[r],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,s){var c=0,u=e;!function e(t,n,r){if(!t)return t;if(p&&t instanceof Blob||f&&t instanceof File){c++;var o=new FileReader;o.onload=function(){r?r[n]=this.result:u=this.result,--c||s(u)},o.readAsArrayBuffer(t)}else if(l(t))for(var i=0;i<t.length;i++)e(t[i],i,t);else if("object"==typeof t&&!d(t))for(var a in t)e(t[a],a,t)}(u),c||s(u)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),e=t[0],t=t[1];return 3*(e+t)/4-t},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],n=n[1],o=new u(3*(r+n)/4-n),i=0,a=0<n?r-4:r,s=0;s<a;s+=4)t=c[e.charCodeAt(s)]<<18|c[e.charCodeAt(s+1)]<<12|c[e.charCodeAt(s+2)]<<6|c[e.charCodeAt(s+3)],o[i++]=t>>16&255,o[i++]=t>>8&255,o[i++]=255&t;return 2===n&&(t=c[e.charCodeAt(s)]<<2|c[e.charCodeAt(s+1)]>>4,o[i++]=255&t),1===n&&(t=c[e.charCodeAt(s)]<<10|c[e.charCodeAt(s+1)]<<4|c[e.charCodeAt(s+2)]>>2,o[i++]=t>>8&255,o[i++]=255&t),o},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],i=0,a=n-r;i<a;i+=16383)o.push(function(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(s[r>>18&63]+s[r>>12&63]+s[r>>6&63]+s[63&r]);return o.join("")}(e,i,a<i+16383?a:i+16383));return 1==r?(t=e[n-1],o.push(s[t>>2]+s[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],o.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"=")),o.join("")};for(var s=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,i=r.length;o<i;++o)s[o]=r[o],c[r.charCodeAt(o)]=o;function l(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?o-1:0,p=n?-1:1,n=e[t+d];for(d+=p,i=n&(1<<-l)-1,n>>=-l,l+=s;0<l;i=256*i+e[t+d],d+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;0<l;a=256*a+e[t+d],d+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),i-=u}return(n?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c=8*i-o-1,u=(1<<c)-1,l=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,f=r?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+l?d/r:d*Math.pow(2,1-l))*r&&(a++,r/=2),u<=a+l?(s=0,a=u):1<=a+l?(s=(t*r-1)*Math.pow(2,o),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,o),a=0));8<=o;e[n+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;0<c;e[n+p]=255&a,p+=f,a/=256,c-=8);e[n+p-f]|=128*i}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(162),e.exports.parser=n(40)},function(e,t,n){var r=n(83),o=n(47),d=n(53)("engine.io-client:socket"),i=n(87),a=n(40),s=n(78),c=n(51);function p(e,t){if(!(this instanceof p))return new p(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=s(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=s(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),"undefined"!=typeof self&&!this.isReactNative||(t.extraHeaders&&0<Object.keys(t.extraHeaders).length&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}(e.exports=p).priorWebsocketSuccess=!1,o(p.prototype),p.protocol=a.protocol,(p.Socket=p).Transport=n(66),p.transports=n(83),p.parser=n(40),p.prototype.createTransport=function(e){d('creating transport "%s"',e);var t=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},p.prototype.open=function(){var e;if(this.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},p.prototype.setTransport=function(e){d("setting transport %s",e.name);var t=this;this.transport&&(d("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},p.prototype.probe=function(n){d('probing transport "%s"',n);var r=this.createTransport(n,{probe:1}),t=!1,o=this;function e(){var e;o.onlyBinaryUpgrades&&(e=!this.supportsBinary&&o.transport.supportsBinary,t=t||e),t||(d('probe transport "%s" opened',n),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){t||("pong"===e.type&&"probe"===e.data?(d('probe transport "%s" pong',n),o.upgrading=!0,o.emit("upgrading",r),r&&(p.priorWebsocketSuccess="websocket"===r.name,d('pausing current transport "%s"',o.transport.name),o.transport.pause(function(){t||"closed"!==o.readyState&&(d("changing transport and sending upgrade packet"),l(),o.setTransport(r),r.send([{type:"upgrade"}]),o.emit("upgrade",r),r=null,o.upgrading=!1,o.flush())}))):(d('probe transport "%s" failed',n),(e=new Error("probe error")).transport=r.name,o.emit("upgradeError",e)))}))}function i(){t||(t=!0,l(),r.close(),r=null)}function a(e){var t=new Error("probe error: "+e);t.transport=r.name,i(),d('probe transport "%s" failed because of error: %s',n,e),o.emit("upgradeError",t)}function s(){a("transport closed")}function c(){a("socket closed")}function u(e){r&&e.name!==r.name&&(d('"%s" works - aborting "%s"',e.name,r.name),i())}function l(){r.removeListener("open",e),r.removeListener("error",a),r.removeListener("close",s),o.removeListener("close",c),o.removeListener("upgrading",u)}p.priorWebsocketSuccess=!1,r.once("open",e),r.once("error",a),r.once("close",s),this.once("close",c),this.once("upgrading",u),r.open()},p.prototype.onOpen=function(){if(d("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){d("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},p.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(d('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else d('packet received with socket readyState "%s"',this.readyState)},p.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},p.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},p.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){d("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},p.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},p.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()},p.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(d("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},p.prototype.write=p.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},p.prototype.sendPacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((n=n||{}).compress=!1!==n.compress,n={type:e,data:t,options:n},this.emit("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush())},p.prototype.close=function(){var e;function t(){e.onClose("forced close"),d("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",(e=this).writeBuffer.length?this.once("drain",function(){(this.upgrading?r:t)()}):(this.upgrading?r:t)()),this},p.prototype.onError=function(e){d("socket error %j",e),p.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},p.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(d('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},p.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){var o=n(65),r=n(84),i=n(47),a=n(52),s=n(53)("engine.io-client:polling-xhr");function c(){}function u(e){var t,n;r.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location&&(t="https:"===location.protocol,n=(n=location.port)||(t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t)}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function d(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}e.exports=u,e.exports.Request=l,a(u,r),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},u.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:n}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=n},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},i(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new o(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e,t;try{try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",d):"function"==typeof addEventListener&&(i="onpagehide"in self?"pagehide":"unload",addEventListener(i,d,!1)))},function(e,t){e.exports=Object.keys||function(e){var t,n=[],r=Object.prototype.hasOwnProperty;for(t in e)r.call(e,t)&&n.push(t);return n}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),r<n&&(n=r),r<=t||n<=t||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer}},function(e,t){function a(){}e.exports=function(e,n,r){var o=!1;return r=r||a,0===(i.count=e)?n():i;function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,n(e),n=r):0!==i.count||o||n(null,t)}}},function(e,t){var i,a,s,c=String.fromCharCode;function u(e){for(var t,n,r=[],o=0,i=e.length;o<i;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function l(e,t){if(!(55296<=e&&e<=57343))return 1;if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function d(e,t){return c(e>>t&63|128)}function p(){if(a<=s)throw Error("Invalid byte index");var e=255&i[s];if(s++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=u(e),o=r.length,i=-1,a="";++i<o;)a+=function(e,t){if(0==(4294967168&e))return c(e);var n="";return 0==(4294965248&e)?n=c(e>>6&31|192):0==(4294901760&e)?(l(e,t)||(e=65533),n=c(e>>12&15|224),n+=d(e,6)):0==(4292870144&e)&&(n=c(e>>18&7|240),n+=d(e,12),n+=d(e,6)),n+c(63&e|128)}(r[i],n);return a},decode:function(e,t){var n=!1!==(t=t||{}).strict;i=u(e),a=i.length,s=0;for(var r,o=[];!1!==(r=function(e){var t,n;if(a<s)throw Error("Invalid byte index");if(s==a)return!1;if(t=255&i[s],s++,0==(128&t))return t;if(192==(224&t)){if(128<=(n=(31&t)<<6|p()))return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(n=(15&t)<<12|p()<<6|p()))return l(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(n=(7&t)<<18|p()<<12|p()<<6|p())&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}(n));)o.push(r);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)65535<(t=e[r])&&(o+=c((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=c(t);return o}(o)}}},function(e,t){!function(){"use strict";for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=new Uint8Array(256),e=0;e<i.length;e++)l[i.charCodeAt(e)]=e;t.encode=function(e){for(var t=new Uint8Array(e),n=t.length,r="",o=0;o<n;o+=3)r+=i[t[o]>>2],r+=i[(3&t[o])<<4|t[o+1]>>4],r+=i[(15&t[o+1])<<2|t[o+2]>>6],r+=i[63&t[o+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(e){var t,n,r,o,i=.75*e.length,a=e.length,s=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);for(var i=new ArrayBuffer(i),c=new Uint8Array(i),u=0;u<a;u+=4)t=l[e.charCodeAt(u)],n=l[e.charCodeAt(u+1)],r=l[e.charCodeAt(u+2)],o=l[e.charCodeAt(u+3)],c[s++]=t<<2|n>>4,c[s++]=(15&n)<<4|r>>2,c[s++]=(3&r)<<6|63&o;return i}}()},function(e,t){var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=r&&r.prototype.append&&r.prototype.getBlob;function a(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t,n=e.buffer;return e.byteLength!==n.byteLength&&((t=new Uint8Array(e.byteLength)).set(new Uint8Array(n,e.byteOffset,e.byteLength)),n=t.buffer),n}return e})}function s(e,t){t=t||{};var n=new r;return a(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function c(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=n?o?Blob:c:i?s:void 0},function(e,c,t){function n(e){var a;function s(){if(s.enabled){var r=s,e=+new Date,t=e-(a||e);r.diff=t,r.prev=a,r.curr=e,a=e;for(var o=new Array(arguments.length),n=0;n<o.length;n++)o[n]=arguments[n];o[0]=c.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var i=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;i++;var n=c.formatters[t];return"function"==typeof n&&(t=o[i],e=n.call(r,t),o.splice(i,1),i--),e}),c.formatArgs.call(r,o),(s.log||c.log||console.log.bind(console)).apply(r,o)}}return s.namespace=e,s.enabled=c.enabled(e),s.useColors=c.useColors(),s.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return c.colors[Math.abs(n)%c.colors.length]}(e),s.destroy=r,"function"==typeof c.init&&c.init(s),c.instances.push(s),s}function r(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}(c=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){c.enable("")},c.enable=function(e){c.save(e),c.names=[],c.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(r=0;r<c.instances.length;r++){var o=c.instances[r];o.enabled=c.enabled(o.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;for(var t=0,n=c.skips.length;t<n;t++)if(c.skips[t].test(e))return!1;for(t=0,n=c.names.length;t<n;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=t(79),c.instances=[],c.names=[],c.skips=[],c.formatters={}},function(a,e,s){(function(n){var r=s(84),e=s(52);a.exports=t;var o,u=/\n/g,l=/\\n/g;function i(){}function t(e){r.call(this,e),this.query=this.query||{},o||(e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},o=e.___eio=e.___eio||[]),this.index=o.length;var t=this;o.push(function(e){t.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){t.script&&(t.script.onerror=i)},!1)}e(t,r),t.prototype.supportsBinary=!1,t.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},t.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},t.prototype.doWrite=function(e,t){var n,r,o,i,a=this;function s(){c(),t()}function c(){if(a.iframe)try{a.form.removeChild(a.iframe)}catch(e){a.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+a.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=a.iframeId,n.src="javascript:0"}n.id=a.iframeId,a.form.appendChild(n),a.iframe=n}this.form||(r=document.createElement("form"),o=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index,r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=i,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o),this.form.action=this.uri(),c(),e=e.replace(l,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===a.iframe.readyState&&s()}:this.iframe.onload=s}}).call(this,s(50))},function(d,e,p){(function(i){var t,n,r=p(66),a=p(40),o=p(51),e=p(52),s=p(86),c=p(53)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)t=WebSocket;else if("undefined"!=typeof self)t=self.WebSocket||self.MozWebSocket;else try{n=p(175)}catch(e){}var u=t||n;function l(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=t&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(u=n),r.call(this,e)}e(d.exports=l,r),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new u(e,t):new u(e):new u(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},l.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},l.prototype.write=function(e){var r=this;this.writable=!1;for(var o=e.length,t=0,n=o;t<n;t++)!function(n){a.encodePacket(n,r.supportsBinary,function(e){var t;r.usingBrowserWebSocket||(t={},n.options&&(t.compress=n.options.compress),!r.perMessageDeflate||("string"==typeof e?i.byteLength(e):e.length)<r.perMessageDeflate.threshold&&(t.compress=!1));try{r.usingBrowserWebSocket?r.ws.send(e):r.ws.send(e,t)}catch(e){c("websocket closed before onclose event")}--o||(r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0))})}(e[t])},l.prototype.onClose=function(){r.prototype.onClose.call(this)},l.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!==Number(this.port)||"ws"==t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||(e.b64=1),(e=o.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},l.prototype.check=function(){return!(!u||"__initialize"in u&&this.name===l.prototype.name)}}).call(this,p(64).Buffer)},function(e,t){},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(e.exports=n).prototype.duration=function(){var e,t,n=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(e=Math.random(),t=Math.floor(e*this.jitter*n),n=0==(1&Math.floor(10*e))?n-t:n+t),0|Math.min(n,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t){e.exports=function(e){var t;return e.webpackPolyfill||((t=Object.create(e)).children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1),t}},function(e,t,n){"use strict";n.r(t);n=n(0);function r(){$("body").html("<h6 style='margin-top: 10px; text-align: center; direction: rtl; color: red'>الرجاء حذف هذه الإضافة من المتصفح - User-Agent Switcher</h6>")}Object(n.a)("chrome-extension://djflhoibgkdhkhhcedjiklpkjnoahfmg/jquery.js",function(e){"200"==e&&r()}),Object(n.a)("chrome-extension://kchfmpdcejfkipopnolndinkeoipnoia/jquery.js",function(e){"200"==e&&r()})},function(e,t,n){"use strict";n.r(t);var p=n(0);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=(kt=i,_t=[{key:"getIcon",value:function(e){return e.getState().settings.default_avatar?"/uploads/avatars/"+e.getState().settings.default_avatar:"/images/none.png"}},{key:"render",value:function(e){var t=e.getState().settings.chat_name?e.getState().settings.chat_name:"",n="<h1 id='login-header' class='border-color label label-primary'>";return n+="<a class='label label-primary login-header__label' href='/'>",n+="<img src='"+i.getIcon(e)+"' width='28' height='30' />",n+="<span class='login-header__title'>"+t+"</span>",n+="<button class='btn fr btn-success fa fa-refresh login-header__refresh'></button>",(n+="</a>")+"</h1>"}}],(Qe=null)&&r(kt.prototype,Qe),r(kt,_t),i);function i(e){!function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.store=e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=(de=c,St=[{key:"getSrc",value:function(e){return e.getState().settings.banner_img?"/uploads/"+e.getState().settings.banner_img:"/images/banner.png"}},{key:"render",value:function(e){var t="<div id='login-banner' class='rainbow'>";return(t+="<img src='"+c.getSrc(e)+"' alt='banner' class='login-banner__img' />")+"</div>"}}],(gt=null)&&a(de.prototype,gt),a(de,St),c);function c(){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return{type:"HANDLE_USER_CHANGE_ROOM",userId:e,oldRoomId:t,newRoomId:n}}function d(){return{type:"SET_GIFTS",gifts:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}}function f(){return{type:"SET_FACES",faces:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}}function h(){return{type:"SET_FLOATING_PARTICLES",particleType:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"heart"}}var m=(t=M,Qe=[{key:"render",value:function(){return"<div id='login-btn-holder'><a href='https://www.facebook.com/' class='login-btn-holder__btn fa fa-facebook btn btn-primary'> فيسبوك </a><a href='/RULS.html' class='login-btn-holder__btn fa fa-music btn btn-default'> القوانين </a><a href='/RED.html' class='login-btn-holder__btn fa fa-star-half-o btn btn-primary'> الإشتراكات </a><a href='/RIW.html' class='login-btn-holder__btn fa fa-user btn btn-default'> الفعاليات </a></div>"}}],(kt=null)&&u(t.prototype,kt),u(t,Qe),M),_=n(11),g=n(54),v=n(55),y=n(57),b=n(56),w=n(30),S=n(31),k=n(25),C=n(27),E=n(15),T=n(19),O=n(58),P=n(33),A=n(28),R=n(42),x=n(14);function M(){!function(e){if(!(e instanceof M))throw new TypeError("Cannot call a class as a function")}(this)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=(_t=U,gt=[{key:"registerEvents",value:function(e){U.toggle(e)}},{key:"toggle",value:function(t){$("#radio-container img").unbind("click").on("click",function(e){$("#radio-stream").length?(U.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active")):(U.playRadio(t),$("#radio-container .radio-container__off").addClass("active"),$("#radio-container .radio-container__on").removeClass("active"))})}},{key:"update",value:function(e){var t=$("#radio-container");t.find("#radio-stream").attr("src")!=e.getState().settings.radio_stream_url&&t.find("#radio-stream").attr("src",e.getState().settings.radio_stream_url);var n=e.getState().settings.radio_stream_off_img?"/uploads/"+e.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg";t.find(".radio-container__off").attr("src",n);n=e.getState().settings.radio_stream_on_img?"/uploads/"+e.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg";t.find(".radio-container__on").attr("src",n),e.getState().settings.is_radio_stream_enabled?$("#radio-container").show():(U.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active"),$("#radio-container").hide()),U.toggle(e)}},{key:"playRadio",value:function(e){$("#radio-container").append('<audio id="radio-stream" src="'+e.getState().settings.radio_stream_url+'" width="0" height="0" />'),$("#radio-stream")[0].play()}},{key:"stopRadio",value:function(){$("#radio-stream")[0]&&$("#radio-stream")[0].remove()}},{key:"render",value:function(e){var t=e.getState().settings.is_radio_stream_enabled?"block":"none",n=e.getState().settings.radio_stream_on_img?"/uploads/"+e.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg",t="<div id='radio-container' style='display: "+t+"'>";return t+="<img class='radio-container__off' src='"+(e.getState().settings.radio_stream_off_img?"/uploads/"+e.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg")+"' alt=''/>",(t+="<img class='radio-container__on active' src='"+n+"' alt=''/>")+"</div>"}}],(de=null)&&j(_t.prototype,de),j(_t,gt),U),I=n(32);function U(){!function(e){if(!(e instanceof U))throw new TypeError("Cannot call a class as a function")}(this)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=(St=N,kt=[{key:"registerEvents",value:function(e){}},{key:"render",value:function(e){var t="<div id='chat__body__live-pane' class='chat_pane' style='background: #FFFFFF'>";return t+=x.a.render("البث المباشر"),t+="<div class='chat_pane__container border'>",t+=D.render(e),t+="<div id='chat__body__live-pane__tv' class='fl'>",t+="<iframe src='"+I.a.parseURL(e.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",t+="</div>",(t+="</div>")+"</div>"}}],(t=null)&&L(St.prototype,t),L(St,kt),N),F=n(4);function N(){!function(e){if(!(e instanceof N))throw new TypeError("Cannot call a class as a function")}(this)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=(Qe=z,de=[{key:"render",value:function(e){var t="<div id='chat__body' style='background: "+Object(p.n)(e.getState().settings)+"'>";return window.is_mic_enabled&&(t+=F.a.render(e)),t+=w.a.render(),t+=S.a.render(e),t+=k.a.render(e),t+=C.a.render(e),t+=E.a.render(e),t+=T.a.render(e),t+=O.a.render(e),t+=P.a.render(e),t+=A.a.render(e),t+=B.render(e),t+=R.a.render(e),t+="<audio style='display: none;' id='private-bip'>",t+="<source src='private-bip.mp3' type='audio/mpeg'>",t+="<source src='private-bip.ogg' type='audio/ogg'>",(t+="</audio>")+"</div>"}}],(_t=null)&&q(Qe.prototype,_t),q(Qe,de),z),W=n(22),V=n(1),H=n(18);function z(){!function(e){if(!(e instanceof z))throw new TypeError("Cannot call a class as a function")}(this)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Y=(gt=ee,t=[{key:"registerEvents",value:function(e){ee.onParticleLoaded(e)}},{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"insertParticles",value:function(e){if($("#floating_particles"))for(var t=0;t<2;t++)"heart"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_heart1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_heart2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_heart3.png" width="50" height="50" alt="" />')),"gift"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_gift1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_gift2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift3.png" width="50" height="50" alt="" />')),"ad"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_ad1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_ad2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_ad3.png" width="50" height="50" alt="" />')),"rose"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_rose1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_rose2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(p.c)()+'/images/floating_rose3.png" width="50" height="50" alt="" />'))}},{key:"onParticleLoaded",value:function(r){$(".floating_particles__item").unbind("load").on("load",function(e){ee.insertParticles(r),$(".floating_particles__item").toArray().forEach(function(e){var t=$("body").width()-100,n=ee.getRandomInt(50,150);try{$(e).animate({lef:ee.getRandomInt(0,t),right:ee.getRandomInt(0,t),bottom:ee.getRandomInt(30,500),width:n,height:n},ee.getRandomInt(1e3,3e3),function(){$(e).animate({top:"-100%",opacity:0},ee.getRandomInt(5e3,15e3),function(){try{$(e).unbind("load").remove()}catch(e){}r.getState().particleType&&r.dispatch(h(null))})})}catch(e){}})})}},{key:"toggle",value:function(e){e.getState().settings.disable_floating_particles||($("#floating_particles .floating_particles__item").remove(),$("#floating_particles").append("<img class='floating_particles__item' src='"+Object(p.c)()+"/images/floating_"+e.getState().particleType+"1.png' width='50' height='50' alt='' />"),ee.onParticleLoaded(e))}},{key:"render",value:function(e){var t="<div id='floating_particles'>";return e.getState().settings.disable_floating_particles||(t+="<img class='floating_particles__item' src='"+Object(p.c)()+"/images/floating_rose1.png' width='50' height='50' alt='' />"),t+"</div>"}}],(St=null)&&J(gt.prototype,St),J(gt,t),ee),X=n(26),K=n(12),Q=n(8),Z=n(6);function ee(){!function(e){if(!(e instanceof ee))throw new TypeError("Cannot call a class as a function")}(this)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne=(kt=oe,_t=[{key:"registerEvents",value:function(e){}},{key:"append",value:function(e){var t;e.royalLogin&&(t=Math.floor(4*Math.random())+1,t="<div class='royal_login_item' id='royal_login_item--"+e.reg_id+"' style='background-image: url(/images/royal_login_bg"+t+".png)'>",t+="<img class='royal_login_item__img' src='"+e.avatar+"'/>",t+="<p  class='royal_login_item__name'>"+Z.a.render(e)+"</p>",t+="</div>",$("#royal_login_container").append(t),$("#royal_login_item--"+e.reg_id).animate({left:0},500,"linear",function(){setTimeout(function(){$("#royal_login_item--"+e.reg_id).animate({left:-300},500,"linear",function(){$("#royal_login_item--"+e.reg_id).remove()})},3e3)}))}}],(Qe=null)&&te(kt.prototype,Qe),te(kt,_t),oe),re=n(13);function oe(){!function(e){if(!(e instanceof oe))throw new TypeError("Cannot call a class as a function")}(this)}function ie(e,t){switch(this.store=t,e.type){case"NEW_USER":return this.newUser(e.data.user);case"USER_OUT":return this.userOut(e.data.user,e.data.force);case"NOTIFY_USER_OUT":return this.notifyUserOut(e.data.user);default:return null}}ie.prototype.newUser=function(t){var e=this.store.getState().users.filter(function(e){return e.reg_id==t.reg_id})[0];e&&e.reg_id&&(this.store.dispatch(Object(_.b)(e)),this.store.dispatch(Object(K.g)(e.id,t.id,t)),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&this.store.dispatch(Object(K.f)(t))),this.store.dispatch(Object(_.a)(t)),this.store.dispatch({type:"REMOVE_OLD_USER_FROM_ROOM",oldSocketId:t.oldSocketId}),this.store.dispatch(l(t.id,null,t.room.id)),t.room&&this.store.getState().mUser.room&&t.room.id==this.store.getState().mUser.room.id&&!t.isMuted&&Q.a.insert({icon:t.avatar,title:t.name,user:t,content:"هذا المستخدم قد دخل ",room:t.room,type:"JOIN_LEAVE"},this.store),V.a.updateUsersCout(this.store),E.a.setRooms(this.store),ne.append(t)},ie.prototype.userOut=function(t,e){var n;window.ludoPlayers&&window.ludoPlayers.length&&((n=window.ludoPlayers.filter(function(e){return e.user_id==t.id})[0])&&re.a.userOut(this.store,n.color)),(this.store.getState().settings.is_fixed_login_enabled||t.fixedLogin)&&t.reg_id&&!e||(this.store.dispatch(Object(_.b)(t)),this.store.dispatch(Object(K.e)(t.id)),V.a.updateUsersCout(this.store),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==t.id&&(this.store.dispatch(Object(_.c)(null)),$("#user_profile").modal("hide")),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==t.id&&(this.store.dispatch(Object(K.f)(null)),$("#chat_box_container").html("")),this.store.dispatch(Object(K.d)(t.id)),V.a.updateConversationsCount(this.store),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==t.id&&this.store.dispatch(Object(K.f)(null)),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==t.id&&this.store.dispatch(Object(_.c)(null)),t.room&&this.store.dispatch(l(t.id,t.room.id,null)),this.notifyUserOut(t),E.a.setRooms(this.store),k.a.setUsers(this.store))},ie.prototype.notifyUserOut=function(t){var e;t.room&&this.store.getState().mUser.room&&t.room.id==this.store.getState().mUser.room.id&&(e=null,(e=t.isExcpeled?"(تم طرده من الدردشة)":t.isBanned?"(تم حظره من دخول الدردشة)":"(هذا المستخدم غادر الدردشة)")&&!this.store.getState().ignoredUsers.includes(t.id)&&Q.a.insert({icon:t.avatar,title:t.name,user:t,content:e,type:"JOIN_LEAVE"},this.store),(e=this.store.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t.id})[0])&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter(function(e){return e.user_id!=t.id}),F.a.removeUserFromMic(this.store,t,e.micId,!1,!0)))};var ae=ie,se=n(3),ce=n(2);function ue(e,t){switch(this.store=t,e.type){case"USER_JOINDED_ROOM":return this.userJoinedRoom(e.data);case"USER_EXPELED_FROM_ROOM":return this.userExcpeledFromRoom(e.data);case"USER_LEAVED_ROOM":return this.userLeavedRoom(e.data);case"PROFILE_ACTION_CHANGE_ROOM":return this.changeRoom(e.data);case"NEW_ROOM_CREATED":return this.addRoom(e.data);case"ROOMS_UPDATED":return this.updateRooms(e.data);case"ADMIN_ROOM_FLAG_UPDATED":return this.updateRoomFlag(e.data);case"ADMIN_ROOM_DELETED":return this.deleteRoom(e.data);default:return null}}ue.prototype.userJoinedRoom=function(e){e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(Object(_.d)(e.user)),this.store.dispatch(h("rose")),Y.toggle(this.store));var t=e.oldRoom?e.oldRoom.id:null,n=e.newRoom?e.newRoom.id:null,r=null,o=null,i=null;e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id&&(i=e.user.room,r=e.user.id==this.store.getState().mUser.id?"هذا المستخدم إنتقل إلى ":"هذا المستخدم قد دخل ",o="JOIN_LEAVE"),this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(r=n?(i=e.newRoom,"هذا المستخدم إنتقل إلى "):"هذا المستخدم غادر الغرفة ",o="JOIN_LEAVE"),r&&o&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Q.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,content:r,room:i,type:o},this.store),this.store.dispatch(Object(_.h)(e.user)),e.user.isMuted||(this.store.dispatch(l(e.user.id,t,n)),e.user.id!=this.store.getState().mUser.id&&E.a.setRooms(this.store)),e.newRoom&&e.newRoom.welcome&&e.user.id==this.store.getState().mUser.id&&Q.a.insert({icon:e.newRoom.flag,content:e.newRoom.welcome,type:"ROOM_GREETING"},this.store),F.a.leaveRoom(this.store,e.user)},ue.prototype.userExcpeledFromRoom=function(e){e.user.id==this.store.getState().mUser.id&&F.a.toggle(this.store,!1,e.oldRoom);var t=e.oldRoom?e.oldRoom.id:null,n=null,r=null;this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(t&&(n="(هذا المستخدم تم طرده من الغرفة)"),r="JOIN_LEAVE"),n&&r&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Q.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:n,type:r},this.store),t&&e.user.id&&!e.user.isMuted&&this.store.dispatch(l(e.user.id,t,null))},ue.prototype.userLeavedRoom=function(t){!this.store.getState().mUser.room||(r=this.store.getState().mUser.room.micUsers.filter(function(e){return e.user_id==t.user.id})[0])&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter(function(e){return e.user_id!=t.user.id}),F.a.removeUserFromMic(this.store,t.user,r.micId,!1,!0)),t.user.id==this.store.getState().mUser.id&&(this.store.dispatch(Object(_.d)(t.user)),F.a.resetAllMics());var e=t.oldRoom?t.oldRoom.id:null,n=null,r=null;this.store.getState().mUser.room&&e==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=t.user.id&&(e&&(n="(هذا المستخدم غادر الغرفة)"),r="JOIN_LEAVE"),n&&r&&!t.user.isMuted&&!this.store.getState().ignoredUsers.includes(t.user.id)&&Q.a.insert({icon:t.user.avatar,title:t.user.name,user:t.user,room:null,content:n,type:r},this.store),this.store.dispatch(Object(_.h)(t.user)),e&&t.user.id&&!t.user.isMuted&&this.store.dispatch(l(t.user.id,e,null)),E.a.setRooms(this.store)},ue.prototype.changeRoom=function(e){!1===e.error&&(e={id:Date.now(),user:e.user,type:"change_room",room:e.room,message:"تم نقلك إلى ",title:"تغيير الغرفة"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store),S.a.toggleInput(this.store))},ue.prototype.addRoom=function(e){e&&e.room&&(this.store.dispatch(function(e){e=0<arguments.length&&void 0!==e?e:{};return{type:"ADD_ROOM",room:{id:e.id,name:e.name,password:e.password,welcome:e.welcome,description:e.description,capacity:e.capacity,flag:e.flag,users:e.users}}}(e.room)),E.a.setRooms(this.store))},ue.prototype.updateRooms=function(e){var r=this;e&&Array.isArray(e.rooms)&&(e.rooms.forEach(function(t){var e=!1,n=r.store.getState().rooms.filter(function(e){return e.id==t.id})[0];n&&(e=n.is_voice_room),r.store.dispatch({type:"UPDATE_ROOM",room:t}),r.store.getState().mUser.room&&r.store.getState().mUser.room.id==t.id&&(r.store.dispatch(Object(_.f)({room:t})),t.is_voice_room&&!e&&F.a.toggle(r.store,t.is_voice_room))}),E.a.setRooms(this.store))},ue.prototype.updateRoomFlag=function(e){e&&e.room&&(this.store.dispatch({type:"UPDATE_ROOM_FLAG",id:e.room.id,flag:e.room.flag}),E.a.setRooms(this.store))},ue.prototype.deleteRoom=function(e){var t=this;e&&Array.isArray(e.ids)&&(e.ids.forEach(function(e){t.store.dispatch({type:"DELETE_ROOM",id:e})}),E.a.setRooms(this.store))};var le=ue,de=n(35),pe=n.n(de);function fe(e,t){switch(this.store=t,e.type){case"NEW_PUBLIC_MESSAGE":return this.onNewMessage(e.data);case"REMOVE_PUBLIC_MESSAGE":return this.removeMessage(e.data);case"NEW_AD":return this.onNewAd(e.data);case"SELF_MESSAGE":return this.onSelfMessage(e.data);default:return null}}fe.prototype.onNewMessage=function(e){e&&e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id&&(this.store.getState().ignoredUsers.includes(e.user.id)||Q.a.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"PUBLIC_MESSAGE"},this.store))},fe.prototype.removeMessage=function(e){e&&e.id&&Q.a.remove(e.id)},fe.prototype.onNewAd=function(e){e&&(this.store.getState().ignoredUsers.includes(e.user.id)||Q.a.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"AD"},this.store))},fe.prototype.onSelfMessage=function(e){e&&e.message&&(Q.a.clearSelfMessages(),Q.a.insert({id:pe()(),user:null,icon:null,title:e.message.title,content:e.message.msg,type:"SELF_MESSAGE"},this.store))};var he=fe,me=n(17);function _e(e,t){switch(this.store=t,e.type){case"NEW_PRIVATE_MESSAGE":return this.onNewMessage(e.data);case"PRIVATE_MESSAGE_READ":return this.readPrivageMessage(e.data);default:return null}}_e.prototype.onNewMessage=function(e){var t,n,r,o,i;e.from&&e.from.id!=this.store.getState().mUser.id&&!this.store.getState().ignoredUsers.includes(e.from.id)&&(t=e.from.id,n=this.store.getState().mUser,r=e.from,o=e.message,i=!(!this.store.getState().currentConversation||this.store.getState().currentConversation.id!=t),this.store.dispatch(Object(K.a)(t,n,r,i,o)),i?me.a.insert(o,r,this.store):me.a.playNotification(this.store),V.a.updateConversationsCount(this.store),"conversations"==this.store.getState().currentPane&&C.a.renderConversations(this.store),i&&this.store.getState().socket.emit("req",Object(p.f)({type:"PRIVATE_MESSAGE_READ",data:{userID:e.from.id}}),function(e){}))},_e.prototype.readPrivageMessage=function(e){var t=e.toUser.id,n=this.store.getState().mUser,e=e.toUser;this.store.dispatch(Object(K.c)(t,n,e)),me.a.markMessagesAsRead(this.store,t)};var ge=_e;function ve(e,t){switch(this.store=t,e.type){case"PROFILE_ACTION_NOTIFY":return this.notify(e.data);case"PROFILE_ACTION_LIKE":return this.like(e.data);case"PROFILE_ACTION_GIFT":return this.gift(e.data);case"PROFILE_ACTION_REMOVE_GIFT":return this.removeGift(e.data);case"PROFILE_ACTION_CHANGE_DECORATION":return this.changeDecoration(e.data);case"PROFILE_ACTION_CONTROL_LIKES":return this.controlLikes(e.data);case"PROFILE_ACTION_ROOM_EXCPEL":return this.roomExcpel(e.data);case"PROFILE_ACTION_CHANGE_ROLE":return this.changeRole(e.data);case"PROFILE_LIKE_ALBUM_PHOTO":return this.photoLiked(e.data);default:return null}}ve.prototype.notify=function(e){e.user&&e.message&&(e={id:Date.now(),user:e.user,message:e.message,title:"تنبيه",type:"notify"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},ve.prototype.like=function(e){e.user&&(e={id:Date.now(),user:e.user,type:"like",message:null,title:"إعجاب"},this.store.dispatch(Object(se.a)(e)),this.store.dispatch(h("heart")),Y.toggle(this.store),ce.a.render(e,this.store))},ve.prototype.gift=function(e){e.user&&(e={id:Date.now(),user:e.user,type:"gift",message:e.message,title:"هدية"},this.store.dispatch(Object(se.a)(e)),this.store.dispatch(h("gift")),Y.toggle(this.store),ce.a.render(e,this.store))},ve.prototype.removeGift=function(e){e.user&&(e={id:Date.now(),user:e.user,type:"remove_gift",message:e.message,title:"سحب الهدية"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},ve.prototype.changeDecoration=function(e){e.user&&(e={id:Date.now(),user:e.user,type:"change_decoration",message:"تم تغيير زخرفة إسمك",title:"الزخرفة"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store),P.a.updateDecoration(this.store))},ve.prototype.controlLikes=function(e){e.user&&(e={id:Date.now(),user:e.user,type:"control_likes",message:"تم منحك "+e.likes+" إعجباب",title:"إعجاب"},this.store.dispatch(Object(se.a)(e)),this.store.dispatch(h("heart")),Y.toggle(this.store),ce.a.render(e,this.store))},ve.prototype.roomExcpel=function(e){e.user&&(e={id:Date.now(),user:e.user,room:e.oldRoom,type:"room_excpel",message:"تم طردك من الغرفة",title:"طرد"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},ve.prototype.changeRole=function(e){e={id:Date.now(),user:e.user,type:"change_role",message:"تمت ترقيتك إلى "+e.roleName,title:"ترقية"};this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store)},ve.prototype.photoLiked=function(e){e&&e.user&&e.photo&&(e={id:Date.now(),user:e.user,type:"photo_like",message:"قام بالإعجاب بصورتك",photo:e.photo,title:"إعجاب"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))};var ye=ve,be=n(21),we=n(37);function Se(e,t){switch(this.store=t,e.type){case"GREET_USER":return this.greetUser(e.data);case"USER_UPDATED":return this.userUpdated(e.data);case"USERS_UPDATED":return this.usersUpdated(e.data);case"LOGIN_BANNED":return this.loginBanned(e.data);default:return null}}Se.prototype.greetUser=function(e){var t=this;F.a.joinRoom(this.store),e&&e.messages&&e.messages.forEach(function(e){Q.a.insert({icon:e.icon,title:e.title,content:e.content,titleColor:e.titleColor,contentColor:e.contentColor,backgroundColor:e.backgroundColor,type:"GREET_USER"},t.store)})},Se.prototype.userUpdated=function(e){this.store.dispatch(Object(_.i)(e)),this.store.dispatch(Object(_.g)(e)),this.store.dispatch(function(e){return{type:"UPDATE_PUBLIC_MESSAGE_USER",user:0<arguments.length&&void 0!==e?e:{}}}(e)),this.store.dispatch(Object(K.i)(e)),this.store.dispatch(Object(be.j)(e)),this.store.dispatch(Object(K.h)(e)),e.id==this.store.getState().mUser.id&&this.store.dispatch(Object(_.f)(e.updates)),e.updates.state&&"state_out"==e.updates.state&&(this.store.dispatch(Object(K.e)(e.id)),C.a.render(this.store),V.a.updateConversationsCount(this.store)),k.a.updateUser(e.id,this.store),Q.a.updateUser(e.id,this.store),me.a.updateUser(e.id,this.store),we.a.updateUser(e.id,this.store)},Se.prototype.usersUpdated=function(e){var t=this;e&&Array.isArray(e.updates)&&e.updates.forEach(function(e){t.userUpdated(e)})},Se.prototype.loginBanned=function(e){e={id:Date.now(),data:e,title:"دخول المحظورين",type:"login_banned"};this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store)};var ke=Se,Ce=n(45);function Ee(e,t){switch(this.store=t,e.type){case"POST_ADDED":return this.postAdded(e.data);case"POST_UPDATED":return this.postUpdated(e.data);case"POST_LIKED":return this.postLiked(e.data);case"POST_REMOVED":return this.postRemoved(e.data);case"YOUR_POST_IS_REMOVED":return this.yourPostIsRemoved(e.data);case"POST_COMMENTED":return this.postCommented(e.data);case"POST_COMMENT_LIKED":return this.postCommentLiked(e.data);case"POST_COMMENT_ADDED":return this.postCommentAdded(e.data);case"POST_COMMENT_DELETED":return this.postCommentDeleted(e.data);default:return null}}Ee.prototype.postAdded=function(e){this.store.getState().ignoredUsers.includes(e.user.id)||(this.store.dispatch(Object(be.a)(e,this.store.getState().settings.wall_msg_count)),"wall"!=this.store.getState().currentPane&&(this.store.dispatch(Object(be.c)()),V.a.updateWallCout(this.store)),T.a.addPost(e,this.store))},Ee.prototype.postUpdated=function(e){this.store.dispatch(Object(be.i)(e)),T.a.updatePost(e.id,this.store)},Ee.prototype.postLiked=function(e){e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)&&(e={id:Date.now(),user:e.user,message:"قام بالإعجاب بمنشورك",title:"إعجاب",type:"post_like"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},Ee.prototype.postRemoved=function(e){this.store.dispatch(Object(be.e)(e.id)),T.a.removePost(e.id)},Ee.prototype.yourPostIsRemoved=function(e){e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)&&(e={id:Date.now(),user:e.user,message:"قام بحذف بمنشورك",title:"إعجاب",type:"post_remove"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},Ee.prototype.postCommented=function(e){var t;e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)&&(t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,post_id:e.postId,message:"قام بالتعليق على منشورك",title:"تعليق",type:"post_commented"},this.store.dispatch(Object(se.a)(t)),ce.a.render(t,this.store),T.a.updatePost(e.postId,this.store))},Ee.prototype.postCommentLiked=function(e){var t;e.user&&e.commentId&&!this.store.getState().ignoredUsers.includes(e.user.id)&&(t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,message:"قام بالإعجاب بتعليقك",title:"إعجاب",type:"post_comment_like"},this.store.dispatch(Object(se.a)(t)),ce.a.render(t,this.store),Ce.a.incCommentLikes(e.commentId))},Ee.prototype.postCommentAdded=function(e){this.store.dispatch(Object(be.d)({id:e.post_id})),T.a.updatePost(e.post_id,this.store),e.comment.time=Date.now(),Ce.a.add(e.comment,this.store)},Ee.prototype.postCommentDeleted=function(e){this.store.dispatch(Object(be.b)({id:e.post_id})),T.a.updatePost(e.post_id,this.store),Ce.a.remove(e.id)};var Te=Ee;function Oe(e,t){switch(this.props=t,e.type){case"RESET_FACES":return this.setGifts(e.data);case"RESET_GIFTS":return this.setFaces(e.data);default:return null}}Oe.prototype.setGifts=function(e){e.faces&&this.props.dispatch(f(e.faces))},Oe.prototype.setFaces=function(e){e.gifts&&this.props.dispatch(d(e.gifts))};function Pe(){return{type:"SET_SETTINGS",settings:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}}var Ae=Oe;function Re(e,t){return"SET_SETTINGS"!==(this.store=t,e.type)?null:this.setSettings(e.data)}Re.prototype.setSettings=function(e){e&&e.settings&&(e=e.settings[Object(p.g)()]?e.settings[Object(p.g)()]:e.settings,this.store.dispatch(Pe(e)),Object(p.b)(e),V.a.toggleTV(this.store),I.a.update(this.store),T.a.update(this.store),D.update(this.store),D.toggle(this.store))};var xe=Re;function Me(e,t){switch(this.store=t,e.type){case"MIC_NEW_SPEAKER":return this.micNewSpeaker(e.data);case"MIC_SPEAKER_LEAVED":return this.micSpeakerLeaved(e.data);case"MIC_SPEAKER_MUTED":return this.micSpeakerMuted(e.data);case"MIC_RECALL_USER":return this.micRecallUser(e.data);default:return null}}Me.prototype.micNewSpeaker=function(e){this.store.getState().mUser.room.micUsers.push({micId:e.micId,user_id:e.user.id}),F.a.setUserOnMic(this.store,e.user,e.micId)},Me.prototype.micSpeakerLeaved=function(t){var e;this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter(function(e){return e.user_id!=t.user.id}),F.a.removeUserFromMic(this.store,t.user,t.micId,!0),t.acter&&t.acter.id!=this.store.getState().mUser.id&&t.user.id==this.store.getState().mUser.id&&(e={id:Date.now(),user:t.acter,message:"قام بسحب المايك منك",title:"سحب مايك",type:void 0},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},Me.prototype.micSpeakerMuted=function(t){!window.incomingMicStreams[t.micId]||t.muted||F.a.isMicMuted(t.micId)||(window.incomingMicStreams[t.micId].getTracks().forEach(function(e){e.enabled=!t.muted}),F.a.updateMicMutedStyle(t.micId,!t.muted))},Me.prototype.micRecallUser=function(e){e&&e.user&&F.a.callNewUser(this.store,e.user)};var je=Me;function De(e,t){switch(this.store=t,e.type){case"YOUCAM_LUDO_REQUESTED":return this.ludoRequested(e.data);case"YOUCAM_LUDO_REQUEST_ACCEPTED":return this.ludoRequestAccepted(e.data);case"YOUCAM_LUDO_REQUEST_REFUSED":return this.ludoRequestRefused(e.data);case"YOUCAM_LUDO_START_GAME":return this.ludoStartGame(e.data);case"YOUCAM_LUDO_DICE_CLICKED":return this.ludoDiceClicked(e.data);case"YOUCAM_LUDO_PLAYER_CLICKED":return this.ludoPlayerClicked(e.data);case"YOUCAM_LUDO_UPDATE_TURN":return this.ludoUpdateTurn(e.data);case"YOUCAM_LUDO_EXIT_GAME":return this.ludoExitGame(e.data);case"YOUCAM_LUDO_END_GAME":return this.ludoEndGame(e.data);default:return null}}De.prototype.ludoRequested=function(e){e&&e.user&&(e={id:Date.now(),data:e.user,user:e.user,color:e.color,title:"طلب لعب",type:"ludo_request"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))},De.prototype.ludoRequestAccepted=function(e){e&&e.user&&($("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").attr("src","/images/check_ok.png").show(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).attr("src","/images/check_ok.png").hide(),$("#pre_youcam_ludo_modal__body__form--select-"+e.color).prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-red option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-green option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-yellow option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-blue option[value='"+e.user.id+"']").prop("disabled",!0),1<$("#pre_youcam_ludo_modal__body__form img[src='/images/check_ok.png']").length&&$(".pre_youcam_ludo_modal__body__form__button--start").removeAttr("disabled"))},De.prototype.ludoRequestRefused=function(e){var t;e&&e.user&&(t={id:Date.now(),data:e.user,user:e.user,title:"طلب لعب",type:"ludo_request_refused"},this.store.dispatch(Object(se.a)(t)),ce.a.render(t,this.store),$("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).show())},De.prototype.ludoStartGame=function(e){var t;e&&(t=!1,window.mUserLudoColor||(t=!0),window.mUserLudoColor=e.color,window.ludoPlayers=e.players,window.ludoCurrentTurn=e.turn,t&&(re.a.render(this.store),e.color||($("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),re.a.onShowLudo(this.store))))},De.prototype.ludoDiceClicked=function(e){e&&e.color!=window.mUserLudoColor&&re.a.rollDice(e.color,e.value)},De.prototype.ludoPlayerClicked=function(e){var t;e&&e.color!=window.mUserLudoColor&&(t=$("#"+e.id),re.a.movePlayer(t,e.value,this.store,e.color))},De.prototype.ludoUpdateTurn=function(e){e&&e.color!=window.mUserLudoColor&&re.a.updateTurn(e.value)},De.prototype.ludoExitGame=function(e){e&&e.color!=window.mUserLudoColor&&re.a.userOut(this.store,e.color)},De.prototype.ludoEndGame=function(e){e&&re.a.gameEnded(this.store,e.color)};var Ie=De,Ue=n(43),Le=n(29),Be=n(44);function Fe(e,t){switch(this.store=t,e.type){case"CALL_REQUESTED":return this.callRequested(e.data);case"CALL_REQUEST_CANCELLED":return this.callRequestCancelled(e.data);case"CALL_REQUEST_ACCEPTED":return this.callRequestAccepted(e.data);default:return null}}Fe.prototype.callRequested=function(e){e&&e.caller&&(this.store.dispatch(Object(Le.a)(!0)),e={user:e.caller,dialogType:"call-received",statusClass:"success",status:"لديك إتصال الآن..."},this.store.dispatch(Object(Ue.a)(e)),Be.a.render(this.store,e))},Fe.prototype.callRequestCancelled=function(e){this.store.dispatch(Object(Le.a)(!1)),this.store.dispatch(Object(Ue.a)(null)),Be.a.close(),this.store.getState().webrtc&&(this.store.getState().webrtc.leaveRoom(),this.store.getState().webrtc.stopLocalVideo(),this.store.getState().webrtc.releaseGroup(),this.store.dispatch(function(e){return{type:"SET_RADIO_CONNECTION_READY",radioConnectionReady:0<arguments.length&&void 0!==e&&e}}(!1)))},Fe.prototype.callRequestAccepted=function(e){this.store.dispatch(Object(Ue.a)({user:e.caller,dialogType:"call-sent",statusClass:"success",status:"بدأ المكالمة"})),Be.a.onCallAccepted()};var Ne=Fe;function $e(e,t){switch(this.store=t,e.type){case"BOT_BRB_START_COUNTDOWN":return this.startCountdown(e.data);case"BOT_BRB_PAUSED":return this.paused(e.data);case"BOT_BRB_STOPPED":return this.stopped(e.data);case"BOT_BRB_ENDED":return this.ended(e.data);case"BOT_BRB_RIGHT_ANSWER":return this.rightScore(e.data);default:return null}}$e.prototype.startCountdown=function(e){e&&e.message&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Q.a.insert({id:pe()(),user:null,icon:null,title:"إستعداد لبدء البوت",content:e.message,type:"BOT_BRB_MESSAGE"},this.store)},$e.prototype.paused=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Q.a.insert({id:pe()(),user:null,icon:null,title:"إيقاف مؤقت",content:"تم إيقاف البوت بشكل مؤقت",type:"BOT_BRB_MESSAGE"},this.store)},$e.prototype.stopped=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Q.a.insert({id:pe()(),user:null,icon:null,title:"إيقاف البوت",content:"تم إيقاف البوت",type:"BOT_BRB_MESSAGE"},this.store)},$e.prototype.ended=function(e){var t;e&&e.room_id&&(e.winner&&e.winner.id==this.store.getState().mUser.id&&(t={id:Date.now(),user:null,message:"مبروك الفوز في مسابقة أطرد خصمك, إضعط على أي شخص لطرده من الغرفة",title:"مبروك الفوز",type:"notify"},this.store.dispatch(Object(se.a)(t)),ce.a.render(t,this.store)),Q.a.insert({id:pe()(),user:e.winner,title:"",content:e.winner?"مبروك فوز هذا المتسابق":"إنتهت المسابقة بدون فائز",type:"BOT_BRB_MESSAGE"},this.store))},$e.prototype.rightScore=function(e){e&&e.room_id&&e.user&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Q.a.insert({id:pe()(),user:e.user,title:"",content:"عدد النقاط "+e.num_points,type:"BOT_BRB_MESSAGE"},this.store)};var qe=$e,Ge=n(20);function We(e,t){return"FILTER_SEND_NOTIFICATION"!==(this.store=t,e.type)?null:this.sendNotification(e.data)}We.prototype.sendNotification=function(e){var t;e.user&&e.word&&(t="denied"==e.word.type?"كلمة ممنوعة":"كلمة مراقبة",e={id:Date.now(),user:e.user,title:t,word:e.word,type:"world_filter_notification"},this.store.dispatch(Object(se.a)(e)),ce.a.render(e,this.store))};var Ve=We,He=n(34);function ze(e,t){switch(this.store=t,e.type){case"BROADCAST_LIVE_STARTED":return this.broadcastLiveStarted(e.data);case"BROADCAST_LIVE_ENDED":return this.broadcastLiveEnded(e.data);default:return null}}ze.prototype.broadcastLiveStarted=function(e){var t=this;e&&e.id&&setTimeout(function(){He.a.renderButton(t.store,e.id)},5e3)},ze.prototype.broadcastLiveEnded=function(e){e&&e.id&&He.a.close(this.store,$(".broadcast_live_box").first(),!0)};var Je=ze;function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=(St=et,gt=[{key:"registerEvents",value:function(e){et.onClick(e)}},{key:"initUpdateTimeHandler",value:function(){setInterval(function(){for(var e=document.getElementsByClassName("time"),t=0;t<e.length;t++){var n=e[t];n.textContent=Object(p.q)(n.dataset.time)}},6e4)}},{key:"registerSocketEvents",value:function(t){t.getState().socket.on("res",function(e){(e=Object(p.d)(e))&&"object"==Ye(e)&&"string"==typeof e.type&&"object"==Ye(e.data)&&("object"==Ye(e.data)&&Object(p.l)(e.data),new ae(e,t),new le(e,t),new he(e,t),new ge(e,t),new ye(e,t),new ke(e,t),new Te(e,t),new Ae(e,t),new xe(e,t),new Ne(e,t),new Ve(e,t),new Ie(e,t),new Je(e,t),new qe(e,t),window.is_mic_enabled&&new je(e,t))})}},{key:"registerDOMEvents",value:function(e){et.registerEvents(e),w.a.registerEvents(e),W.a.registerEvents(e),S.a.registerEvents(e),V.a.registerEvents(e),k.a.registerEvents(e),x.a.registerEvents(e),E.a.registerEvents(e),H.a.registerEvents(e),T.a.registerEvents(e),D.registerEvents(e),X.a.registerEvents(e),P.a.registerEvents(e),A.a.registerEvents(e),R.a.registerEvents(e),window.is_mic_enabled&&F.a.registerEvents(e),I.a.registerEvents(e),Y.registerEvents(e)}},{key:"onClick",value:function(i){$("#chat").unbind("click").on("click",function(e){var t=document.querySelector("#chat__body__message-input__face"),n=document.querySelector("#chat_box__footer__smile"),r=document.querySelector("#chat__body__wall_pane__form__attach__face"),o=document.querySelector("#wall_comments__attach__face");t!==e.target&&i.dispatch(Object(g.a)(!1)),n!==e.target&&i.dispatch(Object(v.a)(!1)),r!==e.target&&i.dispatch(Object(y.a)(!1)),o!==e.target&&i.dispatch(Object(b.a)(!1)),W.a.toggle(i)})}},{key:"loadElementsToMemory",value:function(){window.publicMessagesContainer=$("#chat__body__messages_container"),window.usersPane=$("#chat__body__users-pane"),window.conversationsPane=$("#chat__body__conversations_pane"),window.roomsPane=$("#chat__body__rooms_pane"),window.wallPane=$("#chat__body__wall_pane"),window.wallCreatorPane=$("#chat__body__wall_creator_pane"),window.ignoredUsersPane=$("#chat__body__ignored-users-pane"),window.notificationsPane=$("#chat__body__notifications-pane"),window.settingsPane=$("#chat__body__settings_pane"),window.chatFooter=$("#chat__footer")}},{key:"render",value:function(e){window.consumedData=0;var t="<div id='chat'>";t+=G.render(e),t+=V.a.render(e),t+="<div id='tv_box'></div>",t+="<div id='user_profile_container'></div>",t+="<div id='wall_comments_container'></div>",t+="<div id='create_room_container'></div>",t+="<div id='edit_room_container'></div>",t+="<div id='chat_box_container'></div>",t+="<div id='popup_container'></div>",t+="<div id='youcam_ludo_container'></div>",t+="<div id='broadcast_live_container'></div>",t+="<div id='call_container'></div>",t+="<div id='royal_login_container'></div>",t+="<div id='manage_bot_brb_container'></div>",t+=Y.render(e),t+='<audio autoplay id="calls-audio"></audio>',t+="</div>",$("#app").html(t),$(".crisp-client").hide(),et.loadElementsToMemory(),V.a.toggleTV(e),V.a.updateConversationsCount(e),T.a.update(e),Ge.a.render(e),et.registerSocketEvents(e),et.registerDOMEvents(e),et.initUpdateTimeHandler(),Object(p.k)(),window.onbeforeunload=function(){if(window.confirmOnExit)return"هل أنت متأكد من مغادرة الدردشة؟"},window.callsAudio=document.querySelector("#calls-audio")}}],(t=null)&&Xe(St.prototype,t),Xe(St,gt),et),Qe=n(94),Ze=n.n(Qe);function et(){!function(e){if(!(e instanceof et))throw new TypeError("Cannot call a class as a function")}(this)}function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=(kt=ot,_t=[{key:"registerEvents",value:function(t){ot.registerConnectionState(t),$(".react-tabs__tab").unbind("click").on("click",function(e){$(this).siblings().removeClass("react-tabs__tab--selected"),$(this).addClass("react-tabs__tab--selected")}),$("#guest-form").on("submit",function(e){ot.onGuestLogin(e,t),F.a.addMidAudios()}),$("#login-form").on("submit",function(e){ot.onMemberLogin(e,t),F.a.addMidAudios()}),$("#register-form").on("submit",function(e){ot.onRegister(e,t)}),Object(p.i)("mun")&&($("#react-tabs-1 a").removeClass("active"),$("#react-tabs-1").removeClass("react-tabs__tab--selected"),$("#guest").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),1<location.search.length&&($("#guest-form__name").val(location.search.replace("?","")),$("#guest-form__submit").trigger("click"))}},{key:"registerConnectionState",value:function(e){var t=e.getState().socket;t.on("connect",function(){$("#connection-state-on").css("display","inline"),$("#connection-state-off").css("display","none"),F.a.init(e),ot.initPeer(e)}),t.on("disconnect",function(){window.confirmOnExit=!1,$("#connection-state-off").css("display","inline"),$("#connection-state-on").css("display","none"),location.reload()})}},{key:"initPeer",value:function(e){window.outgoinCall={},window.outgoinStream={},window.incomingCall=null,window.peer=new Ze.a(e.getState().socket.id,{host:"peerjs-server.herokuapp.com",port:443,secure:!0,config:{iceServers:[{username:"SaKm_DT0L5D38QdKLaT8CoWwoFt1eBnoiqh_EVaFO976KPxl5J8wRqjEIhN34r0QAAAAAGPtHktzZW9iYXFlcg==",urls:["stun:fr-turn1.xirsys.com","turn:fr-turn1.xirsys.com:80?transport=udp","turn:fr-turn1.xirsys.com:3478?transport=udp","turn:fr-turn1.xirsys.com:80?transport=tcp","turn:fr-turn1.xirsys.com:3478?transport=tcp","turns:fr-turn1.xirsys.com:443?transport=tcp","turns:fr-turn1.xirsys.com:5349?transport=tcp"],credential:"f6633966-ad5a-11ed-a51a-0242ac120004"},{urls:["turn:relay1.metered.ca:80?transport=tcp","turn:relay1.metered.ca:443?transport=tcp"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["turn:relay1.metered.ca:443"],username:"639b693c74aedc15",credential:"7566bd5cda6bcf81"},{urls:["stun:relay1.metered.ca:80"]},{url:"stun:stun.chat-host.net:5349"},{url:"stun:stun.chat-host.net"},{url:"turn:turn.chat-host.net:5349",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"},{url:"turn:turn.chat-host.net",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"}]}})}},{key:"onGuestLogin",value:function(e,t){e.preventDefault();var n=e.target.name.value,e=(Object(p.d)(Object(p.i)("status"),!0),Object(p.d)(Object(p.i)("statusColor"),!0),Object(p.d)(Object(p.i)("fontColor"),!0),Object(p.d)(Object(p.i)("nameColor"),!0),Object(p.d)(Object(p.i)("nameBgColor"),!0),Object(p.d)(Object(p.i)("fontSize"),!0),Object(p.d)(Object(p.i)("avatar"),!0),Object(p.d)(Object(p.i)("isPrivateBipEnabled"),!0),{type:"GUEST_LOGIN",data:{name:n}});if(n.length>t.getState().settings.username_guest_length)return $(".tabs-form-error.error").show().text("إسم الزائر لا يجب أن يتعدى "+t.getState().settings.username_guest_length+" حرف");ot.hideFormAlerts(),$("form button").attr("disabled","disabled"),t.getState().socket.emit("req",Object(p.f)(e),function(e){ot.handleLoginResponse(Object(p.d)(e),!0,t)})}},{key:"onMemberLogin",value:function(e,t){e.preventDefault();e={type:"MEMBER_LOGIN",data:{name:e.target.name.value,password:e.target.password.value,hidden:e.target.hidden.checked}};ot.hideFormAlerts(),$("form button").attr("disabled","disabled"),t.getState().socket.emit("req",Object(p.f)(e),function(e){ot.handleLoginResponse(Object(p.d)(e),!1,t)})}},{key:"onRegister",value:function(e,r){e.preventDefault();var o=e.target.name.value,i=e.target.password.value,e={type:"REGISTER_MEMBER",data:{name:o,password:i}};if(o.length>r.getState().settings.username_register_length)return $(".tabs-form-error.error").show().text("إسم العضو لا يجب أن يتعدى "+r.getState().settings.username_register_length+" حرف");ot.hideFormAlerts(),$("form button").attr("disabled","disabled"),r.getState().socket.emit("req",Object(p.f)(e),function(e){e=Object(p.d)(e),$("form button").removeAttr("disabled");var t=e.error,n=e.message;t?ce.a.render({id:Date.now(),message:n,title:"تنبيه",type:"login_res"},r):($(".tabs-form-error.success").show().text(n),$("#react-tabs-3 a").removeClass("active"),$("#react-tabs-3").removeClass("react-tabs__tab--selected"),$("#register").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),e.error||($("#login-form__name").val(o),$("#login-form__password").val(i))})}},{key:"handleLoginResponse",value:function(e,t,n){var r,o;if("object"==tt(e))if(r=!!e.error,o=e.message,!1==r&&e.user){for(var i in $(".tabs-form-error.success").show().text(o),window.userActions=e.actions,window.roles=e.roles,window.shortcuts=e.shortcuts,e.privateMessages)ot.readPrivateMessage(n,e.privateMessages[i]);n.dispatch(Object(_.d)(e.user)),n.dispatch(Object(_.e)(e.users)),n.dispatch(function(e){return{type:"SET_ROOMS",rooms:0<arguments.length&&void 0!==e?e:[]}}(e.rooms)),n.dispatch(d(e.gifts)),n.dispatch(f(e.faces)),n.dispatch(function(e){return{type:"SET_GRANTED_SETTINGS",settings:0<arguments.length&&void 0!==e?e:{}}}(e.grantedSettings)),ot.openChat(a,n),Q.a.insert({icon:e.user.avatar,title:e.user.name,room:e.user.room,user:e.user,content:"هذا المستخدم قد دخل ",type:"JOIN_LEAVE"},n),e.user.room&&e.user.room.welcome&&Q.a.insert({icon:e.user.room.flag,content:e.user.room.welcome,type:"ROOM_GREETING"},n),n.dispatch(h("rose"));var a=24,a=t?(Object(p.p)("gun",Object(p.f)(e.user.name,!0)),Object(p.d)(Object(p.i)("fontSize"),!0)):(Object(p.p)("mun",Object(p.f)(e.cookie.name,!0)),Object(p.p)("mup",Object(p.f)(e.cookie.password,!0)),e.user.fontSize);e.user.royalLogin&&ne.append(e.user),e.user.room.micUsers.forEach(function(t){F.a.setUserOnMic(n,n.getState().users.filter(function(e){return e.id==t.user_id})[0],t.micId)}),F.a.toggle(n,n.getState().mUser.room.is_voice_room),$("body").attr("id","room-"+n.getState().mUser.room.id),e.isSubscriptionEnded&&ce.a.render({id:Date.now(),message:"تم إنتهاء إشتراكك, الرجاء مراسلة الإدارة للتجديد",title:"تنبيه",type:"login_res"},n),n.getState().mUser.room.ludoGameState.players&&(window.ludoPlayers=n.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=n.getState().mUser.room.ludoGameState.currentTurn,re.a.render(n,null,n.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),re.a.onShowLudo(n)),e.broadcastLive&&He.a.renderButton(n,e.broadcastLive)}else ce.a.render({id:Date.now(),message:o,title:"تنبيه",type:"login_res"},n);$("form button").removeAttr("disabled")}},{key:"readPrivateMessage",value:function(e,t){var n,r,o,i,a;t.from&&t.from.id!=e.getState().mUser.id&&!e.getState().ignoredUsers.includes(t.from.id)&&(n=t.from.id,r=e.getState().mUser,o=t.from,i=t.message,a=!(!e.getState().currentConversation||e.getState().currentConversation.id!=n),e.dispatch(Object(K.a)(n,r,o,a,i)),a?me.a.insert(i,o,e):me.a.playNotification(e),"conversations"==e.getState().currentPane&&C.a.renderConversations(e),a&&e.getState().socket.emit("req",Object(p.f)({type:"PRIVATE_MESSAGE_READ",data:{userID:t.from.id}}),function(e){}))}},{key:"hideFormAlerts",value:function(){$(".tabs-form-error").hide()}},{key:"openChat",value:function(e,t){Ke.render(t),document.querySelector("html").style.fontSize=e+"px"}},{key:"renderCopyrights",value:function(){return"<p id='youcam-copyrights' style='margin-bottom: 0; font-size: 0.625rem; text-align: right; padding: 0.35rem 0; background-color: white; margin-right: 0.36rem;'>تصميم وبرمجه: <a href='https://chat-host.net/'>يوكام هوست</a></p>"}},{key:"render",value:function(){var e="<div class='react-tabs'>";return e+="<ul class='nav nav-tabs react-tabs__tab-list' id='tabs' role='tablist'>",e+="<li class='nav-item react-tabs__tab react-tabs__tab--selected' id='react-tabs-1'>",e+="<a class='nav-link active' data-toggle='tab' href='#guest' role='tab' aria-controls='guest' aria-selected='true'><span class='fa fa-user'></span>دخول الزوار</a>",e+="</li>",e+="<li class='nav-item react-tabs__tab' id='react-tabs-2'>",e+="<a class='nav-link' data-toggle='tab' href='#member' role='tab' aria-controls='member' aria-selected='false'><span class='fa fa-user'></span>دخول الأعضاء</a>",e+="</li>",e+="<li class='nav-item react-tabs__tab' id='react-tabs-3'>",e+="<a class='nav-link' data-toggle='tab' href='#register' role='tab' aria-controls='register' aria-selected='false'><span class='fa fa-user'></span>تسجيل عضوية</a>",e+="</li>",e+="</ul>",e+="<div class='tab-content' id='tabs-content'>",e+="<div class='tab-pane fade show active' id='guest' role='tabpanel' aria-labelledby='home-tab'>",e+="<form id='guest-form'>",e+="<div>",e+="<input type='text' name='name' class='corner border' id='guest-form__name' value='"+Object(p.d)(Object(p.i)("gun"),!0)+"' placeholder='أكتب الإسم المستعار' />",e+="<button id='guest-form__submit' class='btn btn-primary buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="</div>",e+="</form>",e+="</div>",e+="<div class='tab-pane fade' id='member' role='tabpanel' aria-labelledby='profile-tab'>",e+="<form id='login-form'>",e+="<div>",e+="<input type='text' name='name' class='border corner' id='login-form__name' value='"+Object(p.d)(Object(p.i)("mun"),!0)+"' placeholder='أكتب إسم العضو' />",e+="<input autocomplete='off' type='password' name='password' class='border corner' id='login-form__password' value='"+Object(p.d)(Object(p.i)("mup"),!0)+"' placeholder='أكتب كلمة المرور' />",e+="<button id='login-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="<input type='checkbox' name='hidden' id='login-form__hidden-checkbox' />",e+="<label for='login-form__hidden-checkbox' id='login-form__hidden-label'>دخول مخفي</label>",e+="</div>",e+="</form>",e+="</div>",e+="<div class='tab-pane fade' id='register' role='tabpanel' aria-labelledby='contact-tab'>",e+="<form id='register-form'>",e+="<div>",e+="<input type='text' class='border corner' id='register-form__name' name='name' placeholder='أكتب إسم العضو'/>",e+="<input autoComplete='OFF' autocomplete='new-password' type='password' name='password' class='border corner' id='register-form__password' placeholder='أكتب كلمة المرور'/>",e+="<button id='register-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="</div>",e+="</form>",e+="</div>",e+="</div>",e+="<div id='connection_container'>",e+="<span class='connected' id='connection-state-on' style='display: none;'>متصل</span>",e+="<span id='connection-state-off'>غير متصل</span>",e+="</div>",e+=ot.renderCopyrights(),e+="<div class='alert alert-danger tabs-form-error error' style='display: none'></div>",(e+="<div class='alert alert-success tabs-form-error success' style='display: none'></div>")+"</div>"}}],(de=null)&&nt(kt.prototype,de),nt(kt,_t),ot);function ot(e){!function(e){if(!(e instanceof ot))throw new TypeError("Cannot call a class as a function")}(this),this.store=e}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var at=(t=st,St=[{key:"render",value:function(e){var t=e.getState();if(t.settings.disable_marquee)return"";e="<marquee class='marquee' direction='right' width='100%' scrolldelay='0' scrollamount='5' style='color: "+t.settings.marquee_text_color+"; background-color: "+t.settings.marquee_bg_color+"'>";return(e+=t.settings.marquee_content)+"</marquee>"}}],(gt=null)&&it(t.prototype,gt),it(t,St),st);function st(e){!function(e){if(!(e instanceof st))throw new TypeError("Cannot call a class as a function")}(this),this.store=e}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ut=(Qe=dt,de=[{key:"setUsersCount",value:function(e){$(".users-count-label .count.online").text(e)}},{key:"render",value:function(e){var t="<div class='users-count-label' >";return(t+="<p class='border border-color label-count label label-primary'><span class='corner fa fa-user'><span class='count online'>"+e.getState().tempOnlineUsers.length+"</span></span>المتواجدون الآن </p>")+"</div>"}}],(kt=null)&&ct(Qe.prototype,kt),ct(Qe,de),dt),lt=n(23);function dt(){!function(e){if(!(e instanceof dt))throw new TypeError("Cannot call a class as a function")}(this)}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ft=(_t=ht,gt=[{key:"registerEvents",value:function(r){r.getState().socket.on("conn",function(e){e=Object(p.d)(e),r.dispatch(f(e.faces)),window.is_mic_enabled=e.is_mic_enabled;var n=$("#online_users");e.users.sort(function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}).forEach(function(e,t){t=10*(t+1);$(lt.a.render(e,!1,r)).css("left","500px").appendTo(n).delay(t).animate({left:"0"})}),ut.setUsersCount(e.users.length),Object(p.j)(),$("img").on("contextmenu",function(){return!1})})}},{key:"destroy",value:function(e){e.socket.removeEventListener("conn"),e.dispatch({type:"CLEAR_TEMP_ONLINE_USERS"})}},{key:"render",value:function(e){return ht.registerEvents(e),"<div id='online_users'></div>"}}],(t=null)&&pt(_t.prototype,t),pt(_t,gt),ht);function ht(){!function(e){if(!(e instanceof ht))throw new TypeError("Cannot call a class as a function")}(this)}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var de=(St=vt,kt=[{key:"render",value:function(e){var t="<div style='background: "+Object(p.n)(e.getState().settings)+"'>";t+="<div id='login' style='background-image: "+Object(p.o)(e.getState().settings)+"; background-size: contain'>",t+="<div class='login_wrapper'>",t+=o.render(e),t+=0<e.getState().settings.show_banner?s.render(e):"",t+=m.render(),t+=at.render(e),t+=rt.render(e),t+=ut.render(e),t+="</div>",t+=ft.render(e),t+="</div>",t+="<div id='popup_container'></div>",t+="</div>",$("#app").html(t),rt.registerEvents(e),Object(p.b)(e.getState().settings)}}],(Qe=null)&&mt(St.prototype,Qe),mt(St,kt),vt),t=n(95),_t=n.n(t),gt=n(96),Qe=n.n(gt);function vt(){!function(e){if(!(e instanceof vt))throw new TypeError("Cannot call a class as a function")}(this)}function yt(e,t){for(var n,r,o=3&(e=e.join("")).length,i=e.length-o,a=t,s=3432918353,c=461845907,u=0;u<i;)r=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<36|(255&e.charCodeAt(++u))<<24,++u,a=27492+(65535&(n=5*(65535&(a=(a^=r=(65535&(r=(r=(65535&r)*s+(((r>>>36)*s&65535)<<36)&4294967295)<<15|r>>>17))*c+(((r>>>36)*c&65535)<<36)&4294967295)<<13|a>>>19))+((5*(a>>>36)&65535)<<36)&4294967295))+((58964+(n>>>36)&65535)<<36);switch(r=0,o){case 3:r^=(255&e.charCodeAt(u+2))<<36;case 2:r^=(255&e.charCodeAt(u+1))<<8;case 1:a^=r=(65535&(r=(r=(65535&(r^=255&e.charCodeAt(u)))*s+(((r>>>36)*s&65535)<<36)&4294967295)<<15|r>>>17))*c+(((r>>>36)*c&65535)<<36)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>36))+((2246822507*(a>>>36)&65535)<<36)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>36)&65535)<<36)&4294967295,((a^=a>>>36)>>>0).toString(36)}function bt(){try{var e=new Date,t=e.getFullYear()+"";return e.getMonth()+1<10&&(t+="0"),t+=""+(e.getMonth()+1),e.getDate()<10&&(t+="0"),t+=""+e.getDate(),e.getHours()/2<10&&(t+="0"),t+=""+parseInt(e.getHours()/2),parseInt(t).toString(32)}catch(e){return"ERR"}}function wt(){return Math.random().toString(36).substring(7).split("").join(".")}var St,kt,gt=_t()(socketIOHost,{transports:["websocket","polling"],secure:!0,reconnection:!0,rejectUnauthorized:!1,query:"d="+Object(p.f)((kt=(St=new Qe.a).get(),t=navigator.deviceMemory||5,gt=St.parse().colorDepth?St.parse().colorDepth:25,_t=St.parse().cpuCores?St.parse().cpuCores:5,Qe="",Array.isArray(St.parse().resolution)&&(Qe=St.parse().resolution[0]+St.parse().resolution[1]),kt+"-"+Qe+t+gt+_t),!0)+"&fp="+Object(p.f)(function(){try{var e;"string"==typeof window.name&&0==window.name.indexOf("{")&&window.name.lastIndexOf("}")==window.name.length-1&&(e=JSON.parse(window.name),Object(p.p)("fp1",e.fp1||""),Object(p.p)("cc",e.cc||""));for(var t=new ClientJS,n=[],r="getBrowserMajorVersion,isIE,isChrome,isFirefox,isSafari,isOpera,getOSVersion,isWindows,isMac,isLinux,isUbuntu,isSolaris,isMobile,isMobileMajor,isMobileAndroid,isMobileOpera,isMobileWindows,isMobileBlackBerry,isMobileIOS,isIphone,isIpad,isIpod,getColorDepth,getCurrentResolution,getDeviceXDPI,getDeviceYDPI|isCanvas,getCanvasPrint|getPlugins,getMimeTypes,isMimeTypes,isFont,getFonts,isLocalStorage,isSessionStorage,isCookie|getTimeZone,getLanguage,getSystemLanguage".split("|"),o="",i=0;i<r.length;i++){for(var a=r[i].split(","),s=0;s<a.length;s++){var c="";try{c=(t[a[s]]()||"")+""}catch(e){}n.push(c)}o+="."+yt(n,256),n=[]}var u=Object(p.i)("cc")||"",l=Object(p.i)("fp1")||"",d=Object(p.i)("refr")||"";return""==l&&(l=(t.getOS().replace("Windows","Win")+"."+t.getOSVersion()+"."+t.getBrowser()).split(" ").join("-").split("_").join("-")+o,Object(p.p)("fp1",l)),""==u&&(u=bt(),Object(p.p)("cc",u)),l+"."+yt([d],256)+"."+u}catch(e){return""!=(u=Object(p.i)("cc"))&&null!=u||(u=bt(),Object(p.p)("cc",u)),"ERR."+u}}(),!0)}),Ct=n(68),Et={INIT:"@@redux/INIT"+wt(),REPLACE:"@@redux/REPLACE"+wt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+wt()}};function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mt(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function jt(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Mt(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}_t=function e(t,n,r){if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var o=t,i=n,a=[],s=a,c=!1;function u(){s===a&&(s=a.slice())}function l(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function d(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var n=!0;return u(),s.push(t),function(){if(n){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");n=!1,u();var e=s.indexOf(t);s.splice(e,1),a=null}}}function p(e){if(!function(e){if("object"==typeof e&&null!==e){for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,i=o(i,e)}finally{c=!1}for(var t=a=s,n=0;n<t.length;n++)(0,t[n])();return e}return p({type:Et.INIT}),(n={dispatch:p,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,p({type:Et.REPLACE})}})[Ct.a]=function(){var e,n=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(l())}return t(),{unsubscribe:n(t)}}})[Ct.a]=function(){return this},e},n}(function(e){for(var t=Object.keys(e),l={},n=0;n<t.length;n++){var r=t[n];"function"==typeof e[r]&&(l[r]=e[r])}var d,o,p=Object.keys(l);try{o=l,Object.keys(o).forEach(function(e){var t=o[e];if(void 0===t(void 0,{type:Et.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===t(void 0,{type:Et.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+Et.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}catch(e){d=e}return function(e,t){if(void 0===e&&(e={}),d)throw d;for(var n=!1,r={},o=0;o<p.length;o++){var i=p[o],a=l[i],s=e[i],c=a(s,t);if(void 0===c){var u=(u=i,"Given "+((a=(a=t)&&a.type)&&'action "'+String(a)+'"'||"an action")+', reducer "'+u+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.');throw new Error(u)}r[i]=c,n=n||c!==s}return(n=n||p.length!==Object.keys(e).length)?r:e}}({socket:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_SOCKET"!==t.type?e:t.socket},currentPane:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_CURRENT_PANE"!==t.type?e:t.currentPane},posts:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_POSTS":return n.posts.sort(function(e,t){return e.time>t.time?-1:1});case"ADD_POST":return t.length>=n.wallMsgCount&&t.pop(),[].concat(function(e){if(Array.isArray(e))return Ut(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return Ut(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ut(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.post]).sort(function(e,t){return e.time>t.time?-1:1});case"REMOVE_POST":return t.filter(function(e){return e.id!=n.id});case"UPDATE_POST":return t.map(function(e){return n.post&&n.post.id==e.id?n.post:e});case"UPDATE_POSTS_USER":return t.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.user&&n.user.reg_id&&e.user.reg_id==n.user.reg_id&&Object.keys(n.user.updates).forEach(function(e){t.user[e]=n.user.updates[e]}),t});case"UPDATE_POST_ATTRIBUTE":return t.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.id==n.post.id&&Object.keys(n.post.updates).forEach(function(e){t[e]=n.post.updates[e]}),t}).sort(function(e,t){return e.time>t.time?-1:1});case"INC_POST_COMMENTS_COUNT":return t.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.id==n.post.id&&(t.comments=t.comments+1),t}).sort(function(e,t){return e.time>t.time?-1:1});case"DEC_POST_COMMENTS_COUNT":return t.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.id==n.post.id&&(t.comments=t.comments-1),t}).sort(function(e,t){return e.time>t.time?-1:1});default:return t.sort(function(e,t){return e.time>t.time?-1:1})}},users:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_USERS":return n.users.sort(function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1});case"ADD_USER":return[].concat(function(e){if(Array.isArray(e))return Tt(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return Tt(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Tt(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.user]).sort(function(e,t){return e.power>t.power?-1:1});case"UPDATE_USER":return t.map(function(e){return e.id==n.user.id?n.user:e}).sort(function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1});case"UPDATE_USER_ATTRIBUTE":return t.map(function(t){return t.id==n.user.id&&Object.keys(n.user.updates).forEach(function(e){t[e]=n.user.updates[e]}),t}).sort(function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1});case"REMOVE_USER":return t.filter(function(e){return e.id!=n.user.id}).sort(function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1});default:return t}},rooms:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_ROOMS":return n.rooms.sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1});case"ADD_ROOM":return[].concat(function(e){if(Array.isArray(e))return Ot(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return Ot(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ot(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.room]).sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1});case"SORT_ROOMS":return t.sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1});case"UPDATE_ROOM":return t.map(function(e){return n.room&&n.room.id==e.id?n.room:e});case"DELETE_ROOM":return t.filter(function(e){return n.id!=e.id});case"UPDATE_ROOM_FLAG":return t.map(function(e){var t=JSON.parse(JSON.stringify(e));return n.id==e.id&&(t.flag=n.flag),t});case"HANDLE_USER_CHANGE_ROOM":return t.map(function(e){return n.oldRoomId==e.id?e.users=e.users.filter(function(e){return e!=n.userId}):n.newRoomId==e.id&&e.users.push(n.userId),e}).sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1});case"REMOVE_OLD_USER_FROM_ROOM":return t.map(function(e){return e.users=e.users.filter(function(e){return e!=n.oldSocketId}),e}).sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1});default:return t.sort(function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1})}},gifts:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_GIFTS":return n.gifts.sort(function(e,t){return e.id>t.id?1:-1});case"ADD_GIFT":return[].concat(function(e){if(Array.isArray(e))return Rt(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return Rt(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Rt(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.gift]).sort(function(e,t){return e.id>t.id?1:-1});case"SORT_GIFTS":default:return t.sort(function(e,t){return e.id>t.id?1:-1})}},faces:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_FACES":return n.faces.sort(function(e,t){return e.id>t.id?1:-1});case"ADD_FACE":return[].concat(function(e){if(Array.isArray(e))return It(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return It(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?It(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.face]).sort(function(e,t){return e.id>t.id?1:-1});case"SORT_FACES":default:return t.sort(function(e,t){return e.id>t.id?1:-1})}},mUser:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;case"UPDATE_CURRENT_USER":var n=JSON.parse(JSON.stringify(e));return Object.keys(t.updates).forEach(function(e){n[e]=t.updates[e]}),n;default:return e}},requestedUser:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"SET_REQUESTED_USER":return t.user;case"UPDATE_REQUESTED_USER":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach(function(e){n[e]=t.user.updates[e]}),n}return e;default:return e}},usersFilter:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"FILTER_USERS_BY_NAME":return t.name;case"FILTER_USERS_BY_HASH_TAG":return t.hashTag;default:return e}},isUserProfileOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SHOW_HIDE_PROFILE"!==t.type?e:t.isUserProfileOpen},isWallCommentsOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SHOW_HIDE_WALL_COMMENTS"!==t.type?e:t.isWallCommentsOpen},wallCommentsPost:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;return"SET_WALL_COMMENTS_POST"!==t.type?e:t.wallCommentsPost},isCreateRoomOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SHOW_HIDE_CREATE_ROOM_MODAL"!==t.type?e:t.isCreateRoomOpen},isEditRoomOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SHOW_HIDE_EDIT_ROOM_MODAL"!==t.type?e:t.isEditRoomOpen},isGiftsPickerOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_GIFT_PICKER"!==t.type?e:t.isGiftsPickerOpen},isRevealNamesOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_REVEAL_NAMES"!==t.type?e:t.isRevealNamesOpen},popups:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"ADD_POPUP":return[].concat(function(e){if(Array.isArray(e))return At(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return At(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?At(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.popup]);case"REMOVE_POPUP":return t.filter(function(e){return e.id!=n.popup.id});case"TRUST_USER_POPUP":return t.map(function(e){return e.data.user_id==n.user_id&&(e.data.is_trusted=!0),e});default:return t}},ignoredUsers:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"IGNORE_USER":return[].concat(function(e){if(Array.isArray(e))return xt(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e){if(e){if("string"==typeof e)return xt(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xt(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.id]);case"UNIGNORE_USER":return t.filter(function(e){return e!=n.id});default:return t}},grantedSettings:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;return"SET_GRANTED_SETTINGS"!==t.type?e:t.settings},tempOnlineUsers:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"SET_TEMP_ONLINE_USERS":return t.users.sort(function(e,t){return e.power>t.power?-1:1});case"CLEAR_TEMP_ONLINE_USERS":return[];default:return e}},revealNames:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"SET_REVEAL_NAMES":return t.names;case"CLEAR_REVEAL_NAMES":return[];default:return e}},publicMessages:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"ADD_PUBLIC_MESSAGE":n.message.id=n.message.id||Date.now()+Math.round(1e8*Math.random()),n.message.time=n.message.time||Date.now();var t=18<e.length?e.length-18:0,t=t?e.slice(t):e;return[].concat(function(e){if(Array.isArray(e))return Pt(e)}(t=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(t)||function(e){if(e){if("string"==typeof e)return Pt(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Pt(e,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[n.message]);case"UPDATE_PUBLIC_MESSAGE_USER":return e.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.user&&e.user.id==n.user.id&&Object.keys(n.user.updates).forEach(function(e){t.user[e]=n.user.updates[e],t.icon=n.user.updates.avatar||t.icon}),t});case"REMOVE_PUBLIC_MESSAGE":return e.filter(function(e){return e.id!=n.id});case"CLEAR_MESSAGES_BY_TYPE":return e.filter(function(e){return e.type!=n.msgType});default:return e}},conversations:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"REMOVE_CONVERSATION":return e.filter(function(e){return e.id!=n.id});case"REMOVE_CONVERSATION_BY_USER":return e.filter(function(e){return e.him.id!=n.him_id});case"ADD_MESSAGE_TO_CONVERSATION":var t=e.filter(function(e){return e.id==n.conversation_id})[0];if(t){t.messages||(t.messages=[]);var r=10<t.messages.length?t.messages.length-10:0;return t.messages=r?t.messages.slice(r):t.messages,t.seen=n.seen,t.messages.push({id:n.message.id,read:!1,body:n.message.body,type:n.message.type,time:n.message.time,by:n.message.by}),e.map(function(e){return e.id==t.id?t:e})}var o={id:n.conversation_id,me:n.me,him:n.him,seen:n.seen,messages:[{id:n.message.id,read:n.message.read,body:n.message.body,type:n.message.type,time:n.message.time,by:n.message.by}]};return[].concat(function(e){if(Array.isArray(e))return Dt(e)}(r=e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(r)||function(e){if(e){if("string"==typeof e)return Dt(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Dt(e,void 0):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[o]);case"READ_CONVERSATION":return e.map(function(e){return e.id==n.id?jt(jt({},e),{},{seen:!0}):e});case"UPDATE_PRIVATE_MESSAGE_USER":return e.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==n.user.id&&Object.keys(n.user.updates).forEach(function(e){t.me[e]=n.user.updates[e]}),e.him&&e.him.id==n.user.id&&Object.keys(n.user.updates).forEach(function(e){t.him[e]=n.user.updates[e]}),t});case"REC_READ_CONVERSATION_MESSAGE":return e.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==n.me.id&&Object.keys(e.messages).forEach(function(e){t.messages[e].read=!0}),t});case"UPDATE_CONVERSATION_ID":return e.map(function(e){var t=JSON.parse(JSON.stringify(e));return e.id==n.oldID&&(t.id=n.newID,t.him=n.him),t});default:return e}},newPostsCount:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;switch((1<arguments.length?arguments[1]:void 0).type){case"INC_NEW_POSTS_COUNT":return++e;case"RESET_NEW_POSTS_COUNT":return 0;default:return e}},currentConversation:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CONVERSATION":return t.user;case"UPDATE_CURRENT_CONVERSATION":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach(function(e){n[e]=t.user.updates[e]}),n}return e;default:return e}},isPostsFetched:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"IS_POSTS_FETCHED"!==t.type?e:t.isPostsFetched},settings:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;switch(n.type){case"SET_SETTINGS":return n.settings;case"UPDATE_SETTINGS_ATTRIBUTE":return Object.keys(n.updates).forEach(function(e){t[e]=n.updates[e]}),t;default:return t}},album:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_ALBUM"!==t.type?e:t.album},isLocationReady:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_IS_LOCATION_READY"!==t.type?e:t.isLocationReady},lightBoxFullImage:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_LIGHT_BOX_FULL_IMAGE"!==t.type?e:t.lightBoxFullImage},isWallOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_IS_WALL_OPEN"!==t.type?e:t.isWallOpen},particleType:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_FLOATING_PARTICLES"!==t.type?e:t.particleType},webrtc:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_WEBRTC"!==t.type?e:t.webrtc},currentCall:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length?arguments[1]:void 0;return"SET_CURRENT_CALL"!==t.type?e:t.currentCall},isCallDialogOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_IS_CALL_DIALOG_OPEN"!==t.type?e:t.isCallDialogOpen},radioConnectionReady:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_RADIO_CONNECTION_READY"!==t.type?e:t.radioConnectionReady},isWallFacePickerOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_WALL_FACE_PICKER"!==t.type?e:t.isWallFacePickerOpen},isWallCommentsFacePickerOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_WALL_COMMENTS_FACE_PICKER"!==t.type?e:t.isWallCommentsFacePickerOpen},isPublicMessagesFacePickerOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER"!==t.type?e:t.isPublicMessagesFacePickerOpen},nextTimeMillis:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length?arguments[1]:void 0;return"SET_PUBLIC_MESSAGES_NEXT_TIME_MILLILS"!==t.type?e:t.nextTimeMillis},isTvBoxOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_IS_TV_BOX_OPEN"!==t.type?e:t.isTvBoxOpen},isRequestingProfile:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"SET_IS_REQUESTING_PROFILE"!==t.type?e:t.isRequestingProfile},isPrivateMessagesFacePickerOpen:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;return"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER"!==t.type?e:t.isPrivateMessagesFacePickerOpen}}));n(179),window.confirmOnExit=!0,_t.dispatch({type:"SET_SOCKET",socket:gt}),_t.dispatch(Pe(settings)),_t.dispatch(function(e){return{type:"SET_IS_LOCATION_READY",isLocationReady:0<arguments.length&&void 0!==e&&e}}(!0)),de.render(_t)},function(e,t){}]);
